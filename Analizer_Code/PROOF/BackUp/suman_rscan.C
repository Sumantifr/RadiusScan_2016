#define suman_rscan_cxx
// The class definition in suman_rscan.h has been generated automatically
// by the ROOT utility TTree::MakeSelector(). This class is derived
// from the ROOT class TSelector. For more information on the TSelector
// framework see $ROOTSYS/README/README.SELECTOR or the ROOT User Manual.

// The following methods are defined in this file:
//    Begin():        called every time a loop on the tree starts,
//                    a convenient place to create your histograms.
//    SlaveBegin():   called after Begin(), when on PROOF called only on the
//                    slave servers.
//    Process():      called for each event, in this function you decide what
//                    to read and fill your histograms.
//    SlaveTerminate: called at the end of the loop on the tree, when on PROOF
//                    called only on the slave servers.
//    Terminate():    called at the end of the loop on the tree,
//                    a convenient place to draw/fit your histograms.
//
// To use this file, try the following session on your Tree T:
//
// Root > T->Process("suman_rscan.C")
// Root > T->Process("suman_rscan.C","some options")
// Root > T->Process("suman_rscan.C+")
//

#define Run2016B
//#define Run2016C
//#define Run2016D

#include "suman_rscan.h"
#include <TH2.h>
#include <TStyle.h>
#include <TH1F.h>
#include <TH2F.h>
#include <fstream>
#include <TProofOutputFile.h>
#include <TROOT.h>
#include <TChain.h>
#include <TFile.h>
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <TProofServ.h>

using namespace std;

void suman_rscan::Begin(TTree * /*tree*/)
{
   // The Begin() function is called at the start of the query.
   // When running with PROOF Begin() is only called on the client.
   // The tree argument is deprecated (on PROOF 0 is passed).

   TString option = GetOption();

     
}

const float pival = acos(-1.);
/*
int* dec2bin(int dec)
{
const int length = 10;//nHLTmx;
int input = dec;
int istep=0;
int div[length] = {0};
while(input>0){
  input = input/2;
  div[istep] = input%2;
  istep++;
 }

static int binary[length];

for(int ij=1; ij<(length+1); ij++){
 binary[ij-1] = div[length-ij];
 }
return binary;
}

int getbinid(double val, int nbmx, double* array) {
  if (val<array[0]) return -2;
  for (int ix=0; ix<=nbmx; ix++) {
    if (val < array[ix]) return ix-1;
  }
  return -3;
}

double theta_to_eta(double theta) { return -log(tan(theta/2.)); }

double PhiInRange(const double& phi) {
  double phiout = phi;

  if( phiout > 2*pival || phiout < -2*pival) {
    phiout = fmod( phiout, 2*pival);
  }
  if (phiout <= -pival) phiout += 2*pival;
  else if (phiout >  pival) phiout -= 2*pival;

  return phiout;
}

double delta2R(double eta1, double phi1, double eta2, double phi2) {
  return sqrt(pow(eta1 - eta2,2) +pow(PhiInRange(phi1 - phi2),2));
}
*/

void suman_rscan::SlaveBegin(TTree * /*tree*/)
{
   // The SlaveBegin() function is called after the Begin() function.
   // When running with PROOF SlaveBegin() is called on each slave server.
   // The tree argument is deprecated (on PROOF 0 is passed).

  TString option = GetOption();

  const char* JetRad[nalgo] = {"ak1","ak2","ak3","ak4","ak5","ak6","ak7","ak8","ak9","ak10","ak11","ak12"};
  const char* JetEta[netarange] = {"|eta|<0.5","0.5<|eta|<1.0","1.0<|eta|<1.5","1.5<|eta|<2.0","2.0<|eta|<2.5","2.5<|eta|<3.0","3.0<|eta|<3.2","3.2<|eta|<3.7","3.7<|eta|<4.2","4.2<|eta|<4.7"} ;
  double etarng[netarange+1] ={0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.2, 3.7, 4.2, 4.7};
  
  double ptbins[noptbins+1] = {/*30, 37, 43, 49, 56, 64,*/ 74, 84,
     97, 114, 133, 153, 174, 196, 220, 245, 272, 300, 330, 362, 395, 430, 468, 
     507, 548, 592, 638, 686, 737, 790, 846, 905, 967, 
     1032, 1101, 1172, 1248, 1327, 1410, 1497, 1588, 1684, 1784, 1890, 2000, 
     2116, 2238, 2366, 2500, 2640, 2787, 2941, 3103, 3273, 3450, 3637, 3832,
     4037, 4252, 4477, 4713, 4961, 5220, 5492, 5777, 6076, 6389, 6717, 7000} ;


  double ptbins1[noptbins1+1] = {30, 37, 43, 49, 56, 64, 74, 84,
     97, 114, 133, 153, 174, 196, 220, 245, 272, 300, 330, 362, 395, 430, 468,
     507, 548, 592, 638, 686, 737, 790, 846, 905, 967,
     1032, 1101, 1172, 1248, 1327, 1410, 1497, 1588, 1684, 1784, 1890, 2000,
     2116, 2238, 2366, 2500, 2640, 2787, 2941, 3103, 3273, 3450, 3637, 3832,
     4037, 4252, 4477, 4713, 4961, 5220, 5492, 5777, 6076, 6389, 6717, 7000} ;

  double cor_expo[nalgo][netarange][nopol] = 
{{{1.04033,-3.64331e-05,1.98343e-08,-3.55626e-12,5.11899,-131.923}
,{1.05914,-6.20706e-05,3.79549e-08,-7.9879e-12,6.24604,-237.012}
,{1.09085,-7.58912e-05,4.79356e-08,-1.25831e-11,9.53956,-404.21}
,{1.02621,1.51894e-05,1.83066e-08,-1.37501e-11,17.7808,-699.715}
,{0.955284,0.000247344,-2.93769e-07,1.23843e-10,13.6278,-341.084}
,{0.826679,0.000637292,-9.66587e-07,5.22191e-10,13.0779,-345.583}
,{0.881428,0.00115964,-3.5195e-06,3.44489e-09,21.8642,-518.429}
,{0.622612,0.00121634,-1.0177e-07,-2.71201e-09,65.7353,-2711.9}
,{0.624648,0.00153669,-1.45248e-06,1.90926e-09,66.3524,-2466.34}
,{0.738121,0.00600743,1.53217e-05,-3.18203e-07,40.7932,-2274.65}
}
,{{1.03607,-3.21972e-05,1.66915e-08,-2.88258e-12,0.660311,-17.9514}
,{1.05132,-5.74922e-05,3.60593e-08,-7.77781e-12,0.048954,-9.87005}
,{1.06742,-6.27322e-05,4.35061e-08,-1.1942e-11,1.6426,-63.9275}
,{1.03911,-3.73455e-05,4.99888e-08,-2.0179e-11,7.92378,-315.1}
,{0.891108,0.000399213,-4.98966e-07,2.16624e-10,22.7171,-835.782}
,{0.729902,0.000969495,-1.48048e-06,7.92853e-10,32.068,-1072.87}
,{0.889388,0.00101562,-3.44448e-06,3.9793e-09,15.5322,-430.272}
,{0.583623,0.00107421,-8.39675e-08,-2.43872e-09,60.9275,-2549.93}
,{0.613599,0.000656432,-3.80325e-06,2.23747e-08,73.9402,-3245.32}
,{1.17398,-0.00205222,-6.13388e-05,2.89517e-07,137.036,-8797.45}
}
,{{1.0178,-1.57937e-05,8.51326e-09,-1.41742e-12,-0.265856,20.932}
,{1.02709,-3.58124e-05,2.53973e-08,-5.90805e-12,-0.893352,32.7147}
,{1.03169,-3.36289e-05,2.92782e-08,-9.16402e-12,0.107511,14.0397}
,{1.03094,-4.39476e-05,5.22281e-08,-2.06604e-11,1.75966,-54.6825}
,{0.959269,0.00017989,-2.30374e-07,1.02478e-10,10.2743,-400.481}
,{0.714169,0.00104531,-1.6615e-06,9.2036e-10,32.8182,-1157.68}
,{0.773515,0.000973576,-2.12284e-06,1.55937e-09,25.2452,-900.908}
,{0.876486,0.00125318,-5.028e-06,5.83559e-09,3.5601,37.7052}
,{0.568128,0.000891751,-2.45289e-06,1.48422e-08,64.8008,-2719.29}
,{1.04701,-0.00236701,-5.58118e-05,3.00994e-07,128.697,-7887.08}
}
,{{1.00508,-2.81698e-06,1.845e-09,-2.63281e-13,-0.194419,8.60072}
,{1.01315,-2.17064e-05,1.73178e-08,-4.29921e-12,-1.47011,65.9556}
,{1.00283,4.10784e-06,-7.42282e-10,-6.36857e-13,0.274104,-2.28247}
,{1.02446,-4.57109e-05,5.3113e-08,-2.11668e-11,-3.26996,149.153}
,{0.963847,0.000163316,-2.28602e-07,1.07813e-10,4.73502,-237.073}
,{0.781721,0.000796703,-1.25496e-06,6.74349e-10,24.3249,-948.122}
,{0.836501,0.000984173,-2.98374e-06,2.95226e-09,11.4805,-304.169}
,{0.905473,0.0013117,-5.94031e-06,7.42724e-09,-3.20873,274.449}
,{0.515491,0.00149853,2.47794e-07,-3.79977e-09,50.834,-1808.58}
,{0.889408,-0.00133754,-4.23672e-05,2.2474e-07,104.632,-5996.59}
}
,{{0.998846,3.75256e-06,-1.40045e-09,2.75792e-13,-0.569115,30.6463}
,{1.00215,-7.45134e-06,8.84511e-09,-2.58052e-12,-1.46952,62.9579}
,{0.989933,1.82561e-05,-1.00281e-08,1.56701e-12,-0.963802,41.7634}
,{1.01876,-4.26245e-05,5.02032e-08,-2.00013e-11,-7.7612,313.089}
,{0.969388,0.000125521,-1.82738e-07,8.8002e-11,-0.587928,-88.707}
,{0.844226,0.000573881,-9.04692e-07,4.73906e-10,14.8429,-657.666}
,{0.827053,0.000980823,-2.88571e-06,2.73334e-09,14.1374,-458.742}
,{0.902447,0.00130827,-5.79877e-06,7.06859e-09,-1.66747,224.949}
,{0.495264,0.00173452,1.44407e-06,-1.07761e-08,46.3329,-1428.39}
,{0.872415,-0.00126548,-4.04376e-05,2.15091e-07,102.838,-5889.08}
}
,{{0.991915,1.30233e-05,-6.5848e-09,1.27108e-12,-0.374474,22.7341}
,{0.996529,-9.30008e-07,5.5966e-09,-2.02154e-12,-2.11581,99.1986}
,{0.980079,2.97856e-05,-1.66785e-08,2.94182e-12,-2.23496,81.9123}
,{1.01372,-3.83359e-05,4.72343e-08,-1.91208e-11,-12.3251,472.614}
,{0.967971,0.000115721,-1.79068e-07,8.9341e-11,-5.35398,72.0622}
,{0.869372,0.000488672,-7.95157e-07,4.24889e-10,10.136,-492.949}
,{0.823609,0.000957718,-2.853e-06,2.70757e-09,16.3699,-485.048}
,{0.891905,0.00128832,-5.52408e-06,6.51739e-09,0.397437,182.164}
,{0.467511,0.0022037,3.06955e-06,-2.31112e-08,35.4945,-632.456}
,{0.787998,-0.000306734,-3.07727e-05,1.50479e-07,86.7368,-4769.96}
}
,{{1.0052,-1.31352e-06,1.13764e-10,1.96224e-13,-0.679519,0.713063}
,{1.01562,-2.21674e-05,1.56615e-08,-3.64546e-12,-2.23852,77.1473}
,{1.00576,5.25454e-06,-5.50738e-09,1.22974e-12,0.308376,-37.2541}
,{1.03275,-5.64184e-05,5.57544e-08,-1.96299e-11,-3.61302,164.536}
,{0.986054,0.000104039,-1.54529e-07,7.54549e-11,2.04205,-161.232}
,{0.811547,0.000688079,-1.11831e-06,6.20522e-10,21.1142,-979.632}
,{0.765771,0.000984298,-2.15919e-06,1.52983e-09,21.3899,-834.764}
,{0.822333,0.00125949,-4.41964e-06,4.50524e-09,7.36271,-209.861}
,{0.489322,0.0017541,1.46052e-06,-1.23409e-08,44.8618,-1403.11}
,{0.667771,0.000919285,-1.74888e-05,6.12906e-08,66.2452,-3203.67}
}
,{{1.00562,-1.68413e-06,4.14295e-10,1.20709e-13,-0.418881,28.6381}
,{1.01455,-2.10535e-05,1.55753e-08,-3.75413e-12,-1.89349,95.1722}
,{1.00731,7.68167e-07,-1.49319e-09,1.05752e-13,-0.826904,63.2633}
,{1.03543,-5.9815e-05,5.66107e-08,-1.92958e-11,-5.62578,269.471}
,{1.009,4.87778e-05,-1.02214e-07,5.65692e-11,-2.88377,39.9689}
,{0.877886,0.000465583,-7.75099e-07,4.19478e-10,11.7121,-543.578}
,{0.809937,0.000963269,-2.64708e-06,2.3306e-09,18.1215,-610.716}
,{0.830065,0.00121962,-4.52328e-06,4.9424e-09,9.41142,-226.6}
,{0.495137,0.00169333,1.16907e-06,-1.05576e-08,46.3915,-1438.92}
,{0.630113,0.00138445,-1.27691e-05,3.01363e-08,59.0254,-2666.44}
}
,{{1.00562,-1.22229e-06,2.33718e-10,1.31286e-13,0.216763,52.9811}
,{1.01571,-2.26917e-05,1.68179e-08,-4.05481e-12,-1.79341,157.653}
,{1.00532,3.50423e-06,-3.18823e-09,4.72972e-13,-0.927314,116.072}
,{1.03753,-6.28618e-05,5.92741e-08,-2.03363e-11,-7.41304,349.47}
,{1.01948,2.23499e-05,-7.62897e-08,4.62206e-11,-5.72515,169.78}
,{0.843769,0.000647517,-1.13737e-06,6.57306e-10,13.7769,-426.955}
,{0.852381,0.0010261,-2.98242e-06,2.41523e-09,12.7895,-154.148}
,{0.857706,0.00122283,-4.81015e-06,5.33994e-09,8.04427,-13.8241}
,{0.51767,0.00152649,3.15836e-07,-6.05122e-09,51.5561,-1701.26}
,{0.457864,0.00326478,7.47432e-06,-1.09315e-07,30.0051,-547.574}
}
,{{1.01336,-1.27321e-05,7.24538e-09,-1.29725e-12,-0.599943,198.203}
,{1.01581,-2.20848e-05,1.63403e-08,-3.94765e-12,-1.06292,207.397}
,{1.00053,1.29243e-05,-1.058e-08,2.38609e-12,-0.258002,135.407}
,{1.04185,-6.85406e-05,6.277e-08,-2.11238e-11,-9.95251,480.216}
,{1.02091,3.0962e-05,-1.02013e-07,6.17912e-11,-7.64051,325.938}
,{0.863869,0.000570473,-9.97065e-07,5.6536e-10,11.5705,-14.941}
,{0.887305,0.00102353,-3.29964e-06,2.89728e-09,13.1257,157.368}
,{0.862064,0.00120565,-4.84745e-06,5.54784e-09,13.039,-10.3576}
,{0.496959,0.0019502,2.12147e-06,-1.94128e-08,45.2158,-1010.24}
,{0.457638,0.00326035,7.45213e-06,-1.08259e-07,30.0734,-508.239}
}
,{{1.01548,-1.46881e-05,8.14405e-09,-1.44591e-12,0.16008,278.443}
,{1.01937,-2.70592e-05,1.95574e-08,-4.67144e-12,-0.686124,321.656}
,{1.00781,-7.90622e-08,-1.41314e-09,2.11957e-13,-1.79312,309.502}
,{1.0441,-6.67082e-05,5.77079e-08,-1.89105e-11,-12.5008,620.936}
,{1.07691,-0.000143212,1.21425e-07,-3.95789e-11,-15.8501,858.791}
,{0.753126,0.00093782,-1.51391e-06,8.19259e-10,26.7574,-121.259}
,{0.864701,0.00102888,-2.77724e-06,1.9168e-09,22.2685,300.708}
,{0.810602,0.00112612,-3.71965e-06,3.63973e-09,28.2278,-297.265}
,{0.546385,0.0015486,1.59813e-08,-7.56607e-09,56.2794,-1563.56}
,{0.466463,0.00331042,7.34795e-06,-1.13027e-07,30.7237,-500.597}
}
,{{1.0234,-2.59568e-05,1.50189e-08,-2.88075e-12,-0.0577996,474.403}
,{1.02216,-3.00755e-05,2.10005e-08,-4.90849e-12,0.297714,444.674}
,{1.01398,-1.10478e-05,6.80833e-09,-1.9625e-12,-2.89252,483.385}
,{1.06089,-9.53801e-05,7.86655e-08,-2.41535e-11,-18.0951,945.944}
,{1.01213,2.93476e-05,-7.87108e-08,4.06614e-11,-6.19105,731.029}
,{0.609443,0.00131158,-1.9637e-06,1.02749e-09,52.5428,-642.441}
,{0.82379,0.000939727,-2.1732e-06,1.29994e-09,43.4308,-222.476}
,{0.612354,0.000956665,-4.09306e-07,-1.81246e-09,72.3698,-1786.36}
,{0.576023,0.00140195,-7.48634e-07,-3.22693e-09,63.2006,-1643.34}
,{0.470609,0.00332195,7.32567e-06,-1.148e-07,31.661,-348.959}
}
};


  double datpileup[nHLTmx][npileupmx] = {{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09} 
										 }; //for 2016 data 80 bins
	
double datpileup_up[nHLTmx][npileupmx] = {{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16}};
	
double datpileup_dn[nHLTmx][npileupmx] = {{2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0}};
			 
										
double  mcpileup[npileupmx] = {2.82595e-05,6.29473e-05,0.000126337,0.000256885,0.000564631,0.00110702,0.00204067,0.0035458,0.00559555,0.0083368,0.011575,0.0154292,0.01967,0.0241571,0.0285471,0.0326206,0.0364776,0.0397328,0.0421873,0.044275,0.0451668,0.0458842,0.045376,0.0445124,0.043152,0.0411647,0.038777,0.0366233,0.033998,0.0314075,0.0287512,0.0262996,0.0239008,0.0215455,0.0195003,0.0176033,0.015793,0.0141663,0.0128473,0.0115051,0.0103265,0.00926773,0.00834596,0.00750304,0.00666546,0.00597047,0.00529105,0.00466223,0.00413244,0.00362811,0.00318285,0.00273657,0.00239027,0.0020306,0.0017336,0.00146106,0.00122478,0.00100438,0.000834986,0.000668676,0.000550739,0.000455454,0.000343681,0.000275465,0.000227473,0.000165593,0.000133594,0.000107893,7.98589e-05,6.69385e-05,5.60126e-05,4.08681e-05,2.92365e-05,2.53712e-05,1.69478e-05,1.57952e-05,1.38265e-05,9.98148e-06,6.90946e-06,6.66382e-06} ; //For 2016 Summer MC

double rat_pileup[nHLTmx][npileupmx] = {{0}};   

  const char* jethlt_name[nHLTmx] = {"HLT_AK8PFJet40_v", "HLT_AK8PFJet60_v",
                                 "HLT_AK8PFJet80_v", "HLT_AK8PFJet140_v", "HLT_AK8PFJet200_v",
                                 "HLT_AK8PFJet260_v", "HLT_AK8PFJet320_v",
                                 "HLT_AK8PFJet400_v", "HLT_AK8PFJet450_v", "HLT_AK8PFJet500_v"} ;

  compres[nHLTmx] = {0};

  OutFile = new TProofOutputFile("try.root");
 // fOutput->Add(OutFile);
  
  fileOut = OutFile->OpenFile("RECREATE");

  if ( !(fileOut = OutFile->OpenFile("RECREATE")) )
    {
      Warning("SlaveBegin", "problems opening file: %s/%s",
              OutFile->GetDir(), OutFile->GetFileName());
    }

  double compres15[nHLTmx] = {133490.64,17310.168,4567.035,868.165,117.545,11.427,5.46,2.466,1.0002,1.0};
  double compresB[nHLTmx] = {642980.,72759.1,22884.3,2235.47,223.757,47.8042,16.9884,5.42371,1.,1.} ;
  double compresC[nHLTmx] = {576174.,81695.1,25718.3,2569.92,255.795,53.4,19.0319,6.23305,1.,1.};
  double compresD[nHLTmx] = {580101.,81285.6,25916.5,2534.28,252.871,55.5829,18.8895,6.22492,1.,1.};
  double compresE[nHLTmx] = {641478.,92969.,29772.8,2904.08,307.486,61.3483,20.9706,6.88494,1.,1.};
  double compresF[nHLTmx] = {660909.,111157.,40255.3,3670.99,465.406,69.2093,23.2046,7.78581,1.,1.};
  double compresG[nHLTmx] = {774248.665,122319.611,40851.372,4168.971,630.5287,73.69957,24.33146,8.2079,1.,1.};
  double compresH[nHLTmx] = {726646.691,131051.757,43288.608,4508.252,680.906,77.707,25.935,8.816,1.,1.} ;

 
  isMC = false;

  hist_pfmet = new TH1F("MET_Value","MET Value",1000,0.0,2000.0) ; 
  hist_SumEt = new TH1F("Sum_Et","Sum_Et",3500,0,3500.);
  hist_METbyET = new TH1F("METbyEt","MET Value by pT Sum",100,0.0,1.0) ; 
  hist_PV_all = new TH1F("nprimall_rewt_trigset","All PV",60, -0.5, 59.5);
  hist_PV_sel = new TH1F("nprimsel_rewt_trigset","Selected PV",60, -0.5, 59.5);
  hist_PU     = new TH1F("pu_vertices","# of PU Vertices",80,-0.5,79.5);

  PU_vs_PV_all = new TH2F("pileup_vs_nprimall","PU vs PV all",80,-0.5,79.5,80,-0.5,79.5);
  PU_vs_PV_sel = new TH2F("pileup_vs_nprimsel","PU vs PV sel",80,-0.5,79.5,80,-0.5,79.5);
  PU_vs_PV_sel_rewt = new TH2F("pileup_vs_nprimsel_reweighted","PU vs PV sel Weighted",80,-0.5,79.5,80,-0.5,79.5);



  for(int ij=0;ij<nalgo;ij++){
    for (int jk=0;jk<netarange;jk++){	

      sprintf(name,"Fit_Cor_%s_EtaBin%i",JetRad[ij],jk+1);
      fit_cor[ij][jk] = new TF1(name,pol5,ptbins[0]-20.,ptbins[noptbins-1],nopol);
	
      sprintf(name,"NJets_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"NJets for %s %s",JetRad[ij],JetEta[jk]);

      NJets[ij][jk] = new TH1F(name,title,20,0,20);
      NJets[ij][jk]->Sumw2();

	  for(int kl=0; kl<nrun; kl++){

      sprintf(name,"JetpT_%s_EtaBin%i_Comb%i",JetRad[ij],jk+1,kl+1);
      sprintf(title,"JetpT for %s %s Comb%i",JetRad[ij],JetEta[jk],kl+1);
      
      JetpT_comb[ij][jk][kl] = new TH1F(name,title,noptbins,ptbins);
      JetpT_comb[ij][jk][kl]->Sumw2();
      
      sprintf(name,"NJets_%s_EtaBin%i_Comb%i",JetRad[ij],jk+1,kl+1);
      sprintf(title,"NJets for %s %s Comb%i",JetRad[ij],JetEta[jk],kl+1);

      NJets_comb[ij][jk][kl] = new TH1F(name,title,20,0,20);
      NJets_comb[ij][jk][kl]->Sumw2();
	  }
      
      sprintf(name,"JetpT_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"JetpT for %s %s",JetRad[ij],JetEta[jk]);
      
      JetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      JetpT[ij][jk]->Sumw2();
      
      sprintf(name,"JetpT_%s_EtaBin%i_JER_up",JetRad[ij],jk+1);
      sprintf(title,"JetpT for %s %s JER Up",JetRad[ij],JetEta[jk]);
      
      JetpT_up[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      JetpT_up[ij][jk]->Sumw2();
      
      sprintf(name,"JetpT_%s_EtaBin%i_JER_dn",JetRad[ij],jk+1);
      sprintf(title,"JetpT for %s %s JER Down",JetRad[ij],JetEta[jk]);
      
      JetpT_dn[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      JetpT_dn[ij][jk]->Sumw2();
      
      sprintf(name,"Leading_JetpT_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Leading JetpT for %s %s" ,JetRad[ij],JetEta[jk]);
      
      LeadJetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      LeadJetpT[ij][jk]->Sumw2();
      
      sprintf(name,"DiJet_Mass_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"DiJet Mass for %s %s",JetRad[ij],JetEta[jk]);
    
      DiJet_Mass[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      DiJet_Mass[ij][jk]->Sumw2();

      sprintf(name,"NGenJets_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"NJets %s EtaBin %i",JetRad[ij],jk+1) ;
      
      sprintf(name,"Jet_Width_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Jet Width for %s %s",JetRad[ij],JetEta[jk]);

      JetWidth[ij][jk] = new TH1F(name,title,100,0,2.);
      JetWidth[ij][jk]->Sumw2();

      sprintf(name,"JetPt_vs_JEC_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt vs JEC %s EtaBin%i",JetRad[ij],jk+1);
      JetPt_vs_JEC[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      JetPt_vs_JEC[ij][jk]->Sumw2();

      sprintf(name,"JetPt_vs_JECL1_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt vs JEC L1 %s EtaBin%i",JetRad[ij],jk+1);
      JetPt_vs_JECL1[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      JetPt_vs_JECL1[ij][jk]->Sumw2();
      
      sprintf(name,"JetPt_vs_JECL2_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt vs JEC L2 %s EtaBin%i",JetRad[ij],jk+1);
      JetPt_vs_JECL2[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      JetPt_vs_JECL2[ij][jk]->Sumw2();

	  sprintf(name,"JetPt_vs_JECL2L3_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt vs JEC L2L3 %s EtaBin%i",JetRad[ij],jk+1);
      JetPt_vs_JECL2L3[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      JetPt_vs_JECL2L3[ij][jk]->Sumw2();

      sprintf(name,"Measured_Cov_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Measured Cov %s EtaBin%i",JetRad[ij],jk+1);
      Mes_Cov[ij][jk] = new TH2F(name,title,noptbins,ptbins,noptbins,ptbins);
      Mes_Cov[ij][jk]->Sumw2();

      for(int hl=0 ; hl<nHLTmx; hl++){
      sprintf(name,"JetpT_%s_EtaBin%i_HLT%i",JetRad[ij],jk+1,hl+1);
      sprintf(title,"JetpT for %s %s %s",JetRad[ij],JetEta[jk],jethlt_name[hl]);
      Prescale_JetpT[ij][jk][hl] = new TH1F(name,title,noptbins,ptbins);
      Prescale_JetpT[ij][jk][hl]->Sumw2();
      }

     if(isMC){

      NGenJets[ij][jk] = new TH1F(name,title,20,0,20);
      NGenJets[ij][jk]->Sumw2();
      
      sprintf(name,"Gen_MC_JetpT_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Gen MC Jet pT %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCJetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCJetpT[ij][jk]->Sumw2();
			
      sprintf(name,"Gen_MC_JetpT_Pow_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Gen MC Jet pT Pow %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCJetpT_pow[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCJetpT_pow[ij][jk]->Sumw2();
      
      sprintf(name,"Leading_Gen_MC_JetpT_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Leading Gen MC Jet pT %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCLeadJetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCLeadJetpT[ij][jk]->Sumw2();
			
      sprintf(name,"Gen_DiJet_Mass_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Gen_DiJet Mass for %s %s",JetRad[ij],JetEta[jk]);
    
      Gen_DiJet_Mass[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      Gen_DiJet_Mass[ij][jk]->Sumw2();
			
      sprintf(name,"LeadJetRaio_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Leading Jet Pt Ratio for %s EtaBin%i",JetRad[ij],jk+1);

      LeadJetRatio[ij][jk] = new TH1F(name,title,500,-0.01,5.);
      LeadJetRatio[ij][jk]->Sumw2();
	 
      sprintf(name,"RecoJetvsGenJet_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"RecoJetvsGenJet %s EtaBin%i",JetRad[ij],jk+1);
      RecoVsGenJetpT[ij][jk] = new TH2F(name,title,noptbins,ptbins,noptbins,ptbins);
      RecoVsGenJetpT[ij][jk]->Sumw2();
	
      RecoVsGenJetpT[ij][jk]->GetXaxis()->SetTitle("RECO Jet pT (in GeV)");
      RecoVsGenJetpT[ij][jk]->GetYaxis()->SetTitle("Gen Jet pT (in GeV)") ;
	
      sprintf(name,"RecoJetvsGenJet_Number_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"RecoJetvsGenJet Number %s EtaBin%i",JetRad[ij],jk+1);
      RecoVsGenJetNo[ij][jk] = new TH2F(name,title,njetmx,-0.5,19.5,njetmx,-0.5,19.5);
      RecoVsGenJetNo[ij][jk]->Sumw2();
	
      sprintf(name,"Pt_Ratio_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt Ratio %s EtaBin%i",JetRad[ij],jk+1);
      Pt_Ratio[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      Pt_Ratio[ij][jk]->Sumw2();
	
      sprintf(name,"Pt_Ratio_nomatch_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt Ratio nomatch %s EtaBin%i",JetRad[ij],jk+1);
      Pt_Ratio_nomatch[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      Pt_Ratio_nomatch[ij][jk]->Sumw2();
      
      for(int kl=0; kl<noptbins; kl++){
			
	sprintf(name,"Resolution_%s_EtaBin%i_PtBin%i",JetRad[ij],jk+1,kl+1);
	sprintf(title,"Resolution %s EtaBin%i PtBin%i",JetRad[ij],jk+1,kl+1);
	Resolution[ij][jk][kl] = new TH1F(name,title,200,-2.0,2.0);
	Resolution[ij][jk][kl]->Sumw2();
	
	sprintf(name,"DeltaR_%s_EtaBin%i_PtBin%i",JetRad[ij],jk+1,kl+1);
	sprintf(title,"DeltaR %s EtaBin%i PtBin%i",JetRad[ij],jk+1,kl+1);
	DeltaR_RecoGen[ij][jk][kl] = new TH1F(name,title,360,0,3.6);
	DeltaR_RecoGen[ij][jk][kl]->Sumw2();
	
	sprintf(name,"DeltaR_Matrix_%s_EtaBin%i_PtBin%i",JetRad[ij],jk+1,kl+1);
	sprintf(title,"DeltaR Matrix %s EtaBin%i PtBin%i",JetRad[ij],jk+1,kl+1);
	DeltaR_RecoGen_mat[ij][jk][kl] = new TH1F(name,title,360,0,3.6);
	DeltaR_RecoGen_mat[ij][jk][kl]->Sumw2();
      }//kl
     }//isMC
    }//jk
	
	
    sprintf(name,"Jety_%s",JetRad[ij]);
    sprintf(title,"Jet Rapidity for %s",JetRad[ij]);
    
    Jeteta[ij] = new TH1F(name,title,200,-5.0,5.0);
    Jeteta[ij]->Sumw2();
    
    sprintf(name,"Leading_Jety_%s",JetRad[ij]);
    sprintf(title,"Leading Jet Rapidity for %s",JetRad[ij]);
    
    LeadJeteta[ij] = new TH1F(name,title,100,-5.0,5.0);
    LeadJeteta[ij]->Sumw2();
    
    sprintf(name,"Leading2Jets_deltaR_%s",JetRad[ij]);
    sprintf(title,"Leading 2 Jets deltaR for %s",JetRad[ij]);
    
    Leading2JetsDeltaR[ij] = new TH1F(name,title,100,0,8.0);
    Leading2JetsDeltaR[ij]->Sumw2();
    
    sprintf(name,"Leading2Jets_deltaPhi_%s",JetRad[ij]);
    sprintf(title,"Leading 2 Jets deltaPhi for %s",JetRad[ij]);
    
    Leading2JetsDeltaPhi[ij] = new TH1F(name,title,75,0,2*pival);
    Leading2JetsDeltaPhi[ij]->Sumw2();
	
    if(isMC){
      
      sprintf(name,"GenJety_%s",JetRad[ij]);
      sprintf(title,"GenJet Rapidity for %s",JetRad[ij]);
      
      GenJeteta[ij] = new TH1F(name,title,200,-5.0,5.0);
      GenJeteta[ij]->Sumw2();
      
      sprintf(name,"Leading_GenJety_%s",JetRad[ij]);
      sprintf(title,"Leading GenJet Rapidity for %s",JetRad[ij]);
      
      GenLeadJeteta[ij] = new TH1F(name,title,100,-5.0,5.0);
      GenLeadJeteta[ij]->Sumw2();
      
      sprintf(name,"Leading2GenJets_deltaR_%s",JetRad[ij]);
      sprintf(title,"Leading 2 GenJets deltaR for %s",JetRad[ij]);
      
      GenLeading2JetsDeltaR[ij] = new TH1F(name,title,100,0,8.0);
      GenLeading2JetsDeltaR[ij]->Sumw2();
      
      sprintf(name,"Leading2GenJets_deltaPhi_%s",JetRad[ij]);
      sprintf(title,"Leading 2 GenJets deltaPhi for %s",JetRad[ij]);
      
      GenLeading2JetsDeltaPhi[ij] = new TH1F(name,title,75,0,2*pival);
      GenLeading2JetsDeltaPhi[ij]->Sumw2();
      
      sprintf(name,"Response_y_%s", JetRad[ij]);
      sprintf(title,"Response Matrix in y for %s Jets",JetRad[ij]);
	  
      Response_y[ij] = new TH2F(name,title,netarange,etarng,netarange,etarng);
      Response_y[ij]->Sumw2();
	  
      sprintf(name,"Resolution_y_%s", JetRad[ij]);
      sprintf(title,"Resolution in y for %s Jets",JetRad[ij]);
	  
      y_Reso[ij] = new TH1F(name,title,100,-10.,10.);
      y_Reso[ij]->Sumw2();
	  
      sprintf(name,"Resolution_phi_%s", JetRad[ij]);
      sprintf(title,"Resolution in phi for %s Jets",JetRad[ij]);
	  
      phi_Reso[ij] = new TH1F(name,title,100,-pival,pival);
      phi_Reso[ij]->Sumw2();
      
      sprintf(name,"Pthat_vs_LeadingJet_Pt_%s",JetRad[ij]);
      sprintf(title,"Pthat vs LeadingJet Pt %s",JetRad[ij]);
      
      Pthat_vs_LeadPt[ij] = new TH2F(name,title,noptbins,ptbins,noptbins,ptbins);
      Pthat_vs_LeadPt[ij]->Sumw2();
    }
  }//ij
  
     double dattot[nHLTmx]={0};
    double mctot=0;
    for (int ij=0; ij<npileupmx; ij++) {
      for (int jk=0; jk<nHLTmx; jk++) {
	dattot[jk] +=datpileup[jk][ij];
      }
      mctot +=mcpileup[ij];
    }
  //  std::cout<<"datatot "<<dattot[0]<<endl;
   
    for (int ij=0; ij<npileupmx; ij++) {
      mcpileup[ij] /=TMath::Max(1.e-6,mctot);
      for (int jk=0; jk<nHLTmx; jk++) {
	datpileup[jk][ij] /=TMath::Max(1.e-6,dattot[jk]);

#ifdef PU_UP
	rat_pileup[jk][ij] =  datpileup_up[jk][ij]*1./mcpileup[ij];
#elif defined(PU_DN)  
	rat_pileup[jk][ij] =  datpileup_dn[jk][ij]*1./mcpileup[ij];
#else
    rat_pileup[jk][ij] =  datpileup[jk][ij]*1./mcpileup[ij];
#endif
    
	//if(jk==0) { cout<<ij<<" ratio "<<rat_pileup[jk][ij]<<endl;}
    
		}
    }
///prescale///

for(int ij=0; ij<nHLTmx; ij++){
          compres[ij] = compresB[ij];
        }
/*
gmrand = int(10*gRandom3->Uniform());
TString msg = TString::Format("Intital Random %i\n",gmrand);
gProofServ->SendAsynMessage(msg);
*/
/*
std::vector<float> _jkmore;

Long64_t nentries5 = (fChain ? fChain->GetEntriesFast() : fChain->GetEntriesFast());
for (Long64_t jentry5=0; jentry5<nentries5; jentry5++) {

 if (_jkmore.size()==0) { // if jkmore is empty, reset it first
     for (int ijk = 0; ijk != nrun; ++ijk) _jkmore.push_back(ijk);
   }
 int m = _jkmore.size(); assert(m!=0);
 int mout = gRandom3->Integer(m);
 int iout = int(_jkmore[mout]);
 _outlist[jentry5] = iout;
 _jkmore.erase(_jkmore.begin()+mout); 
  
  } 
*/  
}

Bool_t suman_rscan::Process(Long64_t entry)
{
   // The Process() function is called for each entry in the tree (or possibly
   // keyed object in the case of PROOF) to be processed. The entry argument
   // specifies which entry in the currently loaded tree is to be processed.
   // It can be passed to either suman_rscan::GetEntry() or TBranch::GetEntry()
   // to read either all or the required parts of the data. When processing
   // keyed objects with PROOF, the object is already loaded and is available
   // via the fObject pointer.
   //
   // This function should contain the "body" of the analysis. It can contain
   // simple or elaborate selection criteria, run algorithms on the data
   // of the event and typically fill histograms.
   //
   // The processing can be stopped by calling Abort().
   //
   // Use fStatus to set the return value of TTree::Process().
   //
   // The return value is currently not used.

  minPFPt = 20.;
  double leadingPtThreshold[nHLTmx+1]= {74, 97, 133, 196, 272, 330, 395, 468, 548, 592, 5000.0};
//  double leadingPtThreshold[nHLTmx+1]= {97, 98, 133, 196, 272, 330, 395, 468,548,5000,50000};
  int iRecoPTbin[nalgo] = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};
  int iGenPTbin[nalgo] = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};
  
  double etarng[netarange+1] ={0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.2, 3.7, 4.2, 4.7};
  
  double ptbins[noptbins+1] = {/*30, 37, 43, 49, 56, 64,*/ 74, 84,
     97, 114, 133, 153, 174, 196, 220, 245, 272, 300, 330, 362, 395, 430, 468, 
     507, 548, 592, 638, 686, 737, 790, 846, 905, 967, 
     1032, 1101, 1172, 1248, 1327, 1410, 1497, 1588, 1684, 1784, 1890, 2000, 
     2116, 2238, 2366, 2500, 2640, 2787, 2941, 3103, 3273, 3450, 3637, 3832,
     4037, 4252, 4477, 4713, 4961, 5220, 5492, 5777, 6076, 6389, 6717, 7000} ;


 double ptbins1[noptbins1+1] = {30, 37, 43, 49, 56, 64, 74, 84,
     97, 114, 133, 153, 174, 196, 220, 245, 272, 300, 330, 362, 395, 430, 468,
     507, 548, 592, 638, 686, 737, 790, 846, 905, 967,
     1032, 1101, 1172, 1248, 1327, 1410, 1497, 1588, 1684, 1784, 1890, 2000,
     2116, 2238, 2366, 2500, 2640, 2787, 2941, 3103, 3273, 3450, 3637, 3832,
     4037, 4252, 4477, 4713, 4961, 5220, 5492, 5777, 6076, 6389, 6717, 7000} ;
 
 double cor_expo[nalgo][netarange][nopol] =
  {{{1.04033,-3.64331e-05,1.98343e-08,-3.55626e-12,5.11899,-131.923}
,{1.05914,-6.20706e-05,3.79549e-08,-7.9879e-12,6.24604,-237.012}
,{1.09085,-7.58912e-05,4.79356e-08,-1.25831e-11,9.53956,-404.21}
,{1.02621,1.51894e-05,1.83066e-08,-1.37501e-11,17.7808,-699.715}
,{0.955284,0.000247344,-2.93769e-07,1.23843e-10,13.6278,-341.084}
,{0.826679,0.000637292,-9.66587e-07,5.22191e-10,13.0779,-345.583}
,{0.881428,0.00115964,-3.5195e-06,3.44489e-09,21.8642,-518.429}
,{0.622612,0.00121634,-1.0177e-07,-2.71201e-09,65.7353,-2711.9}
,{0.624648,0.00153669,-1.45248e-06,1.90926e-09,66.3524,-2466.34}
,{0.738121,0.00600743,1.53217e-05,-3.18203e-07,40.7932,-2274.65}
}
,{{1.03607,-3.21972e-05,1.66915e-08,-2.88258e-12,0.660311,-17.9514}
,{1.05132,-5.74922e-05,3.60593e-08,-7.77781e-12,0.048954,-9.87005}
,{1.06742,-6.27322e-05,4.35061e-08,-1.1942e-11,1.6426,-63.9275}
,{1.03911,-3.73455e-05,4.99888e-08,-2.0179e-11,7.92378,-315.1}
,{0.891108,0.000399213,-4.98966e-07,2.16624e-10,22.7171,-835.782}
,{0.729902,0.000969495,-1.48048e-06,7.92853e-10,32.068,-1072.87}
,{0.889388,0.00101562,-3.44448e-06,3.9793e-09,15.5322,-430.272}
,{0.583623,0.00107421,-8.39675e-08,-2.43872e-09,60.9275,-2549.93}
,{0.613599,0.000656432,-3.80325e-06,2.23747e-08,73.9402,-3245.32}
,{1.17398,-0.00205222,-6.13388e-05,2.89517e-07,137.036,-8797.45}
}
,{{1.0178,-1.57937e-05,8.51326e-09,-1.41742e-12,-0.265856,20.932}
,{1.02709,-3.58124e-05,2.53973e-08,-5.90805e-12,-0.893352,32.7147}
,{1.03169,-3.36289e-05,2.92782e-08,-9.16402e-12,0.107511,14.0397}
,{1.03094,-4.39476e-05,5.22281e-08,-2.06604e-11,1.75966,-54.6825}
,{0.959269,0.00017989,-2.30374e-07,1.02478e-10,10.2743,-400.481}
,{0.714169,0.00104531,-1.6615e-06,9.2036e-10,32.8182,-1157.68}
,{0.773515,0.000973576,-2.12284e-06,1.55937e-09,25.2452,-900.908}
,{0.876486,0.00125318,-5.028e-06,5.83559e-09,3.5601,37.7052}
,{0.568128,0.000891751,-2.45289e-06,1.48422e-08,64.8008,-2719.29}
,{1.04701,-0.00236701,-5.58118e-05,3.00994e-07,128.697,-7887.08}
}
,{{1.00508,-2.81698e-06,1.845e-09,-2.63281e-13,-0.194419,8.60072}
,{1.01315,-2.17064e-05,1.73178e-08,-4.29921e-12,-1.47011,65.9556}
,{1.00283,4.10784e-06,-7.42282e-10,-6.36857e-13,0.274104,-2.28247}
,{1.02446,-4.57109e-05,5.3113e-08,-2.11668e-11,-3.26996,149.153}
,{0.963847,0.000163316,-2.28602e-07,1.07813e-10,4.73502,-237.073}
,{0.781721,0.000796703,-1.25496e-06,6.74349e-10,24.3249,-948.122}
,{0.836501,0.000984173,-2.98374e-06,2.95226e-09,11.4805,-304.169}
,{0.905473,0.0013117,-5.94031e-06,7.42724e-09,-3.20873,274.449}
,{0.515491,0.00149853,2.47794e-07,-3.79977e-09,50.834,-1808.58}
,{0.889408,-0.00133754,-4.23672e-05,2.2474e-07,104.632,-5996.59}
}
,{{0.998846,3.75256e-06,-1.40045e-09,2.75792e-13,-0.569115,30.6463}
,{1.00215,-7.45134e-06,8.84511e-09,-2.58052e-12,-1.46952,62.9579}
,{0.989933,1.82561e-05,-1.00281e-08,1.56701e-12,-0.963802,41.7634}
,{1.01876,-4.26245e-05,5.02032e-08,-2.00013e-11,-7.7612,313.089}
,{0.969388,0.000125521,-1.82738e-07,8.8002e-11,-0.587928,-88.707}
,{0.844226,0.000573881,-9.04692e-07,4.73906e-10,14.8429,-657.666}
,{0.827053,0.000980823,-2.88571e-06,2.73334e-09,14.1374,-458.742}
,{0.902447,0.00130827,-5.79877e-06,7.06859e-09,-1.66747,224.949}
,{0.495264,0.00173452,1.44407e-06,-1.07761e-08,46.3329,-1428.39}
,{0.872415,-0.00126548,-4.04376e-05,2.15091e-07,102.838,-5889.08}
}
,{{0.991915,1.30233e-05,-6.5848e-09,1.27108e-12,-0.374474,22.7341}
,{0.996529,-9.30008e-07,5.5966e-09,-2.02154e-12,-2.11581,99.1986}
,{0.980079,2.97856e-05,-1.66785e-08,2.94182e-12,-2.23496,81.9123}
,{1.01372,-3.83359e-05,4.72343e-08,-1.91208e-11,-12.3251,472.614}
,{0.967971,0.000115721,-1.79068e-07,8.9341e-11,-5.35398,72.0622}
,{0.869372,0.000488672,-7.95157e-07,4.24889e-10,10.136,-492.949}
,{0.823609,0.000957718,-2.853e-06,2.70757e-09,16.3699,-485.048}
,{0.891905,0.00128832,-5.52408e-06,6.51739e-09,0.397437,182.164}
,{0.467511,0.0022037,3.06955e-06,-2.31112e-08,35.4945,-632.456}
,{0.787998,-0.000306734,-3.07727e-05,1.50479e-07,86.7368,-4769.96}
}
,{{1.0052,-1.31352e-06,1.13764e-10,1.96224e-13,-0.679519,0.713063}
,{1.01562,-2.21674e-05,1.56615e-08,-3.64546e-12,-2.23852,77.1473}
,{1.00576,5.25454e-06,-5.50738e-09,1.22974e-12,0.308376,-37.2541}
,{1.03275,-5.64184e-05,5.57544e-08,-1.96299e-11,-3.61302,164.536}
,{0.986054,0.000104039,-1.54529e-07,7.54549e-11,2.04205,-161.232}
,{0.811547,0.000688079,-1.11831e-06,6.20522e-10,21.1142,-979.632}
,{0.765771,0.000984298,-2.15919e-06,1.52983e-09,21.3899,-834.764}
,{0.822333,0.00125949,-4.41964e-06,4.50524e-09,7.36271,-209.861}
,{0.489322,0.0017541,1.46052e-06,-1.23409e-08,44.8618,-1403.11}
,{0.667771,0.000919285,-1.74888e-05,6.12906e-08,66.2452,-3203.67}
}
,{{1.00562,-1.68413e-06,4.14295e-10,1.20709e-13,-0.418881,28.6381}
,{1.01455,-2.10535e-05,1.55753e-08,-3.75413e-12,-1.89349,95.1722}
,{1.00731,7.68167e-07,-1.49319e-09,1.05752e-13,-0.826904,63.2633}
,{1.03543,-5.9815e-05,5.66107e-08,-1.92958e-11,-5.62578,269.471}
,{1.009,4.87778e-05,-1.02214e-07,5.65692e-11,-2.88377,39.9689}
,{0.877886,0.000465583,-7.75099e-07,4.19478e-10,11.7121,-543.578}
,{0.809937,0.000963269,-2.64708e-06,2.3306e-09,18.1215,-610.716}
,{0.830065,0.00121962,-4.52328e-06,4.9424e-09,9.41142,-226.6}
,{0.495137,0.00169333,1.16907e-06,-1.05576e-08,46.3915,-1438.92}
,{0.630113,0.00138445,-1.27691e-05,3.01363e-08,59.0254,-2666.44}
}
,{{1.00562,-1.22229e-06,2.33718e-10,1.31286e-13,0.216763,52.9811}
,{1.01571,-2.26917e-05,1.68179e-08,-4.05481e-12,-1.79341,157.653}
,{1.00532,3.50423e-06,-3.18823e-09,4.72972e-13,-0.927314,116.072}
,{1.03753,-6.28618e-05,5.92741e-08,-2.03363e-11,-7.41304,349.47}
,{1.01948,2.23499e-05,-7.62897e-08,4.62206e-11,-5.72515,169.78}
,{0.843769,0.000647517,-1.13737e-06,6.57306e-10,13.7769,-426.955}
,{0.852381,0.0010261,-2.98242e-06,2.41523e-09,12.7895,-154.148}
,{0.857706,0.00122283,-4.81015e-06,5.33994e-09,8.04427,-13.8241}
,{0.51767,0.00152649,3.15836e-07,-6.05122e-09,51.5561,-1701.26}
,{0.457864,0.00326478,7.47432e-06,-1.09315e-07,30.0051,-547.574}
}
,{{1.01336,-1.27321e-05,7.24538e-09,-1.29725e-12,-0.599943,198.203}
,{1.01581,-2.20848e-05,1.63403e-08,-3.94765e-12,-1.06292,207.397}
,{1.00053,1.29243e-05,-1.058e-08,2.38609e-12,-0.258002,135.407}
,{1.04185,-6.85406e-05,6.277e-08,-2.11238e-11,-9.95251,480.216}
,{1.02091,3.0962e-05,-1.02013e-07,6.17912e-11,-7.64051,325.938}
,{0.863869,0.000570473,-9.97065e-07,5.6536e-10,11.5705,-14.941}
,{0.887305,0.00102353,-3.29964e-06,2.89728e-09,13.1257,157.368}
,{0.862064,0.00120565,-4.84745e-06,5.54784e-09,13.039,-10.3576}
,{0.496959,0.0019502,2.12147e-06,-1.94128e-08,45.2158,-1010.24}
,{0.457638,0.00326035,7.45213e-06,-1.08259e-07,30.0734,-508.239}
}
,{{1.01548,-1.46881e-05,8.14405e-09,-1.44591e-12,0.16008,278.443}
,{1.01937,-2.70592e-05,1.95574e-08,-4.67144e-12,-0.686124,321.656}
,{1.00781,-7.90622e-08,-1.41314e-09,2.11957e-13,-1.79312,309.502}
,{1.0441,-6.67082e-05,5.77079e-08,-1.89105e-11,-12.5008,620.936}
,{1.07691,-0.000143212,1.21425e-07,-3.95789e-11,-15.8501,858.791}
,{0.753126,0.00093782,-1.51391e-06,8.19259e-10,26.7574,-121.259}
,{0.864701,0.00102888,-2.77724e-06,1.9168e-09,22.2685,300.708}
,{0.810602,0.00112612,-3.71965e-06,3.63973e-09,28.2278,-297.265}
,{0.546385,0.0015486,1.59813e-08,-7.56607e-09,56.2794,-1563.56}
,{0.466463,0.00331042,7.34795e-06,-1.13027e-07,30.7237,-500.597}
}
,{{1.0234,-2.59568e-05,1.50189e-08,-2.88075e-12,-0.0577996,474.403}
,{1.02216,-3.00755e-05,2.10005e-08,-4.90849e-12,0.297714,444.674}
,{1.01398,-1.10478e-05,6.80833e-09,-1.9625e-12,-2.89252,483.385}
,{1.06089,-9.53801e-05,7.86655e-08,-2.41535e-11,-18.0951,945.944}
,{1.01213,2.93476e-05,-7.87108e-08,4.06614e-11,-6.19105,731.029}
,{0.609443,0.00131158,-1.9637e-06,1.02749e-09,52.5428,-642.441}
,{0.82379,0.000939727,-2.1732e-06,1.29994e-09,43.4308,-222.476}
,{0.612354,0.000956665,-4.09306e-07,-1.81246e-09,72.3698,-1786.36}
,{0.576023,0.00140195,-7.48634e-07,-3.22693e-09,63.2006,-1643.34}
,{0.470609,0.00332195,7.32567e-06,-1.148e-07,31.661,-348.959}
}
};
 
 
  double hoteta[6] = {-2.25,-1.93,-3.489,-3.139,-3.60,-3.139};
  double hotphi[6] = {2.2,2.5,2.237,2.475,2.237,2.475};

  GetEntry(entry);
  
//   void fillarray() {
 
//  TString msg = TString::Format("Initial Random %i\n",_outlist[entry]);
//  gProofServ->SendAsynMessage(msg);
//  int runtag = (ievt+gmrand)%nrun;
/*
  gRandom3->SetSeed(123456789*entry);
  gmrand = int((10*nrun*gRandom3->Uniform())/nrun);
  int runtag = (entry+gmrand)%nrun;
*/  
/*
  int runtag = entry%nrun;
  gRandom3->SetSeed(123456789*entry);
  gmrand = int(nrun*gRandom3->Uniform());
*/
  int runtag = _outlist[entry];

  miset = PFMET;
  misphi = PFMETPhi;
  sumEt = sumEt;
  
  nvert = nvert;
  nchict = nchict;
  event_weight = event_weight;
  tot_weight+=event_weight;
  pthat = pthat;
 
  trig_value = trig_value;

  for(int ht=0; ht<nHLTmx; ht++){

   ihlt[ht] = 0;

   switch(ht){

   case 0:
   ihlt[ht] = ihlt01;
   break;

   case 1:
   ihlt[ht] = ihlt02;
   break;

   case 2:
   ihlt[ht] = ihlt03;
   break;

   case 3:
   ihlt[ht] = ihlt04;
   break;

   case 4:
   ihlt[ht] = ihlt05;
   break;

   case 5:
   ihlt[ht] = ihlt06;
   break;

   case 6:
   ihlt[ht] = ihlt07;
   break;

   case 7:
   ihlt[ht] = ihlt08;
   break;

   case 8:
   ihlt[ht] = ihlt09;
   break;

   case 9:
   ihlt[ht] = ihlt10;
   break;

    }

  }
 
  TString str;

  for(int ij=0; ij<nalgo; ij++){
           for(int jk=0; jk<netarange; jk++){
                  double parvalues[nopol]={0};
                   for(int kl=0; kl<nopol; kl++){
                           parvalues[kl] = cor_expo[ij][jk][kl];
                   }

                fit_cor[ij][jk]->SetParameters(parvalues);
           }
   }

//  ifp.close();

 
  for(int ix=0; ix<nalgo; ix++){
    njets[ix] = 0;
    ngenjets[ix] = 0;
    
    switch(ix){
      
    case 0:

      
       if(pfjettightID01[0]!=1) break;
       if(isMC){
         if(pfjetpT01[0]>(3.*pthat)) break;
        } 
    
      trig_weight[ix] = trig_weight01;

      for(int jet=0; jet<npfjets01; jet++){
	
	if(pfjettightID01[jet]!=1) continue;
	if(pfjetpT01[jet]<minPFPt) continue ;
	
	pfjetenr[ix][njets[ix]] = pfjetenr01[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT01[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea01[jet] ;
	pfjety[ix][njets[ix]] = pfjety01[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi01[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID01[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID01[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup01[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn01[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC01[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL101[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL201[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L301[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth01[jet];

	njets[ix]++;
      }

      if(isMC){
      for(int gjet=0; gjet<ngenjets01; gjet++){
	
	if(genjetpT01[gjet]<minPFPt) continue ;	
	
	genjetenr[ix][ngenjets[ix]] = genjetenr01[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT01[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea01[gjet];
	genjety[ix][ngenjets[ix]] = genjety01[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi01[gjet];
	
	ngenjets[ix]++;
      }	
     }  
      break;	
      
    case 1:
      
       if(pfjettightID02[0]!=1) break;
       if(isMC){
         if(pfjetpT02[0]>(3.*pthat)) break;
        }      

      trig_weight[ix] = trig_weight02;

      for(int jet=0; jet<npfjets02; jet++){
	
	if(pfjettightID02[jet]!=1) continue;
	if(pfjetpT02[jet]<minPFPt) continue ;
	
	pfjetenr[ix][njets[ix]] = pfjetenr02[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT02[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea02[jet] ;
	pfjety[ix][njets[ix]] = pfjety02[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi02[jet] ;
    pfjettightID[ix][njets[ix]] = pfjettightID02[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID02[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup02[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn02[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC02[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL102[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL202[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L302[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth02[jet];
	
	njets[ix]++;
      }
     
     if(isMC){
      for(int gjet=0; gjet<ngenjets02; gjet++){
	
	if(genjetpT02[gjet]<minPFPt) continue ;	
	
	genjetenr[ix][ngenjets[ix]] = genjetenr02[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT02[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea02[gjet];
	genjety[ix][ngenjets[ix]] = genjety02[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi02[gjet];
	
	ngenjets[ix]++;
      }
     }      

      break;	
      
      
    case 2:
      
       if(pfjettightID03[0]!=1) break;
       if(isMC){
         if(pfjetpT03[0]>(3.*pthat)) break;
        }      

      trig_weight[ix] = trig_weight03;

      for(int jet=0; jet<npfjets03; jet++){
	
	if(pfjettightID03[jet]!=1) continue;
	if(pfjetpT03[jet]<minPFPt) continue ;
	
	pfjetenr[ix][njets[ix]] = pfjetenr03[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT03[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea03[jet] ;
	pfjety[ix][njets[ix]] = pfjety03[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi03[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID03[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID03[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup03[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn03[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC03[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL103[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL203[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L303[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth03[jet];
	
	njets[ix]++;
      }
     
      if(isMC){
      for(int gjet=0; gjet<ngenjets03; gjet++){
	
	if(genjetpT03[gjet]<minPFPt) continue ;	
	
	genjetenr[ix][ngenjets[ix]] = genjetenr03[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT03[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea03[gjet];
	genjety[ix][ngenjets[ix]] = genjety03[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi03[gjet];
	
	ngenjets[ix]++;
      }
    }      

      break;	
      
      
    case 3:
      
       if(pfjettightID04[0]!=1) break;
       if(isMC){
         if(pfjetpT04[0]>(3.*pthat)) break;
        }  
    
      trig_weight[ix] = trig_weight04;

      for(int jet=0; jet<npfjets04; jet++){
	
	if(pfjettightID04[jet]!=1) continue;
	if(pfjetpT04[jet]<minPFPt) continue ;
	
	pfjetenr[ix][njets[ix]] = pfjetenr04[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT04[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea04[jet] ;
	pfjety[ix][njets[ix]] = pfjety04[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi04[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID04[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID04[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup04[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn04[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC04[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL104[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL204[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L304[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth04[jet];
				
	njets[ix]++;
      }
  
     if(isMC){	
      for(int gjet=0; gjet<ngenjets04; gjet++){
						
	if(genjetpT04[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr04[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT04[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea04[gjet];
	genjety[ix][ngenjets[ix]] = genjety04[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi04[gjet];
				 
	ngenjets[ix]++;
      }
    }				
      break;	
		
		    
    case 4:
     
      if(pfjettightID05[0]!=1) break;
      if(isMC){
         if(pfjetpT05[0]>(3.*pthat)) break;
        }  
   
      trig_weight[ix] = trig_weight05;

      for(int jet=0; jet<npfjets05; jet++){
	
	if(pfjettightID05[jet]!=1) continue;
	if(pfjetpT05[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr05[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT05[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea05[jet] ;
	pfjety[ix][njets[ix]] = pfjety05[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi05[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID05[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID05[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup05[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn05[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC05[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL105[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL205[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L305[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth05[jet];
				
	njets[ix]++;
      }

    if(isMC){				
      for(int gjet=0; gjet<ngenjets05; gjet++){
						
	if(genjetpT05[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr05[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT05[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea05[gjet];
	genjety[ix][ngenjets[ix]] = genjety05[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi05[gjet];
				 
	ngenjets[ix]++;
      }
     }
      break;		
			
		
    case 5:
      
       if(pfjettightID06[0]!=1) break;
       if(isMC){
         if(pfjetpT06[0]>(3.*pthat)) break;
        } 
     
      trig_weight[ix] = trig_weight06;

      for(int jet=0; jet<npfjets06; jet++){
	
	if(pfjettightID06[jet]!=1) continue;
	if(pfjetpT06[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr06[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT06[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea06[jet] ;
	pfjety[ix][njets[ix]] = pfjety06[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi06[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID06[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID06[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup06[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn06[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC06[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL106[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL206[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L306[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth06[jet];
				
	njets[ix]++;
      }

     if(isMC){	
      for(int gjet=0; gjet<ngenjets06; gjet++){
						
	if(genjetpT06[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr06[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT06[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea06[gjet];
	genjety[ix][ngenjets[ix]] = genjety06[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi06[gjet];
			 
	ngenjets[ix]++;
      }
     }					
      break;	
			
			
    case 6:
    
      if(pfjettightID07[0]!=1) break;
      if(isMC){
         if(pfjetpT07[0]>(3.*pthat)) break;
        }   
    
      trig_weight[ix] = trig_weight07;

      for(int jet=0; jet<npfjets07; jet++){
				
	if(pfjettightID07[jet]!=1) continue;
	if(pfjetpT07[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr07[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT07[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea07[jet] ;
	pfjety[ix][njets[ix]] = pfjety07[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi07[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID07[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID07[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup07[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn07[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC07[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL107[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL207[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L307[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth07[jet];
				
	njets[ix]++;
      }

    if(isMC){			
      for(int gjet=0; gjet<ngenjets07; gjet++){
						
	if(genjetpT07[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr07[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT07[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea07[gjet];
	genjety[ix][ngenjets[ix]] = genjety07[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi07[gjet];
				 
	ngenjets[ix]++;
      }
     }				
      break;	
			
			
    case 7:
    
     if(pfjettightID08[0]!=1) break;
     if(isMC){
         if(pfjetpT08[0]>(3.*pthat)) break;
        } 

      trig_weight[ix] = trig_weight08;
   
      for(int jet=0; jet<npfjets08; jet++){
				
	if(pfjettightID08[jet]!=1) continue;
	if(pfjetpT08[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr08[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT08[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea08[jet] ;
	pfjety[ix][njets[ix]] = pfjety08[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi08[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID08[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID08[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup08[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn08[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC08[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL108[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL208[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L308[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth08[jet];
				
	njets[ix]++;
      }

    if(isMC){	
      for(int gjet=0; gjet<ngenjets08; gjet++){
						
	if(genjetpT08[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr08[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT08[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea08[gjet];
	genjety[ix][ngenjets[ix]] = genjety08[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi08[gjet];
				 
	ngenjets[ix]++;
      }
    }
				 
      break;	
			
			
    case 8:
      
       if(pfjettightID09[0]!=1) break;
       if(isMC){
         if(pfjetpT09[0]>(3.*pthat)) break;
        }   

      trig_weight[ix] = trig_weight09;   

      for(int jet=0; jet<npfjets09; jet++){
	
	if(pfjettightID09[jet]!=1) continue;
	if(pfjetpT09[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr09[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT09[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea09[jet] ;
	pfjety[ix][njets[ix]] = pfjety09[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi09[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID09[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID09[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup09[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn09[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC09[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL109[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL209[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L309[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth09[jet];
				
	njets[ix]++;
      }

    if(isMC){		
      for(int gjet=0; gjet<ngenjets09; gjet++){
						
	if(genjetpT09[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr09[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT09[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea09[gjet];
	genjety[ix][ngenjets[ix]] = genjety09[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi09[gjet];
				 
	ngenjets[ix]++;
      }
     }
      break;	
			
			
    case 9:
     
      if(pfjettightID10[0]!=1) break;
      if(isMC){
         if(pfjetpT10[0]>(3.*pthat)) break;
        }     

      trig_weight[ix] = trig_weight10;

      for(int jet=0; jet<npfjets10; jet++){
	
	if(pfjettightID10[jet]!=1) continue;
	if(pfjetpT10[jet]<minPFPt) continue ;
		
	pfjetenr[ix][njets[ix]] = pfjetenr10[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT10[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea10[jet] ;
	pfjety[ix][njets[ix]] = pfjety10[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi10[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID10[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID10[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup10[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn10[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC10[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL110[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL210[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L310[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth10[jet];
				
	njets[ix]++;
      }
      
    if(isMC){
      for(int gjet=0; gjet<ngenjets10; gjet++){
						
	if(genjetpT10[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr10[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT10[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea10[gjet];
	genjety[ix][ngenjets[ix]] = genjety10[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi10[gjet];
				 
	ngenjets[ix]++;
      }
     }
      break;				
			
    case 10:
      
      if(pfjettightID11[0]!=1) break;
      if(isMC){
         if(pfjetpT11[0]>(3.*pthat)) break;
        }   
   
      trig_weight[ix] = trig_weight11;

      for(int jet=0; jet<npfjets11; jet++){
				
	if(pfjettightID11[jet]!=1) continue;
	if(pfjetpT11[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr11[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT11[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea11[jet] ;
	pfjety[ix][njets[ix]] = pfjety11[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi11[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID11[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID11[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup11[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn11[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC11[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL111[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL211[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L311[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth11[jet];
				
	njets[ix]++;
      }

     if(isMC){	
      for(int gjet=0; gjet<ngenjets11; gjet++){	
					
	if(genjetpT11[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr11[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT11[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea11[gjet];
	genjety[ix][ngenjets[ix]] = genjety11[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi11[gjet];
			 
	ngenjets[ix]++;
      }
     }
      break;				
			
    case 11:
      
      if(pfjettightID12[0]!=1) break;
      if(isMC){
        if(pfjetpT12[0]>(3.*pthat)) break;
        }      

      trig_weight[ix] = trig_weight12;

      for(int jet=0; jet<npfjets12; jet++){
				
	
	if(pfjettightID12[jet]!=1) continue;
	if(pfjetpT12[jet]<minPFPt) continue ;
	//cout<<"jet "<<jet+1<<" pt "<<pfjetpT12[jet]<<endl;
				
	pfjetenr[ix][njets[ix]] = pfjetenr12[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT12[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea12[jet] ;
	pfjety[ix][njets[ix]] = pfjety12[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi12[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID12[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID12[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpTup12[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpTdn12[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC12[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL112[jet];
	pfjetJECL2[ix][njets[ix]] = pfjetJECL212[jet];
	pfjetJECL2L3[ix][njets[ix]] = pfjetJECL2L312[jet];
	pfjetwidth[ix][njets[ix]] = pfjetwidth12[jet];
				
	njets[ix]++;
      }

     if(isMC){				
      for(int gjet=0; gjet<ngenjets12; gjet++){
					
	if(genjetpT12[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr12[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT12[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea12[gjet];
	genjety[ix][ngenjets[ix]] = genjety12[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi12[gjet];
				 
	ngenjets[ix]++;
      }
     }
      break;	
			
    }//switch(ix)
  }//ix  
//fillarray
/*
if(irun==281727&&(ievt==1700660471||ievt==1701073507||ievt==1699809726||ievt==1225421951)){
for(int jet=0; jet<njets[3]; jet++){
                if(jet==0){
		TString msg = TString::Format("Run no %i LS %i Event No %i",irun,ilumi,ievt);
		gProofServ->SendAsynMessage(msg);
		}
		TString msg1 = TString::Format("AK4Jet %i pT(with jec) %f pTraw %f rapidity %f phi %f \n",jet+1,pfjetpT[3][jet],pfjetpT[3][jet]/pfjetJEC[3][jet],pfjety[3][jet],pfjetphi[3][jet]);
		gProofServ->SendAsynMessage(msg1);
                      }
        }
*/
  weight = 0; //event_weight;
//     weight*=rat_pileup[0][npu_vert];
 
     for (int ij=0; ij<nHLTmx; ij++) {
          weighttrg[ij] = 1.0;
           weighttrg[ij] *=compres[ij];
     }

     int ihlttrg[nHLTmx+1]= {0,0,0,0,0,0,0,0,0,0,0};

     if(trig_value>1){
//     ihlttrg[nHLTmx-int(log2(trig_value))] = 1;
     ihlttrg[nHLTmx] = 1;
//     cout<<"trig_value "<<trig_value<<endl;
     for (int ij=0; ij<nHLTmx; ij++) {
     ihlttrg[ij] = *(dec2bin(trig_value)+ij);
      }
     }      

    if(ihlttrg[nHLTmx] ==0) return kFALSE;

    if(getbinid(pfjetpT[7][0],nHLTmx, leadingPtThreshold)>=0){
    weight = weighttrg[getbinid(pfjetpT[7][0],nHLTmx, leadingPtThreshold)];
    }
    else {return kFALSE;}

     hist_pfmet->Fill(miset,weight);
     hist_SumEt->Fill(sumEt,weight);
     hist_METbyET->Fill(miset*1./sumEt,weight);

     if((miset*1./sumEt) > 0.3) return kFALSE;
            
     hist_PV_all->Fill(nvert,weight);     
     hist_PV_sel->Fill(nchict,weight);   
     hist_PU->Fill(npu_vert,weight); 
       
     PU_vs_PV_all->Fill(npu_vert,nvert);
     PU_vs_PV_sel->Fill(npu_vert,nchict);
     PU_vs_PV_sel_rewt->Fill(npu_vert,nchict,weight);
              
     for(int ix=0; ix<nalgo; ix++){
		
       iRecoPTbin[ix] = -1;
       iGenPTbin[ix] = -1;
		
       int njet_count[netarange] = {0};

	  int bincount[netarange][noptbins] = {{0}};
	  int bincount2d[netarange][noptbins][noptbins] = {{{0}}};
 
       for(int jet=0; jet<njets[ix]; jet++){
		
		#ifdef Run2016B
		
		if((pfjety[ix][jet]>hoteta[0] && pfjety[ix][jet]<hoteta[1])&&(pfjetphi[ix][jet]>hotphi[0] && pfjetphi[ix][jet]<hotphi[1])){
			continue;
		}
		
		#elif defined(Run2016C)
		
		if((pfjety[ix][jet]>hoteta[2] && pfjety[ix][jet]<hoteta[3])&&(pfjetphi[ix][jet]>hotphi[2] && pfjetphi[ix][jet]<hotphi[3])){
			continue;
		}
		
		#elif defined(Run2016D)
		
		if((pfjety[ix][jet]>hoteta[4] && pfjety[ix][jet]<hoteta[5])&&(pfjetphi[ix][jet]>hotphi[4] && pfjetphi[ix][jet]<hotphi[5])){
			continue;
		}
		#endif
		
			  
	  if(jet==0){
          iRecoPTbin[ix] = getbinid(pfjetpT[ix][jet],nHLTmx, leadingPtThreshold);
          
          if ((iRecoPTbin[ix]<0) || (iRecoPTbin[ix]>=(nHLTmx)) || (ihlttrg[iRecoPTbin[ix]]==0)) break;

      	  weight =  weighttrg[iRecoPTbin[ix]]; // trig_weight[ix];
	   }

	 int etatag = getbinid(abs(pfjety[ix][jet]),netarange,etarng);
/*	 
	 if(ix==3){
		 str = TString::Format("AK%i jet no. %i pt %f eta %f etatag %i",ix+1,jet+1,pfjetpT[ix][jet],pfjety[ix][jet],etatag);
	     if(gProofServ) gProofServ->SendAsynMessage(str);
		 }
*/	 
	 if(etatag>=0) {
	   njet_count[etatag]++;
	   
	   int ptbin_tag = getbinid(pfjetpT[ix][jet],noptbins1,ptbins1);

//	   double ex_cor = fit_cor[ix][etatag]->Eval(pfjetpT[ix][jet]);
//      pfjetpT[ix][jet] *= ex_cor;
		
	   for(int ijk=0; ijk < nrun; ijk++){	
		if(ijk!=runtag){
			JetpT_comb[ix][etatag][ijk]->Fill(pfjetpT[ix][jet],weight);
			}
	   }
	   
	   JetpT[ix][etatag]->Fill(pfjetpT[ix][jet],weight);
	   JetpT_up[ix][etatag]->Fill(pfjetpTup[ix][jet],weight);
	   JetpT_dn[ix][etatag]->Fill(pfjetpTdn[ix][jet],weight);

	   JetWidth[ix][etatag]->Fill(pfjetwidth[ix][jet],weight);	

	   if (pfjetpT[ix][jet]>leadingPtThreshold[0]) { Jeteta[ix]->Fill(pfjety[ix][jet],weight); }

          if(jet==0&&isMC) { Pthat_vs_LeadPt[ix]->Fill(pthat,pfjetpT[ix][jet]); }

	   JetPt_vs_JEC[ix][etatag]->Fill(pfjetpT[ix][jet],pfjetJEC[ix][jet],weight);
	   JetPt_vs_JECL1[ix][etatag]->Fill(pfjetpT[ix][jet],pfjetJECL1[ix][jet],weight);
	   JetPt_vs_JECL2[ix][etatag]->Fill(pfjetpT[ix][jet],pfjetJECL2[ix][jet],weight);
	   JetPt_vs_JECL2L3[ix][etatag]->Fill(pfjetpT[ix][jet],pfjetJECL2L3[ix][jet],weight); 
	  
	   int ptbin_tag_cov = getbinid(pfjetpT[ix][jet],noptbins,ptbins);
	   if(ptbin_tag_cov>=0 && etatag>=0) { bincount[etatag][ptbin_tag_cov] += 1; }
 
	   if(jet==0){
	     Prescale_JetpT[ix][etatag][iRecoPTbin[ix]]->Fill(pfjetpT[ix][jet]);
	     LeadJetpT[ix][etatag]->Fill(pfjetpT[ix][jet],weight);
	     if (pfjetpT[ix][jet]>leadingPtThreshold[0]) { LeadJeteta[ix]->Fill(pfjety[ix][jet],weight);}
	   }
	 }
       } //jet
      

       for(int eta=0; eta<netarange; eta++){

	 NJets[ix][eta]->Fill(njet_count[eta],weight) ;
	
	 for(int ijk=0; ijk < nrun; ijk++){	
		if(ijk!=runtag){
			NJets_comb[ix][eta][ijk]->Fill(njet_count[eta],weight) ;
			}
	   }
	 
/*
		for(int pti=0; pti<noptbins; pti++){
		   for(int ptj=0; ptj<noptbins; ptj++){
				bincount2d[eta][pti][ptj] = bincount[eta][pti] * bincount[eta][ptj];
				Mes_Cov[ix][eta]->SetBinContent(pti+1,ptj+1,Mes_Cov[ix][eta]->GetBinContent(pti+1,ptj+1) + bincount2d[eta][pti][ptj]);
			}
		}*/
       }

       if(njets[ix]>=2){
	 Leading2JetsDeltaR[ix]->Fill(delta2R(pfjety[ix][0],pfjetphi[ix][0],pfjety[ix][1],pfjetphi[ix][1]),weight);
	 Leading2JetsDeltaPhi[ix]->Fill(PhiInRange(pfjetphi[ix][0]-pfjetphi[ix][1]),weight);

	 if((njets[ix]==2)||((njets[ix]>2)&&(pfjetpT[ix][2]<50.))){
	   float p4[3]={0};
		
	   if(abs(PhiInRange(pfjetphi[ix][0]-pfjetphi[ix][1]))>(2*pival/3.)){
	     for(int jt=0; jt<2; jt++){
	       p4[0]+=pfjetenr[ix][jt];
	       p4[1]+=pfjetpT[ix][jt];
	       p4[2]+=pfjetenr[ix][jt]*tanh(pfjety[ix][jt]);
	     }
				    
	     float refy ;
	     if(abs(pfjety[ix][0])>abs(pfjety[ix][1])){ refy = abs(pfjety[ix][0]);}
	     else { refy = abs(pfjety[ix][1]); }
	     int etatag = getbinid(refy,netarange,etarng)  ; 
			
	     if(etatag>=0) {
	       float mass = sqrt(pow(p4[0],2.)-pow(p4[1],2.)-pow(p4[2],2.));
	       DiJet_Mass[ix][etatag]->Fill(mass,weight);	
	     }
	   }//phi condn
	 }//dijet cond
       }//npfjets[ix]>=2	  
	
//	if(ix==3&&irun==281693&&(ievt==1801722754||ievt==452171586||ievt==1802300326||ievt==452412196)){
	if(pfjetpT[3][0]>600 && pfjetpT[3][0]<800){
		for(int jet=0; jet<njets[3]; jet++){
        //        if(jet==0){
        //        TString msg = TString::Format("Run no %i LS %i Event No %i",irun,ilumi,ievt);
        //        gProofServ->SendAsynMessage(msg);
        //        }
         //       TString msg1 = TString::Format("AK4Jet %i pT(with jec) %f pTraw %f rapidity %f phi %f \n",jet+1,pfjetpT[3][jet],pfjetpT[3][jet]/pfjetJEC[3][jet],pfjety[3][jet],pfjetphi[3][jet]);
          //      gProofServ->SendAsynMessage(msg1);
                      }
       		 }

		
       if(isMC) {
				 
	 int ngenjet_count[netarange] = {0};
				
	 for(int jet=0; jet<ngenjets[ix]; jet++){
	   int etatag = getbinid(abs(genjety[ix][jet]),netarange,etarng);
	   if(etatag>=0){
	     ngenjet_count[etatag]++;
	     GenMCJetpT[ix][etatag]->Fill(genjetpT[ix][jet],weight);
	     GenMCJetpT_pow[ix][etatag]->Fill(genjetpT[ix][jet],genjetpT[ix][jet]*weight);
	     if (genjetpT[ix][jet]>leadingPtThreshold[0]) { GenJeteta[ix]->Fill(genjety[ix][jet],weight); }
	     
	     if(jet==0){
	       //	       iGenPTbin[ix] = getbinid(genjetpT[ix][jet],nHLTmx, leadingPtThreshold);
	       GenMCLeadJetpT[ix][etatag]->Fill(genjetpT[ix][jet],weight);
	       if (genjetpT[ix][jet]>leadingPtThreshold[0]) {GenLeadJeteta[ix]->Fill(genjety[ix][jet],weight);}
	     }
	   }
	 }//jet
				  
	 for(int eta=0; eta<netarange; eta++){
	   NGenJets[ix][eta]->Fill(ngenjet_count[eta],weight);
	 }

	 if(ngenjets[ix]>=2){
	   GenLeading2JetsDeltaR[ix]->Fill(delta2R(genjety[ix][0],genjetphi[ix][0],genjety[ix][1],genjetphi[ix][1]),weight);
	   GenLeading2JetsDeltaPhi[ix]->Fill(PhiInRange(genjetphi[ix][0]-genjetphi[ix][1]),weight);
			
	   if((ngenjets[ix]==2)||((ngenjets[ix]>2)&&(genjetpT[ix][2]<50.))){
			
	     float p4[3]={0};
			
	     if(abs(PhiInRange(genjetphi[ix][0]-genjetphi[ix][1]))>(2*pival/3.)) {
	       for(int jt=0; jt<2; jt++){
		 p4[0]+=genjetenr[ix][jt];
		 p4[1]+=genjetpT[ix][jt];
		 p4[2]+=genjetenr[ix][jt]*tanh(genjety[ix][jt]);
	       }
	       float refy ;
	       if(abs(genjety[ix][0])>abs(genjety[ix][1])){ refy = abs(genjety[ix][0]);}
	       else { refy = abs(genjety[ix][1]); }
	       int etatag = getbinid(refy,netarange,etarng)  ; 
			
	       if(etatag>=0){
		 float mass = sqrt(pow(p4[0],2.)-pow(p4[1],2.)-pow(p4[2],2.));
		 Gen_DiJet_Mass[ix][etatag]->Fill(mass,weight);		
	       }
	     }//phi condn
	   }//dijet 
	 }	  
	
			
	 //// ====== Resolution ==============

	 float deltaR_min = 0.05*(ix+1);
 
	 for(int reco = 0; reco<njets[ix]; reco++){
		
	   deltaR_min = 0.05*(ix+1);
		
	   int recoeta_tag = getbinid(abs(pfjety[ix][reco]),netarange,etarng);
	   if ((recoeta_tag<0)||(recoeta_tag>=netarange)) continue;
	    
	   int recopttag = getbinid(pfjetpT[ix][reco],noptbins,ptbins);
	   if(recopttag<0) continue ;
		
	   int match_gen = -1;
	   bool ismatched = false;
		
	   for(int gen = 0; gen<ngenjets[ix]; gen++){
			
	     int geneta_tag = -1;
	     geneta_tag = getbinid(abs(genjety[ix][gen]),netarange,etarng);
	     int genpt_tag = -1;
	     genpt_tag = getbinid(genjetpT[ix][gen],noptbins,ptbins);

	     if((recoeta_tag==geneta_tag)&&(recopttag==genpt_tag)&&geneta_tag>=0){ Pt_Ratio_nomatch[ix][geneta_tag]->Fill(genjetpT[ix][gen],pfjetpT[ix][reco]*1./genjetpT[ix][gen],weight);}
			
	     //	if(geneta_tag<0||genpt_tag<0) continue;
			
	     float delR_rg = delta2R(pfjety[ix][reco],pfjetphi[ix][reco],genjety[ix][gen],genjetphi[ix][gen]);
			
	     if((genjetpT[ix][gen]>0.5*(pfjetpT[ix][reco]))&&(genjetpT[ix][gen]<2.*(pfjetpT[ix][reco]))){
	       if((geneta_tag>=0)&&(genpt_tag>=0)){
		 DeltaR_RecoGen[ix][geneta_tag][genpt_tag]->Fill(delR_rg) ;
	       }
	     }
			
	     float pt_rat = pfjetpT[ix][reco]*1./genjetpT[ix][gen] ;
			
	     if((delR_rg < deltaR_min)&&((pt_rat>0.25)&&(pt_rat<4.))) { 
	       deltaR_min = delR_rg ; 
	       match_gen = gen;
	       ismatched = true;
	     }
	   }//gen
			
			   
	   if(match_gen>=0){
				
	     int gen = match_gen;
					
	     int geneta_tag = getbinid(abs(genjety[ix][gen]),netarange,etarng);
	     int genpt_tag =  getbinid(genjetpT[ix][gen],noptbins,ptbins);	
				
	     int recomin = -1;
	     deltaR_min = 0.05*(ix+1);
				
	     for(int reco2=0; reco2<njets[ix]; reco2++){
	       float delR_rg = delta2R(pfjety[ix][reco2],pfjetphi[ix][reco2],genjety[ix][gen],genjetphi[ix][gen]) ;
	       if(delR_rg < deltaR_min){
		 deltaR_min = delta2R(pfjety[ix][reco2],pfjetphi[ix][reco2],genjety[ix][gen],genjetphi[ix][gen]);
		 recomin = reco2;
	       }
	     }//reco2
					
	     if(recomin==reco) {
				
	       if((geneta_tag>=0)&&(genpt_tag>=0)) {
						
		 float res_pt = 0;
		 res_pt = (pfjetpT[ix][reco] - genjetpT[ix][gen])*1.0/genjetpT[ix][gen]; // (RecopT[ix] - GenpT[ix])*1.0/(GenpT[ix]) ;
		 int nbins = Resolution[ix][geneta_tag][genpt_tag]->GetNbinsX();
		 if(res_pt<(Resolution[ix][geneta_tag][genpt_tag]->GetBinLowEdge(1))) {
		   res_pt = (Resolution[ix][geneta_tag][genpt_tag]->GetBinLowEdge(1))+0.0001;
		 }else {
		   if(res_pt>(Resolution[ix][geneta_tag][genpt_tag]->GetBinLowEdge(nbins+1))) {
		     res_pt = Resolution[ix][geneta_tag][genpt_tag]->GetBinLowEdge(nbins+1) -0.0001;
		   }
		 }
				
		 Resolution[ix][geneta_tag][genpt_tag]->Fill(res_pt) ;
	       } //if((geneta_tag>=0)&&(genpt_tag>=0))
			
	       if(geneta_tag==recoeta_tag){
		 RecoVsGenJetpT[ix][geneta_tag]->Fill(pfjetpT[ix][reco],genjetpT[ix][gen],weight);
		 Pt_Ratio[ix][geneta_tag]->Fill(genjetpT[ix][gen],pfjetpT[ix][reco]*1./genjetpT[ix][gen],weight);
	       } else {
		 if(recoeta_tag>=0){
		   RecoVsGenJetpT[ix][recoeta_tag]->Fill(pfjetpT[ix][reco],-1,weight);
		 }
		 if(geneta_tag>=0){
		   RecoVsGenJetpT[ix][geneta_tag]->Fill(-1,genjetpT[ix][gen],weight);
		 }	
	       }
	     } else { //if(recomin==reco) 
	       RecoVsGenJetpT[ix][recoeta_tag]->Fill(pfjetpT[ix][reco],-1,weight);
	     }
	   }//if(match_gen>=0)
	   else{
	     if(!ismatched){
	       if(recoeta_tag>=0){
		 RecoVsGenJetpT[ix][recoeta_tag]->Fill(pfjetpT[ix][reco],-1,weight);
	       }
	     }
	   }
	 }//reco
	
	 
	 for(int gen = 0; gen<ngenjets[ix]; gen++){
		  
	   int geneta_tag = getbinid(abs(genjety[ix][gen]),netarange,etarng);
	   int genpt_tag = getbinid(genjetpT[ix][gen],noptbins,ptbins);
	   
	   //	   if(geneta_tag<0||genpt_tag<0) continue ; 
	   
	   deltaR_min = 0.05*(ix+1);
	   
	   bool ismatched =false;
	   for(int reco = 0; reco<njets[ix]; reco++) { 
	     int receta_tag = getbinid(abs(pfjety[ix][reco]),netarange,etarng);
	     int recpt_tag = getbinid(abs(pfjetpT[ix][reco]),noptbins,ptbins);
	  
	     float delR_rg = delta2R(pfjety[ix][reco],pfjetphi[ix][reco],genjety[ix][gen],genjetphi[ix][gen]);
	     float pt_rat = pfjetpT[ix][reco]*1./genjetpT[ix][gen];
			
	     if((delR_rg < deltaR_min)&&(pt_rat>0.25)&&(pt_rat<4.0)) { 
	      
	       int match_gen = -1;
	       
	       for(int gen2=0; gen2<ngenjets[ix] ; gen2++){
			   if(delta2R(pfjety[ix][reco],pfjetphi[ix][reco],genjety[ix][gen2],genjetphi[ix][gen2])<deltaR_min){
				   deltaR_min = delta2R(pfjety[ix][reco],pfjetphi[ix][reco],genjety[ix][gen2],genjetphi[ix][gen2]);
				   match_gen = gen2;
				   }
			   }
			   
			   if(gen==match_gen) {
				   ismatched =true; 
				   break;
				   }
	     }	
	   }//reco
	    
	   if (!ismatched) { 
	     if(geneta_tag>=0) {
	       RecoVsGenJetpT[ix][geneta_tag]->Fill(-1, genjetpT[ix][gen],weight) ;
	     }
	   }
	 }//gen
				 
	 //// ====== Resolution End ==========	
			
	 ////======Response Matrix for y ==============
			
	 float y_matrix[njetmx][njetmx] = {{0.}};
			
	 for(int reco = 0; reco<njets[ix]; reco++) { 
	   for(int gen=0; gen<ngenjets[ix]; gen++){
	     y_matrix[reco][gen] =  abs(pfjety[ix][reco]-genjety[ix][gen]) ;
	   }
	 }
			
	 for(int gen=0; gen<ngenjets[ix]; gen++){
	   float miny = 100;
	   int recmin_indx = -1;
	   for(int reco = 0; reco<njets[ix]; reco++){
	     if(y_matrix[reco][gen]<miny){
	       miny = y_matrix[reco][gen];
	       recmin_indx = reco;
	     }
	   }
					
	   if(recmin_indx>=0){
						
	     miny = 100;
	     int genmin_index = -1;
						
	     for(int gen2=0; gen2<ngenjets[ix]; gen2++){
	       if(y_matrix[recmin_indx][gen2]<miny){
		 miny = y_matrix[recmin_indx][gen2];
		 genmin_index = gen2;
	       }
	     }//gen2
							
	     if(genmin_index==gen) {
							
	        float pt_rat = pfjetpT[ix][recmin_indx]*1./genjetpT[ix][gen] ;
							
	       if(((pt_rat>0.5)&&(pt_rat<2.))&&(abs(PhiInRange(pfjetphi[ix][recmin_indx]-genjetphi[ix][gen]))<0.075*(ix+1))){
		 Response_y[ix]->Fill(abs(pfjety[ix][recmin_indx]),abs(genjety[ix][gen]),weight) ;
		 y_Reso[ix]->Fill(pfjety[ix][recmin_indx]-genjety[ix][gen]) ;
	       }
	     }
	     else {continue;}
	   }
	   else {continue;}
	 }//gen
					
	 //============= Response Matrix for y Ends =======================		

	 //======= Resolution in Phi Starts ====================

	 for(int reco = 0; reco<njets[ix]; reco++){
	   for(int gen=0; gen<ngenjets[ix]; gen++){
		
	     float minphi = 100;
	     float pseudo_pfphi = 100;
	     float pseudo_genphi = 100;
	     float pt_rat = pfjetpT[ix][reco]*1./genjetpT[ix][gen];
	     float del_y = abs(pfjety[ix][reco]-genjety[ix][gen]) ;
	     bool isMatched = false;
		
	     if(((pt_rat>0.5)&&(pt_rat<2.))&&(del_y<0.05*(ix+1))){
			
	       isMatched = true;
			
	       if(abs(PhiInRange(pfjetphi[ix][reco]-genjetphi[ix][gen])) < minphi){
		 pseudo_pfphi = pfjetphi[ix][reco];
		 pseudo_genphi = genjetphi[ix][gen];
		 minphi = abs(PhiInRange(pfjetphi[ix][reco]-genjetphi[ix][gen]));
	       }
	     }
			
	     if(isMatched){
	       phi_Reso[ix]->Fill(PhiInRange(pseudo_pfphi-pseudo_genphi));
	     }
	   }//gen
	 }//reco

	 //======= Resolution in Phi Ends ====================
				
	 for(int jk=0; jk<netarange; jk++){
	   RecoVsGenJetNo[ix][jk]->Fill(njet_count[jk],ngenjet_count[jk], weight) ;
	 }//jk
					
       } //isMC
     }//ix 


   return kTRUE;
}

void suman_rscan::SlaveTerminate()
{
   // The SlaveTerminate() function is called after all entries or objects
   // have been processed. When running with PROOF SlaveTerminate() is called
   // on each slave server.

fileOut->cd();
fileOut->Write();

//std::cout<<"jets "<<JetpT[3][0]->GetEntries()<<endl;
/*
TString str = TString::Format("njets %f",JetpT[3][0]->GetEntries());
if(gProofServ) gProofServ->SendAsynMessage(str);
*/
fOutput->Add(OutFile); 

fileOut->Close();

delete _outlist;

}

void suman_rscan::Terminate()
{
   // The Terminate() function is the last function to be called during
   // a query. It always runs on the client, it can be used to present
   // the results graphically or save the results to file.

}
