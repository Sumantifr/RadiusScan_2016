#include "TFile.h"
#include "TH1F.h"
#include "TH2F.h"
#include "TTree.h"
#include "TAxis.h"
#include "TF1.h"
#include "TRandom.h"
//#include "CLHEP/Vector/LorentzVector.h"
#include "TRandom.h"
#include "TRandom3.h"
#include <string>
#include  <assert.h>
#include <iostream>
#include <fstream>

//#define PU_UP   
//#define PU_DN
//#define HERWIG ;
using namespace std;  

const float pival = acos(-1.);

static const int nalgo = 12 ;
const char* JetRad[nalgo] = {"ak1","ak2","ak3","ak4","ak5","ak6","ak7","ak8","ak9","ak10","ak11","ak12"};
static const int netarange = 10;//13;//10 ;
const char* JetEta[netarange] = {"|eta|<0.5","0.5<|eta|<1.0","1.0<|eta|<1.5","1.5<|eta|<2.0","2.0<|eta|<2.5","2.5<|eta|<3.0","3.0<|eta|<3.2","3.2<|eta|<3.7","3.7<|eta|<4.2","4.2<|eta|<4.7"} ;
double etarng[netarange+1] ={0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.2, 3.7, 4.2, 4.7};
//const char* JetEta[netarange] = {"|#eta|<0.522","0.522<|#eta|<0.783","0.783<|#eta|<1.131","1.131<|#eta|<1.305","1.305<|#eta|<1.740","1.740<|#eta|<1.930","1.930<|#eta|<2.043","2.043<|#eta|<2.322","2.322<|#eta|<2.5","2.5<|#eta|<2.853","2.853<|#eta|<2.964","2.964<|#eta|<3.139","3.139<|#eta|<5.191"};
//double etarng[netarange+1] ={0.0,0.522,0.783,1.131,1.305,1.740,1.930,2.043,2.322,2.500,2.853,2.964,3.139,5.191};

const int netarange_jerc = 13;
double etarange_jerc[netarange_jerc+1] ={0.0,0.522,0.783,1.131,1.305,1.740,1.930,2.043,2.322,2.500,2.853,2.964,3.139,5.191};
double HWF_SF[netarange_jerc]  = {0.963967,0.96794,0.976129,0.960935,0.978747,0.998394,1,0.959396,0.997909,0.986105,0.912626,0.849987,0.933108};

const int noptbins = 62 ;
  
double ptbins[noptbins+1] = {/*30, 37, 43, 49, 56, 64,*/ 74, 84,
     97, 114, 133, 153, 174, 196, 220, 245, 272, 300, 330, 362, 395, 430, 468, 
     507, 548, 592, 638, 686, 737, 790, 846, 905, 967, 
     1032, 1101, 1172, 1248, 1327, 1410, 1497, 1588, 1684, 1784, 1890, 2000, 
     2116, 2238, 2366, 2500, 2640, 2787, 2941, 3103, 3273, 3450, 3637, 3832,
     4037, 4252, 4477, 4713, 4961, 5220, 5492, 5777, 6076, 6389, 6717, 7000} ;

const int noptbins1 = 68 ;

double ptbins1[noptbins1+1] = {30, 37, 43, 49, 56, 64, 74, 84,
     97, 114, 133, 153, 174, 196, 220, 245, 272, 300, 330, 362, 395, 430, 468,
     507, 548, 592, 638, 686, 737, 790, 846, 905, 967,
     1032, 1101, 1172, 1248, 1327, 1410, 1497, 1588, 1684, 1784, 1890, 2000,
     2116, 2238, 2366, 2500, 2640, 2787, 2941, 3103, 3273, 3450, 3637, 3832,
     4037, 4252, 4477, 4713, 4961, 5220, 5492, 5777, 6076, 6389, 6717, 7000} ;

const int nrun = 10;
     
 const double minPFPt = 20.;    
     
 const int npileupmx = 80;
 
 const int nHLTmx= 10; 
 double leadingPtThreshold[nHLTmx+1]= {74, 97, 133, 196, 272, 330, 395, 468, 548, 592, 5000.0};
 
 const int nopol = 6;
 //69 mb MB Xsection
 /*
 double datpileup[nHLTmx][npileupmx] = {{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09},
	{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09} 
  };	
		

double datpileup_up[nHLTmx][npileupmx] =  {{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08},
{6.36025e-06,1.77056e-05,5.94942e-05,7.44038e-05,0.000110638,0.000146484,0.000173688,0.00024148,0.00062893,0.00143363,0.0030671,0.00651243,0.0118107,0.0182067,0.0251844,0.0327853,0.0405158,0.0468624,0.0511376,0.0535875,0.0548414,0.0556153,0.0560532,0.0556643,0.0541655,0.051812,0.0489164,0.0456038,0.0419665,0.0381482,0.0342743,0.030411,0.0265975,0.0228887,0.0193629,0.0161016,0.0131673,0.0105917,0.00837709,0.00650471,0.00494575,0.00366966,0.00264744,0.00185076,0.00125002,0.000813752,0.000509657,0.000306676,0.000177125,9.81366e-05,5.21534e-05,2.65996e-05,1.30434e-05,6.17629e-06,2.85247e-06,1.31342e-06,6.29945e-07,3.37214e-07,2.14722e-07,1.63069e-07,1.39577e-07,1.26751e-07,1.17733e-07,1.09958e-07,1.02532e-07,9.5188e-08,8.78864e-08,8.06673e-08,7.35936e-08,6.673e-08,6.01356e-08,5.38601e-08,4.79433e-08,4.24145e-08,3.72928e-08,3.25885e-08,2.83028e-08,2.443e-08,2.09579e-08,1.7869e-08}
};
				
double datpileup_dn[nHLTmx][npileupmx] =  {{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09},
{6.80088e-06,2.98932e-05,6.6807e-05,9.87962e-05,0.000138123,0.000181996,0.00022561,0.000568738,0.00147113,0.00340958,0.00775202,0.0144744,0.0225051,0.0312888,0.0408131,0.0494483,0.0554728,0.0588968,0.0605555,0.0615044,0.0619525,0.0611911,0.0589888,0.0558078,0.0519931,0.0476808,0.0430603,0.0383332,0.0336127,0.0289601,0.0244597,0.0202303,0.0163876,0.0130085,0.0101188,0.00770233,0.00571971,0.00412551,0.00287613,0.00192917,0.00124014,0.000761691,0.000445977,0.000248524,0.000131674,6.63036e-05,3.17454e-05,1.44825e-05,6.33153e-06,2.69057e-06,1.14924e-06,5.28368e-07,2.88049e-07,1.96365e-07,1.59591e-07,1.41977e-07,1.30614e-07,1.21098e-07,1.12041e-07,1.03079e-07,9.4185e-08,8.54325e-08,7.69181e-08,6.87347e-08,6.09618e-08,5.36626e-08,4.68833e-08,4.06535e-08,3.49875e-08,2.98857e-08,2.53368e-08,2.13195e-08,1.78049e-08,1.47585e-08,1.21418e-08,9.91437e-09,8.035e-09,6.46319e-09,5.15997e-09,4.08873e-09}
};
*/ 					

//67.4 mb MB Xsection
	
double datpileup[nHLTmx][npileupmx] = {{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08},
{2.15411e-05,5.6992e-05,0.000127209,0.000284562,0.000628243,0.00130454,0.00248809,0.00434675,0.00699958,0.0104813,0.014724,0.0195614,0.0247524,0.0300163,0.0350706,0.0396636,0.0435963,0.0467326,0.0489994,0.0503793,0.0509,0.0506223,0.0496295,0.0480181,0.0458916,0.0433545,0.0405093,0.0374531,0.0342757,0.0310578,0.02787,0.0247719,0.0218122,0.0190285,0.0164478,0.0140877,0.011957,0.010057,0.00838287,0.0069247,0.00566889,0.00459925,0.00369801,0.00294673,0.00232704,0.0018212,0.00141253,0.00108574,0.000827064,0.000624371,0.000467131,0.000346366,0.000254531,0.000185382,0.000133825,9.57567e-05,6.79199e-05,4.77594e-05,3.3297e-05,2.30198e-05,1.57847e-05,1.07379e-05,7.2494e-06,4.85952e-06,3.23649e-06,2.14353e-06,1.41347e-06,9.29544e-07,6.11011e-07,4.02633e-07,2.66985e-07,1.78963e-07,1.21892e-07,8.47946e-08,6.05156e-08,4.4429e-08,3.35702e-08,2.6054e-08,2.06895e-08,1.67288e-08}
};

double datpileup_up[nHLTmx][npileupmx] = {{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08},
{2.00073e-05,5.19704e-05,0.000112652,0.000244625,0.000531524,0.00110075,0.00211003,0.0037189,0.00605177,0.00916386,0.0130202,0.0174936,0.0223808,0.0274316,0.0323826,0.0369883,0.0410448,0.0444024,0.0469692,0.0487074,0.0496241,0.0497613,0.0491855,0.047979,0.0462334,0.0440437,0.0415048,0.0387088,0.0357421,0.0326844,0.029607,0.0265719,0.0236313,0.0208278,0.0181939,0.0157532,0.0135205,0.0115031,0.00970167,0.00811143,0.00672313,0.00552422,0.00449982,0.00363366,0.0029088,0.00230836,0.00181596,0.00141619,0.00109482,0.00083902,0.000637395,0.000480014,0.000358354,0.00026521,0.000194581,0.000141532,0.000102065,7.29785e-05,5.17416e-05,3.63795e-05,2.53691e-05,1.75493e-05,1.20454e-05,8.20579e-06,5.55058e-06,3.73007e-06,2.49222e-06,1.65729e-06,1.09841e-06,7.26976e-07,4.81678e-07,3.20544e-07,2.15108e-07,1.46246e-07,1.01231e-07,7.16684e-08,5.20716e-08,3.88841e-08,2.98191e-08,2.3417e-08}
};

double datpileup_dn[nHLTmx][npileupmx] =  {{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},		
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08},
{2.32884e-05,6.28996e-05,0.000144893,0.000333539,0.000746249,0.00155038,0.0029379,0.00508276,0.00809383,0.0119788,0.0166307,0.0218395,0.0273238,0.0327732,0.0378893,0.0424183,0.0461711,0.0490293,0.050942,0.0519151,0.0519985,0.0512731,0.0498393,0.0478085,0.0452957,0.0424148,0.0392749,0.0359775,0.0326142,0.0292653,0.0259993,0.0228717,0.0199262,0.0171941,0.014696,0.0124425,0.0104359,0.00867112,0.0071377,0.00582084,0.00470288,0.00376439,0.00298525,0.00234543,0.00182567,0.00140792,0.0010757,0.000814272,0.000610677,0.000453759,0.000334056,0.000243673,0.000176118,0.000126134,8.95194e-05,6.29644e-05,4.38945e-05,3.03333e-05,2.07824e-05,1.41202e-05,9.51652e-06,6.36483e-06,4.22671e-06,2.78903e-06,1.83057e-06,1.1968e-06,7.80917e-07,5.09884e-07,3.34282e-07,2.21004e-07,1.481e-07,1.01151e-07,7.07828e-08,5.09512e-08,3.77961e-08,2.88716e-08,2.26397e-08,1.81389e-08,1.47709e-08,1.21637e-08}
};
	
double  mcpileup[npileupmx] = {2.82595e-05,6.29473e-05,0.000126337,0.000256885,0.000564631,0.00110702,0.00204067,0.0035458,0.00559555,0.0083368,0.011575,0.0154292,0.01967,0.0241571,0.0285471,0.0326206,0.0364776,0.0397328,0.0421873,0.044275,0.0451668,0.0458842,0.045376,0.0445124,0.043152,0.0411647,0.038777,0.0366233,0.033998,0.0314075,0.0287512,0.0262996,0.0239008,0.0215455,0.0195003,0.0176033,0.015793,0.0141663,0.0128473,0.0115051,0.0103265,0.00926773,0.00834596,0.00750304,0.00666546,0.00597047,0.00529105,0.00466223,0.00413244,0.00362811,0.00318285,0.00273657,0.00239027,0.0020306,0.0017336,0.00146106,0.00122478,0.00100438,0.000834986,0.000668676,0.000550739,0.000455454,0.000343681,0.000275465,0.000227473,0.000165593,0.000133594,0.000107893,7.98589e-05,6.69385e-05,5.60126e-05,4.08681e-05,2.92365e-05,2.53712e-05,1.69478e-05,1.57952e-05,1.38265e-05,9.98148e-06,6.90946e-06,6.66382e-06} ; //For 2016 Summer MC

double rat_pileup[nHLTmx][npileupmx] = {{0}};

Double_t pol5(Double_t* x, Double_t* par){
return (par[5]*pow(x[0],-2)+par[4]*pow(x[0],-1)+par[3]*pow(x[0],3)+par[2]*pow(x[0],2)+par[1]*pow(x[0],1)+par[0]);
}

void PileUpGenerator(double datapileup[nHLTmx][npileupmx], double *mcpileup, double rat_pileup[nHLTmx][npileupmx])
{
    double dattot[nHLTmx]={0};
    double mctot=0;
    for (int ij=0; ij<npileupmx; ij++) {
      for (int jk=0; jk<nHLTmx; jk++) {
	dattot[jk] +=datpileup[jk][ij];
      }
      mctot +=mcpileup[ij];
    }
    cout<<"datatot "<<dattot[0]<<endl;
    
    for (int ij=0; ij<npileupmx; ij++) {
      mcpileup[ij] /=max(1.e-6,mctot);
      for (int jk=0; jk<nHLTmx; jk++) {
	datpileup[jk][ij] /=max(1.e-6,dattot[jk]);

#ifdef PU_UP
	rat_pileup[jk][ij] =  datpileup_up[jk][ij]*1./mcpileup[ij];
#elif defined(PU_DN)  
	rat_pileup[jk][ij] =  datpileup_dn[jk][ij]*1./mcpileup[ij];
#else
        rat_pileup[jk][ij] =  datpileup[jk][ij]*1./mcpileup[ij];
#endif
    
	if(jk==0) { cout<<ij<<" ratio "<<rat_pileup[jk][ij]<<endl;}
    
		}
    }
}

int getbinid(double val, int nbmx, double* array) {
  if (val<array[0]) return -2;
  for (int ix=0; ix<=nbmx; ix++) {
    if (val < array[ix]) return ix-1;
  }
  return -3;
}

double theta_to_eta(double theta) { return -log(tan(theta/2.)); }

double PhiInRange(const double& phi) {
  double phiout = phi;

  if( phiout > 2*M_PI || phiout < -2*M_PI) {
    phiout = fmod( phiout, 2*M_PI);
  }
  if (phiout <= -M_PI) phiout += 2*M_PI;
  else if (phiout >  M_PI) phiout -= 2*M_PI;

  return phiout;
}

double delta2R(double eta1, double phi1, double eta2, double phi2) {
  return sqrt(pow(eta1 - eta2,2) +pow(PhiInRange(phi1 - phi2),2));
}

  unsigned ievt;
  int irun, ilumi, ifltr, nprim, ibrnch;
  
  static const int njetmx =20; 
  
  double Rho ;
    
  int nvert;
  int nchict;
  int npu_vert;

  double event_weight;
  double weight;
  double tot_weight = 0;

  bool isMC = true;
  float pthat;

  int njets[nalgo] ;
  int pfjetmul[nalgo][njetmx] ;
  float pfjetenr[nalgo][njetmx], pfjetmom[nalgo][njetmx], pfjetpT[nalgo][njetmx], pfjetarea[nalgo][njetmx], pfjetthe[nalgo][njetmx], pfjety[nalgo][njetmx], pfjetphi[nalgo][njetmx],  pfjetpTup[nalgo][njetmx], pfjetpTdn[nalgo][njetmx], pfjetJEC[nalgo][njetmx], pfjetJECL1[nalgo][njetmx], pfjetSF[nalgo][njetmx], pfjetSFup[nalgo][njetmx], pfjetSFdn[nalgo][njetmx];
  bool pfjettightID[nalgo][njetmx], pfjetlooseID[nalgo][njetmx] ;
  float pfjetSF_sjer[nalgo][njetmx], pfjetSF_rjer[nalgo][njetmx];
  int pfjet_matchgen[nalgo][njetmx];
 
  int npfjets01;
  int pfjetmul01[njetmx];
  float pfjetenr01[njetmx], pfjetpT01[njetmx], pfjetarea01[njetmx], pfjety01[njetmx], pfjetphi01[njetmx], pfjetpTup01[njetmx], pfjetpTdn01[njetmx], pfjetJEC01[njetmx], pfjetJECL101[njetmx], pfjetSF01[njetmx], pfjetSFup01[njetmx], pfjetSFdn01[njetmx];
  bool pfjettightID01[njetmx],  pfjetlooseID01[njetmx]   ;
  float pfjetSF_sjer01[njetmx], pfjetSF_rjer01[njetmx];
  int pfjet_matchgen01[njetmx];
  
  int npfjets02;
  int pfjetmul02[njetmx];
  float pfjetenr02[njetmx], pfjetpT02[njetmx], pfjetarea02[njetmx], pfjety02[njetmx], pfjetphi02[njetmx], pfjetpTup02[njetmx], pfjetpTdn02[njetmx], pfjetJEC02[njetmx], pfjetJECL102[njetmx], pfjetSF02[njetmx], pfjetSFup02[njetmx], pfjetSFdn02[njetmx];
  bool pfjettightID02[njetmx],  pfjetlooseID02[njetmx]   ;
  float pfjetSF_sjer02[njetmx], pfjetSF_rjer02[njetmx];
  int pfjet_matchgen02[njetmx];
  
  int npfjets03;
  int pfjetmul03[njetmx];
  float pfjetenr03[njetmx], pfjetpT03[njetmx], pfjetarea03[njetmx], pfjety03[njetmx], pfjetphi03[njetmx], pfjetpTup03[njetmx], pfjetpTdn03[njetmx], pfjetJEC03[njetmx], pfjetJECL103[njetmx], pfjetSF03[njetmx], pfjetSFup03[njetmx], pfjetSFdn03[njetmx];
  bool pfjettightID03[njetmx],  pfjetlooseID03[njetmx]   ;
  float pfjetSF_sjer03[njetmx], pfjetSF_rjer03[njetmx];
  int pfjet_matchgen03[njetmx];

  int npfjets04;
  int pfjetmul04[njetmx];
  float pfjetenr04[njetmx], pfjetpT04[njetmx], pfjetarea04[njetmx], pfjety04[njetmx], pfjetphi04[njetmx], pfjetpTup04[njetmx], pfjetpTdn04[njetmx], pfjetJEC04[njetmx], pfjetJECL104[njetmx], pfjetSF04[njetmx], pfjetSFup04[njetmx], pfjetSFdn04[njetmx];
  bool pfjettightID04[njetmx],  pfjetlooseID04[njetmx]   ;
  float pfjetSF_sjer04[njetmx], pfjetSF_rjer04[njetmx];
  int pfjet_matchgen04[njetmx];

  int npfjets05;
  int pfjetmul05[njetmx];
  float pfjetenr05[njetmx], pfjetpT05[njetmx], pfjetarea05[njetmx], pfjety05[njetmx], pfjetphi05[njetmx], pfjetpTup05[njetmx], pfjetpTdn05[njetmx], pfjetJEC05[njetmx], pfjetJECL105[njetmx], pfjetSF05[njetmx], pfjetSFup05[njetmx], pfjetSFdn05[njetmx];
  bool pfjettightID05[njetmx],  pfjetlooseID05[njetmx]   ;
  float pfjetSF_sjer05[njetmx], pfjetSF_rjer05[njetmx];
  int pfjet_matchgen05[njetmx];

  int npfjets06;
  int pfjetmul06[njetmx];
  float pfjetenr06[njetmx], pfjetpT06[njetmx], pfjetarea06[njetmx], pfjety06[njetmx], pfjetphi06[njetmx], pfjetpTup06[njetmx], pfjetpTdn06[njetmx], pfjetJEC06[njetmx], pfjetJECL106[njetmx], pfjetSF06[njetmx], pfjetSFup06[njetmx], pfjetSFdn06[njetmx];
  bool pfjettightID06[njetmx],  pfjetlooseID06[njetmx]   ;
  float pfjetSF_sjer06[njetmx], pfjetSF_rjer06[njetmx];
  int pfjet_matchgen06[njetmx];

  int npfjets07;
  int pfjetmul07[njetmx];
  float pfjetenr07[njetmx], pfjetpT07[njetmx], pfjetarea07[njetmx], pfjety07[njetmx], pfjetphi07[njetmx], pfjetpTup07[njetmx], pfjetpTdn07[njetmx], pfjetJEC07[njetmx], pfjetJECL107[njetmx], pfjetSF07[njetmx], pfjetSFup07[njetmx], pfjetSFdn07[njetmx];
  bool pfjettightID07[njetmx] ,  pfjetlooseID07[njetmx]  ;
  float pfjetSF_sjer07[njetmx], pfjetSF_rjer07[njetmx];
  int pfjet_matchgen07[njetmx];

  int npfjets08;
  int pfjetmul08[njetmx];
  float pfjetenr08[njetmx], pfjetpT08[njetmx], pfjetarea08[njetmx], pfjety08[njetmx], pfjetphi08[njetmx], pfjetpTup08[njetmx], pfjetpTdn08[njetmx], pfjetJEC08[njetmx], pfjetJECL108[njetmx], pfjetSF08[njetmx], pfjetSFup08[njetmx], pfjetSFdn08[njetmx];
  bool pfjettightID08[njetmx],  pfjetlooseID08[njetmx]   ;
  float pfjetSF_sjer08[njetmx], pfjetSF_rjer08[njetmx];
  int pfjet_matchgen08[njetmx];

  int npfjets09;
  int pfjetmul09[njetmx];
  float pfjetenr09[njetmx], pfjetpT09[njetmx], pfjetarea09[njetmx], pfjety09[njetmx], pfjetphi09[njetmx], pfjetpTup09[njetmx], pfjetpTdn09[njetmx], pfjetJEC09[njetmx], pfjetJECL109[njetmx], pfjetSF09[njetmx], pfjetSFup09[njetmx], pfjetSFdn09[njetmx];
  bool pfjettightID09[njetmx],  pfjetlooseID09[njetmx] ;
  float pfjetSF_sjer09[njetmx], pfjetSF_rjer09[njetmx];
  int pfjet_matchgen09[njetmx];

  int npfjets10;
  int pfjetmul10[njetmx];
  float pfjetenr10[njetmx], pfjetpT10[njetmx], pfjetarea10[njetmx], pfjety10[njetmx], pfjetphi10[njetmx], pfjetpTup10[njetmx], pfjetpTdn10[njetmx], pfjetJEC10[njetmx], pfjetJECL110[njetmx], pfjetSF10[njetmx], pfjetSFup10[njetmx], pfjetSFdn10[njetmx];
  bool pfjettightID10[njetmx],  pfjetlooseID10[njetmx]   ;
  float pfjetSF_sjer10[njetmx], pfjetSF_rjer10[njetmx];
  int pfjet_matchgen10[njetmx];

  int npfjets11;
  int pfjetmul11[njetmx];
  float pfjetenr11[njetmx], pfjetpT11[njetmx], pfjetarea11[njetmx], pfjety11[njetmx], pfjetphi11[njetmx], pfjetpTup11[njetmx], pfjetpTdn11[njetmx], pfjetJEC11[njetmx], pfjetJECL111[njetmx], pfjetSF11[njetmx], pfjetSFup11[njetmx], pfjetSFdn11[njetmx];
  bool pfjettightID11[njetmx],  pfjetlooseID11[njetmx]   ;
  float pfjetSF_sjer11[njetmx], pfjetSF_rjer11[njetmx];
  int pfjet_matchgen11[njetmx];

  int npfjets12;
  int pfjetmul12[njetmx];
  float pfjetenr12[njetmx], pfjetpT12[njetmx], pfjetarea12[njetmx], pfjety12[njetmx], pfjetphi12[njetmx], pfjetpTup12[njetmx], pfjetpTdn12[njetmx], pfjetJEC12[njetmx], pfjetJECL112[njetmx], pfjetSF12[njetmx], pfjetSFup12[njetmx], pfjetSFdn12[njetmx];
  bool pfjettightID12[njetmx],  pfjetlooseID12[njetmx]   ;
  float pfjetSF_sjer12[njetmx], pfjetSF_rjer12[njetmx];
  int pfjet_matchgen12[njetmx];
  
  int npfjets13;
  int pfjetmul13[njetmx];
  float pfjetenr13[njetmx], pfjetpT13[njetmx], pfjetarea13[njetmx], pfjety13[njetmx], pfjetphi13[njetmx], pfjetpz13[njetmx], pfjettightID13[njetmx]  ;
  
  int npfjets14;
  int pfjetmul14[njetmx];
  float pfjetenr14[njetmx], pfjetpT14[njetmx], pfjetarea14[njetmx], pfjety14[njetmx], pfjetphi14[njetmx], pfjetpz14[njetmx], pfjettightID14[njetmx]  ;
  
  int npfjets15;
  int pfjetmul15[njetmx];
  float pfjetenr15[njetmx], pfjetpT15[njetmx], pfjetarea15[njetmx], pfjety15[njetmx], pfjetphi15[njetmx], pfjetpz15[njetmx], pfjettightID15[njetmx]  ;

  
  static const int ngenjetmx =20;

  int ngenjets[nalgo] ;
  int genjetmul[nalgo];
  float genjetenr[nalgo][njetmx], genjetmom[nalgo][njetmx], genjetpT[nalgo][njetmx], genjetpz[nalgo][njetmx], genjetarea[nalgo][njetmx], genjetthe[nalgo][njetmx], genjety[nalgo][njetmx], genjetphi[nalgo][njetmx] ;

  int ngenjets01;
  int genjetmul01[njetmx];
  float genjetenr01[njetmx], genjetpT01[njetmx], genjetarea01[njetmx], genjety01[njetmx], genjetphi01[njetmx];

  int ngenjets02;
  int genjetmul02[njetmx];
  float genjetenr02[njetmx], genjetpT02[njetmx], genjetarea02[njetmx], genjety02[njetmx], genjetphi02[njetmx] ;

  int ngenjets03;
  int genjetmul03[njetmx];
  float genjetenr03[njetmx], genjetpT03[njetmx], genjetarea03[njetmx], genjety03[njetmx], genjetphi03[njetmx] ;

  int ngenjets04;
  int genjetmul04[njetmx];
  float genjetenr04[njetmx], genjetpT04[njetmx], genjetarea04[njetmx], genjety04[njetmx], genjetphi04[njetmx] ;

  int ngenjets05;
  int genjetmul05[njetmx];
  float genjetenr05[njetmx], genjetpT05[njetmx], genjetarea05[njetmx], genjety05[njetmx], genjetphi05[njetmx] ;

  int ngenjets06;
  int genjetmul06[njetmx];
  float genjetenr06[njetmx], genjetpT06[njetmx], genjetarea06[njetmx], genjety06[njetmx], genjetphi06[njetmx] ;
 
  int ngenjets07;
  int genjetmul07[njetmx];
  float genjetenr07[njetmx], genjetpT07[njetmx], genjetarea07[njetmx], genjety07[njetmx], genjetphi07[njetmx] ;

  int ngenjets08;
  int genjetmul08[njetmx];
  float genjetenr08[njetmx], genjetpT08[njetmx], genjetarea08[njetmx], genjety08[njetmx], genjetphi08[njetmx] ;

  int ngenjets09;
  int genjetmul09[njetmx];
  float genjetenr09[njetmx], genjetpT09[njetmx], genjetarea09[njetmx], genjety09[njetmx], genjetphi09[njetmx] ;

  int ngenjets10;
  int genjetmul10[njetmx];
  float genjetenr10[njetmx], genjetpT10[njetmx], genjetarea10[njetmx], genjety10[njetmx], genjetphi10[njetmx] ;

  int ngenjets11;
  int genjetmul11[njetmx];
  float genjetenr11[njetmx], genjetpT11[njetmx], genjetarea11[njetmx], genjety11[njetmx], genjetphi11[njetmx] ;
  
  int ngenjets12;
  int genjetmul12[njetmx];
  float genjetenr12[njetmx], genjetpT12[njetmx], genjetarea12[njetmx], genjety12[njetmx], genjetphi12[njetmx] ;
  
  int ngenjets13;
  int genjetmul13[njetmx];
  float genjetenr13[njetmx], genjetpT13[njetmx], genjetarea13[njetmx], genjety13[njetmx], genjetphi13[njetmx] ;
  
  int ngenjets14;
  int genjetmul14[njetmx];
  float genjetenr14[njetmx], genjetpT14[njetmx], genjetarea14[njetmx], genjety14[njetmx], genjetphi14[njetmx] ;
  
  int ngenjets15;
  int genjetmul15[njetmx];
  float genjetenr15[njetmx], genjetpT15[njetmx], genjetarea15[njetmx], genjety15[njetmx], genjetphi15[njetmx];
  
  float miset , misphi , sumEt;
  
  int iRecoPTbin[nalgo] = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};
  int iGenPTbin[nalgo] = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};

  double ex_cor[nalgo][netarange][noptbins1] = {{{1.}}};
  double cor_expo[nalgo][netarange][nopol] = {{{1.}}};
  
void fillarray() {
  
  miset = miset;
  misphi = misphi;
  sumEt = sumEt;
  
  nvert = nvert;
  nchict = nchict;
  event_weight = event_weight;
  tot_weight+=event_weight;
  pthat = pthat;
  
  for(int ix=0; ix<nalgo; ix++){
    njets[ix] = 0;
    ngenjets[ix] = 0;
    
    switch(ix){
      
    case 0:
    
    if(isMC){  
    if(pfjetpT01[0]>(3.*pthat)) break;
	}
	if(pfjettightID01[0]!=1) break;
	
    for(int jet=0; jet<npfjets01; jet++){
	
	if(pfjettightID01[jet]!=1) continue;
	if(pfjetpT01[jet]<minPFPt) continue ;
	
	pfjetenr[ix][njets[ix]] = pfjetenr01[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT01[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea01[jet] ;
	pfjety[ix][njets[ix]] = pfjety01[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi01[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID01[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID01[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT01[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT01[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC01[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL101[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF01[jet];
	pfjetSFup[ix][njets[ix]] = pfjetSFup01[jet];
	pfjetSFdn[ix][njets[ix]] = pfjetSFdn01[jet];
	pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer01[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer01[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen01[jet];
		}
	
	njets[ix]++;
      }
    
    if(isMC){
      
    for(int gjet=0; gjet<ngenjets01; gjet++){
	
	if(genjetpT01[gjet]<minPFPt) continue ;	
	
	genjetenr[ix][ngenjets[ix]] = genjetenr01[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT01[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea01[gjet];
	genjety[ix][ngenjets[ix]] = genjety01[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi01[gjet];
	
	ngenjets[ix]++;
      }
  }	
      
      break;	
      
      
    case 1:
    
    if(isMC){  
    if(pfjetpT02[0]>(3.*pthat)) break;
	}
	if(pfjettightID02[0]!=1) break;
	
    for(int jet=0; jet<npfjets02; jet++){
	
	if(pfjettightID02[jet]!=1) continue;
	if(pfjetpT02[jet]<minPFPt) continue ;
	
	pfjetenr[ix][njets[ix]] = pfjetenr02[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT02[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea02[jet] ;
	pfjety[ix][njets[ix]] = pfjety02[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi02[jet] ;
    pfjettightID[ix][njets[ix]] = pfjettightID02[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID02[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT02[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT02[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC02[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL102[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF02[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup02[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn02[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer02[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer02[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen02[jet];
	}
	njets[ix]++;
      }
    
    if(isMC){
      
    for(int gjet=0; gjet<ngenjets02; gjet++){
	
	if(genjetpT02[gjet]<minPFPt) continue ;	
	
	genjetenr[ix][ngenjets[ix]] = genjetenr02[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT02[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea02[gjet];
	genjety[ix][ngenjets[ix]] = genjety02[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi02[gjet];
	
	ngenjets[ix]++;
      }
   }
      break;	
        
    case 2:
    
    if(isMC){  
    if(pfjetpT03[0]>(3.*pthat)) break;
	}
	if(pfjettightID03[0]!=1) break;
	
    for(int jet=0; jet<npfjets03; jet++){
	
	if(pfjettightID03[jet]!=1) continue;
	if(pfjetpT03[jet]<minPFPt) continue ;
	
	pfjetenr[ix][njets[ix]] = pfjetenr03[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT03[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea03[jet] ;
	pfjety[ix][njets[ix]] = pfjety03[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi03[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID03[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID03[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT03[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT03[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC03[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL103[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF03[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup03[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn03[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer03[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer03[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen03[jet];
	}
	njets[ix]++;
      }
    
    if(isMC){
      
    for(int gjet=0; gjet<ngenjets03; gjet++){
	
	if(genjetpT03[gjet]<minPFPt) continue ;	
	
	genjetenr[ix][ngenjets[ix]] = genjetenr03[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT03[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea03[gjet];
	genjety[ix][ngenjets[ix]] = genjety03[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi03[gjet];
	
	ngenjets[ix]++;
      }
  }
      
      break;	
      
      
    case 3:
    
    if(isMC){  
    if(pfjetpT04[0]>(3.*pthat)) break;
	}
	if(pfjettightID04[0]!=1) break;
	
    for(int jet=0; jet<npfjets04; jet++){
	
	if(pfjettightID04[jet]!=1) continue;
	if(pfjetpT04[jet]<minPFPt) continue ;
	
	pfjetenr[ix][njets[ix]] = pfjetenr04[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT04[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea04[jet] ;
	pfjety[ix][njets[ix]] = pfjety04[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi04[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID04[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID04[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT04[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT04[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC04[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL104[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF04[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup04[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn04[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer04[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer04[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen04[jet];
	}			
	njets[ix]++;
      }
	
	if(isMC){
	
    for(int gjet=0; gjet<ngenjets04; gjet++){
						
	if(genjetpT04[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr04[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT04[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea04[gjet];
	genjety[ix][ngenjets[ix]] = genjety04[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi04[gjet];
				 
	ngenjets[ix]++;
      }
   }
				
      break;	
		
		    
    case 4:
    
    if(isMC){  
    if(pfjetpT05[0]>(3.*pthat)) break;
	}
	if(pfjettightID05[0]!=1) break;
	
    for(int jet=0; jet<npfjets05; jet++){
	
	if(pfjettightID05[jet]!=1) continue;
	if(pfjetpT05[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr05[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT05[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea05[jet] ;
	pfjety[ix][njets[ix]] = pfjety05[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi05[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID05[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID05[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT05[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT05[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC05[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL105[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF05[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup05[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn05[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer05[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer05[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen05[jet];
	}			
	njets[ix]++;
      }
	
	if(isMC){			
    for(int gjet=0; gjet<ngenjets05; gjet++){
						
	if(genjetpT05[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr05[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT05[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea05[gjet];
	genjety[ix][ngenjets[ix]] = genjety05[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi05[gjet];
				 
	ngenjets[ix]++;
      }
   }
      break;		
			
		
    case 5:
    
    if(isMC){  
    if(pfjetpT06[0]>(3.*pthat)) break;
	}
	if(pfjettightID06[0]!=1) break;
	
    for(int jet=0; jet<npfjets06; jet++){
	
	if(pfjettightID06[jet]!=1) continue;
	if(pfjetpT06[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr06[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT06[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea06[jet] ;
	pfjety[ix][njets[ix]] = pfjety06[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi06[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID06[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID06[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT06[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT06[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC06[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL106[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF06[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup06[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn06[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer06[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer06[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen06[jet];
	}	
	njets[ix]++;
      }
	
	if(isMC){
		
    for(int gjet=0; gjet<ngenjets06; gjet++){
						
	if(genjetpT06[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr06[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT06[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea06[gjet];
	genjety[ix][ngenjets[ix]] = genjety06[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi06[gjet];
			 
	ngenjets[ix]++;
      }
   }
					
      break;	
			
			
    case 6:
    
    if(isMC){  
    if(pfjetpT07[0]>(3.*pthat)) break;
	}
	if(pfjettightID07[0]!=1) break;
	
    for(int jet=0; jet<npfjets07; jet++){
				
	if(pfjettightID07[jet]!=1) continue;
	if(pfjetpT07[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr07[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT07[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea07[jet] ;
	pfjety[ix][njets[ix]] = pfjety07[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi07[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID07[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID07[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT07[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT07[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC07[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL107[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF07[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup07[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn07[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer07[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer07[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen07[jet];
	}			
	njets[ix]++;
      }
	
	if(isMC){		
    for(int gjet=0; gjet<ngenjets07; gjet++){
						
	if(genjetpT07[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr07[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT07[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea07[gjet];
	genjety[ix][ngenjets[ix]] = genjety07[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi07[gjet];
				 
	ngenjets[ix]++;
      }
	}			
      break;	
			
			
    case 7:
    
    if(isMC){  
    if(pfjetpT08[0]>(3.*pthat)) break;
	}
	if(pfjettightID08[0]!=1) break;
	
    for(int jet=0; jet<npfjets08; jet++){
				
	if(pfjettightID08[jet]!=1) continue;
	if(pfjetpT08[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr08[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT08[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea08[jet] ;
	pfjety[ix][njets[ix]] = pfjety08[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi08[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID08[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID08[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT08[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT08[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC08[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL108[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF08[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup08[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn08[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer08[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer08[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen08[jet];
	}			
	njets[ix]++;
      }
	
	if(isMC){
    for(int gjet=0; gjet<ngenjets08; gjet++){
						
	if(genjetpT08[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr08[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT08[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea08[gjet];
	genjety[ix][ngenjets[ix]] = genjety08[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi08[gjet];
				 
	ngenjets[ix]++;
      }
	}	 
      break;	
			
			
    case 8:
    
    if(isMC){  
    if(pfjetpT09[0]>(3.*pthat)) break;
	}
	if(pfjettightID09[0]!=1) break;
    
    for(int jet=0; jet<npfjets09; jet++){
	
	if(pfjettightID09[jet]!=1) continue;
	if(pfjetpT09[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr09[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT09[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea09[jet] ;
	pfjety[ix][njets[ix]] = pfjety09[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi09[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID09[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID09[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT09[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT09[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC09[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL109[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF09[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup09[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn09[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer09[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer09[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen09[jet];
	}			
	njets[ix]++;
      }
	
	if(isMC){	
    for(int gjet=0; gjet<ngenjets09; gjet++){
						
	if(genjetpT09[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr09[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT09[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea09[gjet];
	genjety[ix][ngenjets[ix]] = genjety09[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi09[gjet];
				 
	ngenjets[ix]++;
      }
  }
      break;	
			
			
    case 9:
    
    if(isMC){  
    if(pfjetpT10[0]>(3.*pthat)) break;
	}
	if(pfjettightID10[0]!=1) break;
	
    for(int jet=0; jet<npfjets10; jet++){
	
	if(pfjettightID10[jet]!=1) continue;
	if(pfjetpT10[jet]<minPFPt) continue ;
		
	pfjetenr[ix][njets[ix]] = pfjetenr10[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT10[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea10[jet] ;
	pfjety[ix][njets[ix]] = pfjety10[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi10[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID10[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID10[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT10[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT10[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC10[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL110[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF10[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup10[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn10[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer10[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer10[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen10[jet];
	}			
	njets[ix]++;
      }
    
    if(isMC){  
    for(int gjet=0; gjet<ngenjets10; gjet++){
						
	if(genjetpT10[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr10[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT10[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea10[gjet];
	genjety[ix][ngenjets[ix]] = genjety10[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi10[gjet];
				 
	ngenjets[ix]++;
      }
   }
      break;	
			
			
    case 10:
     
    if(isMC){  
    if(pfjetpT11[0]>(3.*pthat)) break;
	}
	if(pfjettightID11[0]!=1) break;
		 
    for(int jet=0; jet<npfjets11; jet++){
				
	if(pfjettightID11[jet]!=1) continue;
	if(pfjetpT11[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr11[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT11[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea11[jet] ;
	pfjety[ix][njets[ix]] = pfjety11[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi11[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID11[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID11[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT11[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT11[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC11[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL111[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF11[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup11[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn11[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer11[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer11[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen11[jet];
	}			
	njets[ix]++;
      }
	
	if(isMC){
    for(int gjet=0; gjet<ngenjets11; gjet++){	
					
	if(genjetpT11[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr11[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT11[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea11[gjet];
	genjety[ix][ngenjets[ix]] = genjety11[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi11[gjet];
			 
	ngenjets[ix]++;
      }
   }
      break;	
			
			
    case 11:
    
    if(isMC){  
    if(pfjetpT12[0]>(3.*pthat)) break;
	}
	if(pfjettightID12[0]!=1) break;
	
    for(int jet=0; jet<npfjets12; jet++){
				
	if(pfjettightID12[jet]!=1) continue;
	if(pfjetpT12[jet]<minPFPt) continue ;
				
	pfjetenr[ix][njets[ix]] = pfjetenr12[jet] ;
	pfjetpT[ix][njets[ix]] =  pfjetpT12[jet];
	pfjetarea[ix][njets[ix]] = pfjetarea12[jet] ;
	pfjety[ix][njets[ix]] = pfjety12[jet];
	pfjetphi[ix][njets[ix]] = pfjetphi12[jet] ;
	pfjettightID[ix][njets[ix]] = pfjettightID12[jet];
	pfjetlooseID[ix][njets[ix]] = pfjetlooseID12[jet];
	pfjetpTup[ix][njets[ix]] = pfjetpT12[jet] ;
	pfjetpTdn[ix][njets[ix]] = pfjetpT12[jet] ;
	pfjetJEC[ix][njets[ix]] = pfjetJEC12[jet];
	pfjetJECL1[ix][njets[ix]] = pfjetJECL112[jet];
	if(isMC){
	pfjetSF[ix][njets[ix]] = pfjetSF12[jet];
    pfjetSFup[ix][njets[ix]] = pfjetSFup12[jet];
    pfjetSFdn[ix][njets[ix]] = pfjetSFdn12[jet];
    pfjetSF_sjer[ix][njets[ix]] = pfjetSF_sjer12[jet];
	pfjetSF_rjer[ix][njets[ix]] = pfjetSF_rjer12[jet];
	pfjet_matchgen[ix][njets[ix]] = pfjet_matchgen12[jet];
	}	
	njets[ix]++;
      }
	
	if(isMC){
					
    for(int gjet=0; gjet<ngenjets12; gjet++){
					
	if(genjetpT12[gjet]<minPFPt) continue ;	
					
	genjetenr[ix][ngenjets[ix]] = genjetenr12[gjet];
	genjetpT[ix][ngenjets[ix]] = genjetpT12[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea12[gjet];
	genjety[ix][ngenjets[ix]] = genjety12[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi12[gjet];
				 
	ngenjets[ix]++;
      }
   }
      break;	
			
    }//switch(ix)
  }//ix  
}//fillarray
				

int main()
{
  // bool isMC;	
  int nevent_total = 0;
   	
  char rootfiles[100];
  
  char outfile[100];
  char outfilx[100];
  char infile[200];
  char datafile[100];
  
  cout <<"Give the input file name"<<endl;
  cin>> rootfiles;

  int len = strlen(rootfiles);
  strncpy(outfilx, rootfiles, len-4);
  outfilx[len-4]='\0';

  sprintf (outfile,"%s.root",outfilx);
  TFile* fileOut = new TFile(outfile, "recreate"); 

  char text_file[100];
  sprintf(text_file,"%s.txt",outfilx);

  ofstream fp ;
  fp.open(text_file) ;
		
  TH1F* hist_pfmet;
  TH1F* hist_SumEt;
  TH1F* hist_METbyET;

  TH1F* hist_PV_all;
  TH1F* hist_PV_sel;
  TH1F* hist_PU;

  TH2F* PU_vs_PV_all;
  TH2F* PU_vs_PV_sel;
  TH2F* PU_vs_PV_sel_rewt;

  TH1F* NJets[nalgo][netarange];
  TH1F* JetpT[nalgo][netarange];
  TH1F* JetpT_up[nalgo][netarange];
  TH1F* JetpT_dn[nalgo][netarange];
  TH1F* LeadJetpT[nalgo][netarange];
  TH1F* DiJet_Mass[nalgo][netarange];
  TH1F* Jeteta[nalgo];
  TH1F* LeadJeteta[nalgo];
  TH1F* Leading2JetsDeltaR[nalgo];
  TH1F* Leading2JetsDeltaPhi[nalgo] ;
  TH1F* Prescale_JetpT[nalgo][netarange][nHLTmx] ;
  TH1F* Prescale_JetpT_all[nalgo][netarange][nHLTmx] ;  

  TF1* fit_cor[nalgo][netarange];
  TH1F* LeadJetRatio[nalgo][netarange];									    

  TH1F* NGenJets[nalgo][netarange];
  TH1F* GenJetpT[nalgo][netarange];
  TH1F* GenLeadJetpT[nalgo][netarange];
  TH1F* GenMCJetpT[nalgo][netarange];
  TH1F* GenMCJetpT_pow[nalgo][netarange];
  TH1F* GenMCLeadJetpT[nalgo][netarange];
  TH1F* Gen_DiJet_Mass[nalgo][netarange];
  TH1F* GenJeteta[nalgo];
  TH1F* GenLeadJeteta[nalgo];
  TH1F* GenLeading2JetsDeltaR[nalgo];
  TH1F* GenLeading2JetsDeltaPhi[nalgo] ;
  TH1F* DeltaR_RecoGen[nalgo][netarange][noptbins] ;
  TH1F* DeltaR_RecoGen_mat[nalgo][netarange][noptbins] ;
  TH1F* Resolution[nalgo][netarange][noptbins];
  TH2F* Pt_Ratio[nalgo][netarange];
  TH2F* Pt_Ratio_nomatch[nalgo][netarange];
  TH2F* JetPt_vs_JEC[nalgo][netarange];
  TH2F* JetPt_vs_JECL1[nalgo][netarange];
  TH1F* hist_pfjetSF[nalgo][netarange];
  TH1F* hist_pfjetSFup[nalgo][netarange];
  TH1F* hist_pfjetSFdn[nalgo][netarange];

  const int npu_bin = 3;

  TH2F* RecoVsGenJetpT[nalgo][netarange] ;
  TH2F* RecoVsGenJetNo[nalgo][netarange] ;
  TH2F* JEC_fac[nalgo][netarange] ;
  TH2F* Response_y[nalgo];
  TH2F* Pthat_vs_LeadPt[nalgo];

  TH1F* y_Reso[nalgo];
  TH1F* phi_Reso[nalgo];

  TH1F* PileupVertices[nHLTmx] ;
  
  TH1F *JetpT_stat[nalgo][netarange][nrun];
  TH1F *GenMCJetpT_stat[nalgo][netarange][nrun];
  TH2F *RecoVsGenJetpT_stat[nalgo][netarange][nrun];
  TH1F* NJets_stat[nalgo][netarange][nrun];

  char name[100];
  char title[100];

  hist_pfmet = new TH1F("MET_Value","MET Value",1000,0.0,2000.0) ; 
  hist_SumEt = new TH1F("Sum_Et","Sum_Et",3500,0,3500.);
  hist_METbyET = new TH1F("METbyEt","MET Value by pT Sum",100,0.0,1.0) ; 
  hist_PV_all = new TH1F("nprimall_rewt_trigset","All PV",60, -0.5, 59.5);
  hist_PV_sel = new TH1F("nprimsel_rewt_trigset","Selected PV",60, -0.5, 59.5);
  hist_PU     = new TH1F("pu_vertices","# of PU Vertices",80,-0.5,79.5);

  PU_vs_PV_all = new TH2F("pileup_vs_nprimall","PU vs PV all",80,-0.5,79.5,80,-0.5,79.5);
  PU_vs_PV_sel = new TH2F("pileup_vs_nprimsel","PU vs PV sel",80,-0.5,79.5,80,-0.5,79.5);
  PU_vs_PV_sel_rewt = new TH2F("pileup_vs_nprimsel_reweighted","PU vs PV sel Weighted",80,-0.5,79.5,80,-0.5,79.5);



  for(int ij=0;ij<nalgo;ij++){
    for (int jk=0;jk<netarange;jk++){	
	
      sprintf(name,"NJets_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"NJets for %s %s",JetRad[ij],JetEta[jk]);

      NJets[ij][jk] = new TH1F(name,title,20,0,20);
      NJets[ij][jk]->Sumw2();

      sprintf(name,"JetpT_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"JetpT for %s %s",JetRad[ij],JetEta[jk]);
      
      JetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      JetpT[ij][jk]->Sumw2();
      
      for(int kl=0; kl<nrun; kl++){ 
		  sprintf(name,"JetpT_%s_EtaBin%i_Comb%i",JetRad[ij],jk+1,kl+1);
		  sprintf(title,"JetpT for %s %s Comb%i",JetRad[ij],JetEta[jk],kl+1);
		  
		  JetpT_stat[ij][jk][kl] = new TH1F(name,title,noptbins,ptbins);
		  JetpT_stat[ij][jk][kl]->Sumw2();
		  
		  sprintf(name,"NJets_%s_EtaBin%i_Comb%i",JetRad[ij],jk+1,kl+1);
		  sprintf(title,"NJets for %s %s Comb%i",JetRad[ij],JetEta[jk],kl+1);

		  NJets_stat[ij][jk][kl] = new TH1F(name,title,20,0,20);
		  NJets_stat[ij][jk][kl]->Sumw2();
		}
      
      sprintf(name,"JetpT_%s_EtaBin%i_JER_up",JetRad[ij],jk+1);
      sprintf(title,"JetpT for %s %s JER Up",JetRad[ij],JetEta[jk]);
      
      JetpT_up[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      JetpT_up[ij][jk]->Sumw2();
      
      sprintf(name,"JetpT_%s_EtaBin%i_JER_dn",JetRad[ij],jk+1);
      sprintf(title,"JetpT for %s %s JER Down",JetRad[ij],JetEta[jk]);
      
      JetpT_dn[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      JetpT_dn[ij][jk]->Sumw2();
      
      sprintf(name,"Leading_JetpT_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Leading JetpT for %s %s" ,JetRad[ij],JetEta[jk]);
      
      LeadJetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      LeadJetpT[ij][jk]->Sumw2();
      
      sprintf(name,"DiJet_Mass_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"DiJet Mass for %s %s",JetRad[ij],JetEta[jk]);
    
      DiJet_Mass[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      DiJet_Mass[ij][jk]->Sumw2();

      sprintf(name,"NGenJets_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"NJets %s EtaBin %i",JetRad[ij],jk+1) ;

      NGenJets[ij][jk] = new TH1F(name,title,20,0,20);
      NGenJets[ij][jk]->Sumw2();
      
      sprintf(name,"Gen_MC_JetpT_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Gen MC Jet pT %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCJetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCJetpT[ij][jk]->Sumw2();
      
      for(int kl=0; kl<nrun; kl++){ 
		  sprintf(name,"Gen_MC_JetpT_%s_EtaBin%i_Comb%i",JetRad[ij],jk+1,kl+1);
		  sprintf(title,"Gen MC JetpT for %s %s",JetRad[ij],JetEta[jk]);
		  
		  GenMCJetpT_stat[ij][jk][kl] = new TH1F(name,title,noptbins,ptbins);
		  GenMCJetpT_stat[ij][jk][kl]->Sumw2();
		}
			
      sprintf(name,"Gen_MC_JetpT_Pow_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Gen MC Jet pT Pow %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCJetpT_pow[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCJetpT_pow[ij][jk]->Sumw2();
      
      sprintf(name,"Leading_Gen_MC_JetpT_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Leading Gen MC Jet pT %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCLeadJetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCLeadJetpT[ij][jk]->Sumw2();
			
      sprintf(name,"Gen_DiJet_Mass_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Gen_DiJet Mass for %s %s",JetRad[ij],JetEta[jk]);
    
      Gen_DiJet_Mass[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      Gen_DiJet_Mass[ij][jk]->Sumw2();
			
      sprintf(name,"LeadJetRaio_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Leading Jet Pt Ratio for %s EtaBin%i",JetRad[ij],jk+1);

      LeadJetRatio[ij][jk] = new TH1F(name,title,500,-0.01,5.);
      LeadJetRatio[ij][jk]->Sumw2();
	 
      sprintf(name,"RecoJetvsGenJet_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"RecoJetvsGenJet %s EtaBin%i",JetRad[ij],jk+1);
      RecoVsGenJetpT[ij][jk] = new TH2F(name,title,noptbins,ptbins,noptbins,ptbins);
      RecoVsGenJetpT[ij][jk]->Sumw2();
	
      RecoVsGenJetpT[ij][jk]->GetXaxis()->SetTitle("RECO Jet pT (in GeV)");
      RecoVsGenJetpT[ij][jk]->GetYaxis()->SetTitle("Gen Jet pT (in GeV)") ;
      
      for(int kl=0; kl<nrun; kl++){
		  sprintf(name,"RecoJetvsGenJet_%s_EtaBin%i_Comb%i",JetRad[ij],jk+1,kl+1);
		  sprintf(title,"RecoJetvsGenJet %s EtaBin%i",JetRad[ij],jk+1);
		  RecoVsGenJetpT_stat[ij][jk][kl] = new TH2F(name,title,noptbins,ptbins,noptbins,ptbins);
		  RecoVsGenJetpT_stat[ij][jk][kl]->Sumw2();  
		}
	
      sprintf(name,"RecoJetvsGenJet_Number_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"RecoJetvsGenJet Number %s EtaBin%i",JetRad[ij],jk+1);
      RecoVsGenJetNo[ij][jk] = new TH2F(name,title,njetmx,-0.5,19.5,njetmx,-0.5,19.5);
      RecoVsGenJetNo[ij][jk]->Sumw2();
	
      sprintf(name,"Pt_Ratio_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt Ratio %s EtaBin%i",JetRad[ij],jk+1);
      Pt_Ratio[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      Pt_Ratio[ij][jk]->Sumw2();
	
      sprintf(name,"Pt_Ratio_nomatch_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt Ratio nomatch %s EtaBin%i",JetRad[ij],jk+1);
      Pt_Ratio_nomatch[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      Pt_Ratio_nomatch[ij][jk]->Sumw2();
      
      sprintf(name,"JetPt_vs_JEC_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt vs JEC %s EtaBin%i",JetRad[ij],jk+1);  
      JetPt_vs_JEC[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      JetPt_vs_JEC[ij][jk]->Sumw2();
      
      sprintf(name,"JetPt_vs_JECL1_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Pt vs JEC L1 %s EtaBin%i",JetRad[ij],jk+1);  
      JetPt_vs_JECL1[ij][jk] = new TH2F(name,title,noptbins,ptbins,500,0,5.);
      JetPt_vs_JECL1[ij][jk]->Sumw2();
	
      for(int kl=0; kl<noptbins; kl++){
			
	sprintf(name,"Resolution_%s_EtaBin%i_PtBin%i",JetRad[ij],jk+1,kl+1);
	sprintf(title,"Resolution %s EtaBin%i PtBin%i",JetRad[ij],jk+1,kl+1);
	Resolution[ij][jk][kl] = new TH1F(name,title,200,-2.0,2.0);
	Resolution[ij][jk][kl]->Sumw2();
	
	sprintf(name,"DeltaR_%s_EtaBin%i_PtBin%i",JetRad[ij],jk+1,kl+1);
	sprintf(title,"DeltaR %s EtaBin%i PtBin%i",JetRad[ij],jk+1,kl+1);
	DeltaR_RecoGen[ij][jk][kl] = new TH1F(name,title,360,0,3.6);
	DeltaR_RecoGen[ij][jk][kl]->Sumw2();
	
	sprintf(name,"DeltaR_Matrix_%s_EtaBin%i_PtBin%i",JetRad[ij],jk+1,kl+1);
	sprintf(title,"DeltaR Matrix %s EtaBin%i PtBin%i",JetRad[ij],jk+1,kl+1);
	DeltaR_RecoGen_mat[ij][jk][kl] = new TH1F(name,title,360,0,3.6);
	DeltaR_RecoGen_mat[ij][jk][kl]->Sumw2();
      }//kl

    sprintf(name,"JER_SF_%s_EtaBin%i",JetRad[ij],jk+1);
    hist_pfjetSF[ij][jk] = new TH1F(name,name,40,0,2.);
    hist_pfjetSF[ij][jk]->Sumw2();

    sprintf(name,"JER_SFup_%s_EtaBin%i",JetRad[ij],jk+1);
    hist_pfjetSFup[ij][jk] = new TH1F(name,name,40,0,2.);
    hist_pfjetSFup[ij][jk]->Sumw2();

    sprintf(name,"JER_SFdn_%s_EtaBin%i",JetRad[ij],jk+1);
    hist_pfjetSFdn[ij][jk] = new TH1F(name,name,40,0,2.);
    hist_pfjetSFdn[ij][jk]->Sumw2();

    sprintf(name,"Fit_Cor_%s_EtaBin%i",JetRad[ij],jk+1);
    fit_cor[ij][jk] = new TF1(name,pol5,ptbins[0]-20.,ptbins[noptbins-1],nopol);

    }//jk
	
	
    sprintf(name,"Jety_%s",JetRad[ij]);
    sprintf(title,"Jet Rapidity for %s",JetRad[ij]);
    
    Jeteta[ij] = new TH1F(name,title,200,-5.0,5.0);
    Jeteta[ij]->Sumw2();
    
    sprintf(name,"Leading_Jety_%s",JetRad[ij]);
    sprintf(title,"Leading Jet Rapidity for %s",JetRad[ij]);
    
    LeadJeteta[ij] = new TH1F(name,title,100,-5.0,5.0);
    LeadJeteta[ij]->Sumw2();
    
    sprintf(name,"Leading2Jets_deltaR_%s",JetRad[ij]);
    sprintf(title,"Leading 2 Jets deltaR for %s",JetRad[ij]);
    
    Leading2JetsDeltaR[ij] = new TH1F(name,title,100,0,8.0);
    Leading2JetsDeltaR[ij]->Sumw2();
    
    sprintf(name,"Leading2Jets_deltaPhi_%s",JetRad[ij]);
    sprintf(title,"Leading 2 Jets deltaPhi for %s",JetRad[ij]);
    
    Leading2JetsDeltaPhi[ij] = new TH1F(name,title,75,0,2*M_PI);
    Leading2JetsDeltaPhi[ij]->Sumw2();
	
    if(isMC){
      
      sprintf(name,"GenJety_%s",JetRad[ij]);
      sprintf(title,"GenJet Rapidity for %s",JetRad[ij]);
      
      GenJeteta[ij] = new TH1F(name,title,200,-5.0,5.0);
      GenJeteta[ij]->Sumw2();
      
      sprintf(name,"Leading_GenJety_%s",JetRad[ij]);
      sprintf(title,"Leading GenJet Rapidity for %s",JetRad[ij]);
      
      GenLeadJeteta[ij] = new TH1F(name,title,100,-5.0,5.0);
      GenLeadJeteta[ij]->Sumw2();
      
      sprintf(name,"Leading2GenJets_deltaR_%s",JetRad[ij]);
      sprintf(title,"Leading 2 GenJets deltaR for %s",JetRad[ij]);
      
      GenLeading2JetsDeltaR[ij] = new TH1F(name,title,100,0,8.0);
      GenLeading2JetsDeltaR[ij]->Sumw2();
      
      sprintf(name,"Leading2GenJets_deltaPhi_%s",JetRad[ij]);
      sprintf(title,"Leading 2 GenJets deltaPhi for %s",JetRad[ij]);
      
      GenLeading2JetsDeltaPhi[ij] = new TH1F(name,title,75,0,2*M_PI);
      GenLeading2JetsDeltaPhi[ij]->Sumw2();
      
      sprintf(name,"Response_y_%s", JetRad[ij]);
      sprintf(title,"Response Matrix in y for %s Jets",JetRad[ij]);
	  
      Response_y[ij] = new TH2F(name,title,netarange,etarng,netarange,etarng);
      Response_y[ij]->Sumw2();
	  
      sprintf(name,"Resolution_y_%s", JetRad[ij]);
      sprintf(title,"Resolution in y for %s Jets",JetRad[ij]);
	  
      y_Reso[ij] = new TH1F(name,title,100,-10.,10.);
      y_Reso[ij]->Sumw2();
	  
      sprintf(name,"Resolution_phi_%s", JetRad[ij]);
      sprintf(title,"Resolution in phi for %s Jets",JetRad[ij]);
	  
      phi_Reso[ij] = new TH1F(name,title,100,-M_PI,M_PI);
      phi_Reso[ij]->Sumw2();
      
      sprintf(name,"Pthat_vs_LeadingJet_Pt_%s",JetRad[ij]);
      sprintf(title,"Pthat vs LeadingJet Pt %s",JetRad[ij]);
      
      Pthat_vs_LeadPt[ij] = new TH2F(name,title,noptbins,ptbins,noptbins,ptbins);
      Pthat_vs_LeadPt[ij]->Sumw2();
    }
  }//ij

PileUpGenerator(datpileup,mcpileup,rat_pileup);

ifstream file_db;
file_db.open(rootfiles); 

 while(!(file_db.eof())){
   file_db >> datafile;
   cout <<"datafile name is "<<datafile/*<<" with weight "<<weight<<" "<<weight2*/<<endl;
   if (strstr(datafile,"#")) continue;
    
   if(file_db.eof()) break;
    
   sprintf(infile, "%s", datafile);

//   TFile* fileIn = new TFile(infile, "read");
   TFile* fileIn = TFile::Open(infile);
   if ( fileIn->IsZombie() ) continue;
   if ( fileIn->Recover() == 0 ) continue; 

   TTree* Tin;
   Tin = (TTree*)fileIn->Get("T1");
   
   nevent_total+=Tin->GetEntries(); 
   
   Tin->SetBranchAddress("irun", &irun) ;
   Tin->SetBranchAddress("ilumi", &ilumi) ;
   Tin->SetBranchAddress("ievt", &ievt) ;
    
   Tin->SetBranchAddress("Rho", &Rho) ;
  
   Tin->SetBranchAddress("event_weight", &event_weight) ;

   Tin->SetBranchAddress("PFMET",&miset) ;
   Tin->SetBranchAddress("PFMETPhi",&misphi) ;
   Tin->SetBranchAddress("sumEt",&sumEt) ;

   Tin->SetBranchAddress("nvert",&nvert);
   Tin->SetBranchAddress("nchict",&nchict);

   if(isMC){
     Tin->SetBranchAddress("npu_vert",&npu_vert);
     Tin->SetBranchAddress("pthat",&pthat);
   }

   Tin->SetBranchAddress("event_weight", &event_weight);

   Tin->SetBranchAddress("npfjets01",&npfjets01); 
   Tin->SetBranchAddress("pfjetpT01",pfjetpT01);
   Tin->SetBranchAddress("pfjetarea01",pfjetarea01);
   Tin->SetBranchAddress("pfjety01",pfjety01); 
   Tin->SetBranchAddress("pfjetphi01",pfjetphi01) ;
   Tin->SetBranchAddress("pfjetenr01",pfjetenr01) ;
   Tin->SetBranchAddress("pfjettightID01",pfjettightID01);
   Tin->SetBranchAddress("pfjetlooseID01",pfjetlooseID01);
/*
   Tin->SetBranchAddress("pfjetpTup01",pfjetpTup01);
   Tin->SetBranchAddress("pfjetpTdn01",pfjetpTdn01);
*/
   Tin->SetBranchAddress("pfjetJEC01",pfjetJEC01);
   Tin->SetBranchAddress("pfjetJECL101",pfjetJECL101);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF01",pfjetSF01);
   Tin->SetBranchAddress("pfjetSFup01",pfjetSFup01);
   Tin->SetBranchAddress("pfjetSFdn01",pfjetSFdn01);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer01",pfjetSF_sjer01);
   Tin->SetBranchAddress("pfjetSF_rjer01",pfjetSF_rjer01);
   Tin->SetBranchAddress("pfjet_matchgen01",pfjet_matchgen01);
   #endif
   }

   Tin->SetBranchAddress("npfjets02", &npfjets02); 
   Tin->SetBranchAddress("pfjetpT02",pfjetpT02);
   Tin->SetBranchAddress("pfjetarea02",pfjetarea02);
   Tin->SetBranchAddress("pfjety02",pfjety02); 
   Tin->SetBranchAddress("pfjetphi02",pfjetphi02) ;
   Tin->SetBranchAddress("pfjetenr02",pfjetenr02) ;
   Tin->SetBranchAddress("pfjettightID02",pfjettightID02);
   Tin->SetBranchAddress("pfjetlooseID02",pfjetlooseID02);
/*
   Tin->SetBranchAddress("pfjetpTup02",pfjetpTup02);
   Tin->SetBranchAddress("pfjetpTdn02",pfjetpTdn02);
*/
   Tin->SetBranchAddress("pfjetJEC02",pfjetJEC02);
   Tin->SetBranchAddress("pfjetJECL102",pfjetJECL102);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF02",pfjetSF02);
   Tin->SetBranchAddress("pfjetSFup02",pfjetSFup02);
   Tin->SetBranchAddress("pfjetSFdn02",pfjetSFdn02);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer02",pfjetSF_sjer02);
   Tin->SetBranchAddress("pfjetSF_rjer02",pfjetSF_rjer02);
   Tin->SetBranchAddress("pfjet_matchgen02",pfjet_matchgen02);
   #endif
   }

   Tin->SetBranchAddress("npfjets03", &npfjets03);
   Tin->SetBranchAddress("pfjetpT03",pfjetpT03);
   Tin->SetBranchAddress("pfjetarea03",pfjetarea03);
   Tin->SetBranchAddress("pfjety03",pfjety03);
   Tin->SetBranchAddress("pfjetphi03",pfjetphi03) ;
   Tin->SetBranchAddress("pfjetenr03",pfjetenr03) ;
   Tin->SetBranchAddress("pfjettightID03",pfjettightID03);
   Tin->SetBranchAddress("pfjetlooseID03",pfjetlooseID03);
/*
   Tin->SetBranchAddress("pfjetpTup03",pfjetpTup03);
   Tin->SetBranchAddress("pfjetpTdn03",pfjetpTdn03);
*/
   Tin->SetBranchAddress("pfjetJEC03",pfjetJEC03);
   Tin->SetBranchAddress("pfjetJECL103",pfjetJECL103);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF03",pfjetSF03);
   Tin->SetBranchAddress("pfjetSFup03",pfjetSFup03);
   Tin->SetBranchAddress("pfjetSFdn03",pfjetSFdn03); 
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer03",pfjetSF_sjer03);
   Tin->SetBranchAddress("pfjetSF_rjer03",pfjetSF_rjer03);
   Tin->SetBranchAddress("pfjet_matchgen03",pfjet_matchgen03);
   #endif
   }

   Tin->SetBranchAddress("npfjets04", &npfjets04);
   Tin->SetBranchAddress("pfjetpT04",pfjetpT04);
   Tin->SetBranchAddress("pfjetarea04",pfjetarea04);
   Tin->SetBranchAddress("pfjety04",pfjety04);
   Tin->SetBranchAddress("pfjetphi04",pfjetphi04) ;
   Tin->SetBranchAddress("pfjetenr04",pfjetenr04) ;
   Tin->SetBranchAddress("pfjettightID04",pfjettightID04);
   Tin->SetBranchAddress("pfjetlooseID04",pfjetlooseID04);
/*
   Tin->SetBranchAddress("pfjetpTup04",pfjetpTup04);
   Tin->SetBranchAddress("pfjetpTdn04",pfjetpTdn04);
*/
   Tin->SetBranchAddress("pfjetJEC04",pfjetJEC04);
   Tin->SetBranchAddress("pfjetJECL104",pfjetJECL104);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF04",pfjetSF04);
   Tin->SetBranchAddress("pfjetSFup04",pfjetSFup04);
   Tin->SetBranchAddress("pfjetSFdn04",pfjetSFdn04);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer04",pfjetSF_sjer04);
   Tin->SetBranchAddress("pfjetSF_rjer04",pfjetSF_rjer04);
   Tin->SetBranchAddress("pfjet_matchgen04",pfjet_matchgen04);
   #endif
   }

   Tin->SetBranchAddress("npfjets05", &npfjets05);
   Tin->SetBranchAddress("pfjetpT05",pfjetpT05);
   Tin->SetBranchAddress("pfjetarea05",pfjetarea05);
   Tin->SetBranchAddress("pfjety05",pfjety05);
   Tin->SetBranchAddress("pfjetphi05",pfjetphi05) ;
   Tin->SetBranchAddress("pfjetenr05",pfjetenr05) ;
   Tin->SetBranchAddress("pfjettightID05",pfjettightID05);
   Tin->SetBranchAddress("pfjetlooseID05",pfjetlooseID05);
/*
   Tin->SetBranchAddress("pfjetpTup05",pfjetpTup05);
   Tin->SetBranchAddress("pfjetpTdn05",pfjetpTdn05);
*/
   Tin->SetBranchAddress("pfjetJEC05",pfjetJEC05);
   Tin->SetBranchAddress("pfjetJECL105",pfjetJECL105);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF05",pfjetSF05);
   Tin->SetBranchAddress("pfjetSFup05",pfjetSFup05);
   Tin->SetBranchAddress("pfjetSFdn05",pfjetSFdn05);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer05",pfjetSF_sjer05);
   Tin->SetBranchAddress("pfjetSF_rjer05",pfjetSF_rjer05);
   Tin->SetBranchAddress("pfjet_matchgen05",pfjet_matchgen05);
   #endif
   }
   
   Tin->SetBranchAddress("npfjets06", &npfjets06);
   Tin->SetBranchAddress("pfjetpT06",pfjetpT06);
   Tin->SetBranchAddress("pfjetarea06",pfjetarea06);
   Tin->SetBranchAddress("pfjety06",pfjety06);
   Tin->SetBranchAddress("pfjetphi06",pfjetphi06) ;
   Tin->SetBranchAddress("pfjetenr06",pfjetenr06) ;
   Tin->SetBranchAddress("pfjettightID06",pfjettightID06);
   Tin->SetBranchAddress("pfjetlooseID06",pfjetlooseID06); 
/*
   Tin->SetBranchAddress("pfjetpTup06",pfjetpTup06);
   Tin->SetBranchAddress("pfjetpTdn06",pfjetpTdn06);
*/
   Tin->SetBranchAddress("pfjetJEC06",pfjetJEC06);
   Tin->SetBranchAddress("pfjetJECL106",pfjetJECL106);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF06",pfjetSF06);
   Tin->SetBranchAddress("pfjetSFup06",pfjetSFup06);
   Tin->SetBranchAddress("pfjetSFdn06",pfjetSFdn06);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer06",pfjetSF_sjer06);
   Tin->SetBranchAddress("pfjetSF_rjer06", pfjetSF_rjer06);
   Tin->SetBranchAddress("pfjet_matchgen06",pfjet_matchgen06);
   #endif
   }

   Tin->SetBranchAddress("npfjets07", &npfjets07);
   Tin->SetBranchAddress("pfjetpT07",pfjetpT07);
   Tin->SetBranchAddress("pfjetarea07",pfjetarea07);
   Tin->SetBranchAddress("pfjety07",pfjety07);
   Tin->SetBranchAddress("pfjetphi07",pfjetphi07) ; 
   Tin->SetBranchAddress("pfjetenr07",pfjetenr07) ;
   Tin->SetBranchAddress("pfjettightID07",pfjettightID07);
   Tin->SetBranchAddress("pfjetlooseID07",pfjetlooseID07); 
/*
   Tin->SetBranchAddress("pfjetpTup07",pfjetpTup07);
   Tin->SetBranchAddress("pfjetpTdn07",pfjetpTdn07);
*/
   Tin->SetBranchAddress("pfjetJEC07",pfjetJEC07);
   Tin->SetBranchAddress("pfjetJECL107",pfjetJECL107);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF07",pfjetSF07);
   Tin->SetBranchAddress("pfjetSFup07",pfjetSFup07);
   Tin->SetBranchAddress("pfjetSFdn07",pfjetSFdn07);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer07",pfjetSF_sjer07);
   Tin->SetBranchAddress("pfjetSF_rjer07",pfjetSF_rjer07);
   Tin->SetBranchAddress("pfjet_matchgen07",pfjet_matchgen07);
   #endif
   }
   
   Tin->SetBranchAddress("npfjets08", &npfjets08);
   Tin->SetBranchAddress("pfjetpT08",pfjetpT08);
   Tin->SetBranchAddress("pfjetarea08",pfjetarea08);
   Tin->SetBranchAddress("pfjety08",pfjety08);
   Tin->SetBranchAddress("pfjetphi08",pfjetphi08) ;
   Tin->SetBranchAddress("pfjetenr08",pfjetenr08) ;
   Tin->SetBranchAddress("pfjettightID08",pfjettightID08);
   Tin->SetBranchAddress("pfjetlooseID08",pfjetlooseID08); 
/*
   Tin->SetBranchAddress("pfjetpTup08",pfjetpTup08);
   Tin->SetBranchAddress("pfjetpTdn08",pfjetpTdn08);
*/
   Tin->SetBranchAddress("pfjetJEC08",pfjetJEC08);
   Tin->SetBranchAddress("pfjetJECL108",pfjetJECL108);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF08",pfjetSF08);
   Tin->SetBranchAddress("pfjetSFup08",pfjetSFup08);
   Tin->SetBranchAddress("pfjetSFdn08",pfjetSFdn08);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer08",pfjetSF_sjer08);
   Tin->SetBranchAddress("pfjetSF_rjer08",pfjetSF_rjer08);
   Tin->SetBranchAddress("pfjet_matchgen08",pfjet_matchgen08);
   #endif
   }
   
   Tin->SetBranchAddress("npfjets09", &npfjets09);
   Tin->SetBranchAddress("pfjetpT09",pfjetpT09);
   Tin->SetBranchAddress("pfjetarea09",pfjetarea09);
   Tin->SetBranchAddress("pfjety09",pfjety09);
   Tin->SetBranchAddress("pfjetphi09",pfjetphi09) ;
   Tin->SetBranchAddress("pfjetenr09",pfjetenr09) ;
   Tin->SetBranchAddress("pfjettightID09",pfjettightID09);
   Tin->SetBranchAddress("pfjetlooseID09",pfjetlooseID09);
/*
   Tin->SetBranchAddress("pfjetpTup09",pfjetpTup09);
   Tin->SetBranchAddress("pfjetpTdn09",pfjetpTdn09);
*/
   Tin->SetBranchAddress("pfjetJEC09",pfjetJEC02);
   Tin->SetBranchAddress("pfjetJECL109",pfjetJECL102);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF09",pfjetSF09);
   Tin->SetBranchAddress("pfjetSFup09",pfjetSFup09);
   Tin->SetBranchAddress("pfjetSFdn09",pfjetSFdn09);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer09",pfjetSF_sjer09);
   Tin->SetBranchAddress("pfjetSF_rjer09",pfjetSF_rjer09);
   Tin->SetBranchAddress("pfjet_matchgen09",pfjet_matchgen09);
   #endif
   }
 
   Tin->SetBranchAddress("npfjets10", &npfjets10);
   Tin->SetBranchAddress("pfjetpT10",pfjetpT10);
   Tin->SetBranchAddress("pfjetarea10",pfjetarea10);
   Tin->SetBranchAddress("pfjety10",pfjety10);
   Tin->SetBranchAddress("pfjetphi10",pfjetphi10) ;
   Tin->SetBranchAddress("pfjetenr10",pfjetenr10) ;
   Tin->SetBranchAddress("pfjettightID10",pfjettightID10);
   Tin->SetBranchAddress("pfjetlooseID10",pfjetlooseID10); 
/*
   Tin->SetBranchAddress("pfjetpTup10",pfjetpTup10);
   Tin->SetBranchAddress("pfjetpTdn10",pfjetpTdn10);
*/
   Tin->SetBranchAddress("pfjetJEC10",pfjetJEC10);
   Tin->SetBranchAddress("pfjetJECL110",pfjetJECL110);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF10",pfjetSF10);
   Tin->SetBranchAddress("pfjetSFup10",pfjetSFup10);
   Tin->SetBranchAddress("pfjetSFdn10",pfjetSFdn10);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer10",pfjetSF_sjer10);
   Tin->SetBranchAddress("pfjetSF_rjer10",pfjetSF_rjer10);
   Tin->SetBranchAddress("pfjet_matchgen10",pfjet_matchgen10);
   #endif
   }

   Tin->SetBranchAddress("npfjets11", &npfjets11);
   Tin->SetBranchAddress("pfjetpT11",pfjetpT11);
   Tin->SetBranchAddress("pfjetarea11",pfjetarea11);
   Tin->SetBranchAddress("pfjety11",pfjety11);
   Tin->SetBranchAddress("pfjetphi11",pfjetphi11) ; 
   Tin->SetBranchAddress("pfjetenr11",pfjetenr11) ;
   Tin->SetBranchAddress("pfjettightID11",pfjettightID11);
   Tin->SetBranchAddress("pfjetlooseID11",pfjetlooseID11);
/*
   Tin->SetBranchAddress("pfjetpTup11",pfjetpTup11);
   Tin->SetBranchAddress("pfjetpTdn11",pfjetpTdn11);
*/
   Tin->SetBranchAddress("pfjetJEC11",pfjetJEC11);
   Tin->SetBranchAddress("pfjetJECL111",pfjetJECL111);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF11",pfjetSF11);
   Tin->SetBranchAddress("pfjetSFup11",pfjetSFup11);
   Tin->SetBranchAddress("pfjetSFdn11",pfjetSFdn11); 
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer11",pfjetSF_sjer11);
   Tin->SetBranchAddress("pfjetSF_rjer11",pfjetSF_rjer11);
   Tin->SetBranchAddress("pfjet_matchgen11",pfjet_matchgen11); 
   #endif
   }
	
   Tin->SetBranchAddress("npfjets12", &npfjets12);
   Tin->SetBranchAddress("pfjetpT12",pfjetpT12);
   Tin->SetBranchAddress("pfjetarea12",pfjetarea12);
   Tin->SetBranchAddress("pfjety12",pfjety12);
   Tin->SetBranchAddress("pfjetphi12",pfjetphi12) ; 
   Tin->SetBranchAddress("pfjetenr12",pfjetenr12) ;
   Tin->SetBranchAddress("pfjettightID12",pfjettightID12);
   Tin->SetBranchAddress("pfjetlooseID12",pfjetlooseID12);
/*
   Tin->SetBranchAddress("pfjetpTup12",pfjetpTup12);
   Tin->SetBranchAddress("pfjetpTdn12",pfjetpTdn12);
*/
   Tin->SetBranchAddress("pfjetJEC12",pfjetJEC12);
   Tin->SetBranchAddress("pfjetJECL112",pfjetJECL112);
   if(isMC){
   Tin->SetBranchAddress("pfjetSF12",pfjetSF12);
   Tin->SetBranchAddress("pfjetSFup12",pfjetSFup12);
   Tin->SetBranchAddress("pfjetSFdn12",pfjetSFdn12);
   #ifdef HERWIG
   Tin->SetBranchAddress("pfjetSF_sjer12",pfjetSF_sjer12);
   Tin->SetBranchAddress("pfjetSF_rjer12",pfjetSF_rjer12);
   Tin->SetBranchAddress("pfjet_matchgen12",pfjet_matchgen12);
   #endif
   }
	
   if(isMC){
 
     Tin->SetBranchAddress("ngenjets01", &ngenjets01);
     Tin->SetBranchAddress("genjetpT01",genjetpT01);
     Tin->SetBranchAddress("genjetarea01",genjetarea01);
     Tin->SetBranchAddress("genjety01",genjety01);
     Tin->SetBranchAddress("genjetphi01",genjetphi01) ;
     Tin->SetBranchAddress("genjetenr01",genjetenr01) ;
     
     Tin->SetBranchAddress("ngenjets02", &ngenjets02);
     Tin->SetBranchAddress("genjetpT02",genjetpT02);
     Tin->SetBranchAddress("genjetarea02",genjetarea02);
     Tin->SetBranchAddress("genjety02",genjety02);
     Tin->SetBranchAddress("genjetphi02",genjetphi02) ;
     Tin->SetBranchAddress("genjetenr02",genjetenr02) ;
     
     Tin->SetBranchAddress("ngenjets03", &ngenjets03);
     Tin->SetBranchAddress("genjetpT03",genjetpT03);
     Tin->SetBranchAddress("genjetarea03",genjetarea03);
     Tin->SetBranchAddress("genjety03",genjety03);
     Tin->SetBranchAddress("genjetphi03",genjetphi03) ;
     Tin->SetBranchAddress("genjetenr03",genjetenr03) ;
     
     Tin->SetBranchAddress("ngenjets04", &ngenjets04);
     Tin->SetBranchAddress("genjetpT04",genjetpT04);
     Tin->SetBranchAddress("genjetarea04",genjetarea04);
     Tin->SetBranchAddress("genjety04",genjety04);
     Tin->SetBranchAddress("genjetphi04",genjetphi04) ;
     Tin->SetBranchAddress("genjetenr04",genjetenr04) ;
     
     Tin->SetBranchAddress("ngenjets05", &ngenjets05);
     Tin->SetBranchAddress("genjetpT05",genjetpT05);
     Tin->SetBranchAddress("genjetarea05",genjetarea05);
     Tin->SetBranchAddress("genjety05",genjety05);
     Tin->SetBranchAddress("genjetphi05",genjetphi05) ;
     Tin->SetBranchAddress("genjetenr05",genjetenr05) ;
     
     Tin->SetBranchAddress("ngenjets06", &ngenjets06);
     Tin->SetBranchAddress("genjetpT06",genjetpT06);
     Tin->SetBranchAddress("genjetarea06",genjetarea06);
     Tin->SetBranchAddress("genjety06",genjety06);
     Tin->SetBranchAddress("genjetphi06",genjetphi06) ;
     Tin->SetBranchAddress("genjetenr06",genjetenr06) ;
     
     Tin->SetBranchAddress("ngenjets07", &ngenjets07);
     Tin->SetBranchAddress("genjetpT07",genjetpT07);
     Tin->SetBranchAddress("genjetarea07",genjetarea07);
     Tin->SetBranchAddress("genjety07",genjety07);
     Tin->SetBranchAddress("genjetphi07",genjetphi07) ;
     Tin->SetBranchAddress("genjetenr07",genjetenr07) ;
     
     Tin->SetBranchAddress("ngenjets08", &ngenjets08);
     Tin->SetBranchAddress("genjetpT08",genjetpT08);
     Tin->SetBranchAddress("genjetarea08",genjetarea08);
     Tin->SetBranchAddress("genjety08",genjety08);
     Tin->SetBranchAddress("genjetphi08",genjetphi08) ;
     Tin->SetBranchAddress("genjetenr08",genjetenr08) ;
     
     Tin->SetBranchAddress("ngenjets09", &ngenjets09);
     Tin->SetBranchAddress("genjetpT09",genjetpT09);
     Tin->SetBranchAddress("genjetarea09",genjetarea09);
     Tin->SetBranchAddress("genjety09",genjety09);
     Tin->SetBranchAddress("genjetphi09",genjetphi09) ;
     Tin->SetBranchAddress("genjetenr09",genjetenr09) ;
     
     Tin->SetBranchAddress("ngenjets10", &ngenjets10);
     Tin->SetBranchAddress("genjetpT10",genjetpT10);
     Tin->SetBranchAddress("genjetarea10",genjetarea10);
     Tin->SetBranchAddress("genjety10",genjety10);
     Tin->SetBranchAddress("genjetphi10",genjetphi10) ;
     Tin->SetBranchAddress("genjetenr10",genjetenr10) ;
    
     Tin->SetBranchAddress("ngenjets11", &ngenjets11);
     Tin->SetBranchAddress("genjetpT11",genjetpT11);
     Tin->SetBranchAddress("genjetarea11",genjetarea11);
     Tin->SetBranchAddress("genjety11",genjety11);
     Tin->SetBranchAddress("genjetphi11",genjetphi11) ;
     Tin->SetBranchAddress("genjetenr11",genjetenr11) ;
     
     Tin->SetBranchAddress("ngenjets12", &ngenjets12);
     Tin->SetBranchAddress("genjetpT12",genjetpT12);
     Tin->SetBranchAddress("genjetarea12",genjetarea12);
     Tin->SetBranchAddress("genjety12",genjety12);
     Tin->SetBranchAddress("genjetphi12",genjetphi12) ;
     Tin->SetBranchAddress("genjetenr12",genjetenr12) ;
     
   } //isMC
  
    ifstream ifp("correction_plynomial.log");
/*
    for(int ij=0; ij<nalgo; ij++){
           for(int jk=0; jk<netarange; jk++){
                  double parvalues[nopol]={0};
                   for(int kl=0; kl<nopol; kl++){
                           ifp>>cor_expo[ij][jk][kl];
                           parvalues[kl] = cor_expo[ij][jk][kl];
                   }

                fit_cor[ij][jk]->SetParameters(parvalues);
           }
   }
*/
   ifstream fp("correction_factor_JECv10.log");

   for(int ij=0; ij<nalgo; ij++){
           for(int jk=0; jk<netarange; jk++){
                   for(int kl=0; kl<noptbins1; kl++){
                           fp>>ex_cor[ij][jk][kl];
                   }
           }
   }

   ifp.close();
 
   int nentries = Tin->GetEntries();
    
   cout <<"file "<<datafile<<" entries "<<nentries<< endl;

   TRandom3* gRandom3 = new TRandom3();
   int *_outlist = new int[ 100000000 ];
   std::vector<float> _jkmore;

   for (Long64_t jentry5=0; jentry5<nentries; jentry5++) {

	if (_jkmore.size()==0) { // if jkmore is empty, reset it first
     for (int ijk = 0; ijk != nrun; ++ijk) _jkmore.push_back(ijk);
	}
	int m = _jkmore.size(); assert(m!=0);
	int mout = gRandom3->Integer(m);
	int iout = int(_jkmore[mout]);
	_outlist[jentry5] = iout;
	_jkmore.erase(_jkmore.begin()+mout);

	}
 

   for (int ij=0; ij<nentries; ij++) {
       
     fileIn->cd();
      
     Tin->GetEntry(ij);
       
     fillarray();
      
     int ievtag = _outlist[ij];//ij%nrun; 
       
     weight = event_weight;
     weight*=rat_pileup[0][npu_vert];
     //cout<<"no. of pu vertices "<<npu_vert<<'\t'<<"weight "<<weight<<endl;
       
     hist_pfmet->Fill(miset,weight);
     hist_SumEt->Fill(sumEt,weight);
     hist_METbyET->Fill(miset*1./sumEt,weight);
            
     hist_PV_all->Fill(nvert,weight);     
     hist_PV_sel->Fill(nchict,weight);   
     hist_PU->Fill(npu_vert,weight); 
       
     PU_vs_PV_all->Fill(npu_vert,nvert);
     PU_vs_PV_sel->Fill(npu_vert,nchict);
     PU_vs_PV_sel_rewt->Fill(npu_vert,nchict,weight);
              
     for(int ix=0; ix<nalgo; ix++){
		
       iRecoPTbin[ix] = -1;
       iGenPTbin[ix] = -1;
		
       int njet_count[netarange] = {0};
 
       for(int jet=0; jet<njets[ix]; jet++){
			  
	 //	 if(jet==0 && pfjettightID[ix][jet]==0) break;
	 //	 if(pfjettightID[ix][jet]==0) continue;
			  
	 int etatag = getbinid(abs(pfjety[ix][jet]),netarange,etarng);
	 if(etatag>=0) {
	   njet_count[etatag]++;
	   /*
	   int ptbin_tag = getbinid(pfjetpT[ix][jet],noptbins1,ptbins1);
	   if(ptbin_tag>=0){
          if(ex_cor[ix][etatag][ptbin_tag]<1.e-3) { ex_cor[ix][etatag][ptbin_tag] = 1.; }
			pfjetpT[ix][jet]*=ex_cor[ix][etatag][ptbin_tag];
//			pfjetpTup[ix][jet]*=ex_cor[ix][etatag][ptbin_tag];
//			pfjetpTdn[ix][jet]*=ex_cor[ix][etatag][ptbin_tag];
		}
	   */
/*
      double ex_cor = fit_cor[ix][etatag]->Eval(pfjetpT[ix][jet]);
      pfjetpT[ix][jet] *= ex_cor;
*/ 
#ifdef HERWIG
	int ieta = getbinid(abs(pfjety[ix][jet]),netarange_jerc,etarange_jerc);
	if(ieta>=0){
	float hwg_sf = HWF_SF[ieta];
	   if(pfjet_matchgen[ix][jet]>=0 && pfjet_matchgen[ix][jet]<20){
		   pfjetSF_sjer[ix][jet] *= hwg_sf;
		   pfjetSF[ix][jet] = 1. + (pfjetSF_sjer[ix][jet]-1.)*(pfjetpT[ix][jet]-genjetpT[ix][pfjet_matchgen[ix][jet]])*1./pfjetpT[ix][jet];
		   }else{
			   double reso = 0;
			   reso = (pfjetSF_sjer[ix][jet]*pfjetSF_sjer[ix][jet] > 1.)? ((pfjetSF[ix][jet] - 1.)*1./sqrt(pfjetSF_sjer[ix][jet]*pfjetSF_sjer[ix][jet]-1)):0;
			   pfjetSF_sjer[ix][jet] *= hwg_sf;
			   pfjetSF[ix][jet] =  1. + sqrt(max(float(0.),(pfjetSF_sjer[ix][jet]*pfjetSF_sjer[ix][jet]-1))) * reso;
			    }
		}
	
#endif

	   pfjetpT[ix][jet] *= pfjetSF[ix][jet];
	   pfjetpTup[ix][jet] *= pfjetSFup[ix][jet];
 	   pfjetpTdn[ix][jet] *= pfjetSFdn[ix][jet];

	   JetpT[ix][etatag]->Fill(pfjetpT[ix][jet],weight);
	   JetpT_up[ix][etatag]->Fill(pfjetpTup[ix][jet],weight);
	   JetpT_dn[ix][etatag]->Fill(pfjetpTdn[ix][jet],weight);
	   
	   for(int irun=0; irun<nrun; irun++){
		if(irun!=ievtag){
			JetpT_stat[ix][etatag][irun]->Fill(pfjetpT[ix][jet],weight);
			}
		}

	   hist_pfjetSF[ix][etatag]->Fill(pfjetSF[ix][jet]);
	   hist_pfjetSFup[ix][etatag]->Fill(pfjetSFup[ix][jet]);
	   hist_pfjetSFdn[ix][etatag]->Fill(pfjetSFdn[ix][jet]);

	   if (pfjetpT[ix][jet]>leadingPtThreshold[0]) { Jeteta[ix]->Fill(pfjety[ix][jet],weight); }

        if(jet==0) { Pthat_vs_LeadPt[ix]->Fill(pthat,pfjetpT[ix][jet]); }

	   JetPt_vs_JEC[ix][etatag]->Fill(pfjetpT[ix][jet],pfjetJEC[ix][jet],weight);
	   JetPt_vs_JECL1[ix][etatag]->Fill(pfjetpT[ix][jet],pfjetJECL1[ix][jet],weight);
	   
	   if(jet==0){
	     //	     iRecoPTbin[ix] = getbinid(pfjetpT[ix][jet],nHLTmx, leadingPtThreshold);
	     LeadJetpT[ix][etatag]->Fill(pfjetpT[ix][jet],weight);
	     if (pfjetpT[ix][jet]>leadingPtThreshold[0]) { LeadJeteta[ix]->Fill(pfjety[ix][jet],weight);}
	   }
	 }
       } //jet
      

       for(int eta=0; eta<netarange; eta++){
		NJets[ix][eta]->Fill(njet_count[eta],weight) ;
	 
		for(int irun=0; irun<nrun; irun++){
			if(irun!=ievtag){
				NJets_stat[ix][eta][irun]->Fill(njet_count[eta],weight) ;
				}
			}
       }

       if(njets[ix]>=2){
	 Leading2JetsDeltaR[ix]->Fill(delta2R(pfjety[ix][0],pfjetphi[ix][0],pfjety[ix][1],pfjetphi[ix][1]),weight);
	 Leading2JetsDeltaPhi[ix]->Fill(PhiInRange(pfjetphi[ix][0]-pfjetphi[ix][1]),weight);

	 if((njets[ix]==2)||((njets[ix]>2)&&(pfjetpT[ix][2]<50.))){
	   double p4[3]={0};
		
	   if(abs(PhiInRange(pfjetphi[ix][0]-pfjetphi[ix][1]))>(2*M_PI/3.)){
	     for(int jt=0; jt<2; jt++){
	       p4[0]+=pfjetenr[ix][jt];
	       p4[1]+=pfjetpT[ix][jt];
	       p4[2]+=pfjetenr[ix][jt]*tanh(pfjety[ix][jt]);
	     }
				    
	     double refy ;
	     if(abs(pfjety[ix][0])>abs(pfjety[ix][1])){ refy = abs(pfjety[ix][0]);}
	     else { refy = abs(pfjety[ix][1]); }
	     int etatag = getbinid(refy,netarange,etarng)  ; 
			
	     if(etatag>=0) {
	       double mass = sqrt(pow(p4[0],2.)-pow(p4[1],2.)-pow(p4[2],2.));
	       DiJet_Mass[ix][etatag]->Fill(mass,weight);	
	     }
	   }//phi condn
	 }//dijet cond
       }//npfjets[ix]>=2	  
			
       if(isMC) {
				 
	 int ngenjet_count[netarange] = {0};
				
	 for(int jet=0; jet<ngenjets[ix]; jet++){
	   int etatag = getbinid(abs(genjety[ix][jet]),netarange,etarng);
	   if(etatag>=0){
	     ngenjet_count[etatag]++;
	     GenMCJetpT[ix][etatag]->Fill(genjetpT[ix][jet],weight);
	     GenMCJetpT_pow[ix][etatag]->Fill(genjetpT[ix][jet],genjetpT[ix][jet]*weight);
	     if (genjetpT[ix][jet]>leadingPtThreshold[0]) { GenJeteta[ix]->Fill(genjety[ix][jet],weight); }
	     
	     for(int irun=0; irun<nrun; irun++){
			if(irun!=ievtag){
			GenMCJetpT_stat[ix][etatag][irun]->Fill(genjetpT[ix][jet],weight);
			}
		}
	     
	     
	     if(jet==0){
	       //	       iGenPTbin[ix] = getbinid(genjetpT[ix][jet],nHLTmx, leadingPtThreshold);
	       GenMCLeadJetpT[ix][etatag]->Fill(genjetpT[ix][jet],weight);
	       if (genjetpT[ix][jet]>leadingPtThreshold[0]) {GenLeadJeteta[ix]->Fill(genjety[ix][jet],weight);}
	     }
	   }
	 }//jet
				  
	 for(int eta=0; eta<netarange; eta++){
	   NGenJets[ix][eta]->Fill(ngenjet_count[eta],weight);
	 }

	 if(ngenjets[ix]>=2){
	   GenLeading2JetsDeltaR[ix]->Fill(delta2R(genjety[ix][0],genjetphi[ix][0],genjety[ix][1],genjetphi[ix][1]),weight);
	   GenLeading2JetsDeltaPhi[ix]->Fill(PhiInRange(genjetphi[ix][0]-genjetphi[ix][1]),weight);
			
	   if((ngenjets[ix]==2)||((ngenjets[ix]>2)&&(genjetpT[ix][2]<50.))){
			
	     double p4[3]={0};
			
	     if(abs(PhiInRange(genjetphi[ix][0]-genjetphi[ix][1]))>(2*M_PI/3.)) {
	       for(int jt=0; jt<2; jt++){
		 p4[0]+=genjetenr[ix][jt];
		 p4[1]+=genjetpT[ix][jt];
		 p4[2]+=genjetenr[ix][jt]*tanh(genjety[ix][jt]);
	       }
	       double refy ;
	       if(abs(genjety[ix][0])>abs(genjety[ix][1])){ refy = abs(genjety[ix][0]);}
	       else { refy = abs(genjety[ix][1]); }
	       int etatag = getbinid(refy,netarange,etarng)  ; 
			
	       if(etatag>=0){
		 double mass = sqrt(pow(p4[0],2.)-pow(p4[1],2.)-pow(p4[2],2.));
		 Gen_DiJet_Mass[ix][etatag]->Fill(mass,weight);		
	       }
	     }//phi condn
	   }//dijet 
	 }	  
	
			
	 //// ====== Resolution ==============

	 double deltaR_min = 0.05*(ix+1);
 
	 for(int reco = 0; reco<njets[ix]; reco++){
		
	   deltaR_min = 0.05*(ix+1);
		
	   int recoeta_tag = getbinid(abs(pfjety[ix][reco]),netarange,etarng);
	   if ((recoeta_tag<0)||(recoeta_tag>=netarange)) continue;
	    
	   int recopttag = getbinid(pfjetpT[ix][reco],noptbins,ptbins);
	   //	if(recopttag<0) continue ;
		
	   int match_gen = -1;
	   bool ismatched = false;
		
	   for(int gen = 0; gen<ngenjets[ix]; gen++){
			
	     int geneta_tag = -1;
	     geneta_tag = getbinid(abs(genjety[ix][gen]),netarange,etarng);
	     int genpt_tag = -1;
	     genpt_tag = getbinid(genjetpT[ix][gen],noptbins,ptbins);

	     if((recoeta_tag==geneta_tag)&&(recopttag==genpt_tag)&&geneta_tag>=0){ Pt_Ratio_nomatch[ix][geneta_tag]->Fill(genjetpT[ix][gen],pfjetpT[ix][reco]*1./genjetpT[ix][gen],weight);}
			
	     //	if(geneta_tag<0||genpt_tag<0) continue;
			
	     double delR_rg = delta2R(pfjety[ix][reco],pfjetphi[ix][reco],genjety[ix][gen],genjetphi[ix][gen]);
			
	     if((genjetpT[ix][gen]>0.5*(pfjetpT[ix][reco]))&&(genjetpT[ix][gen]<2.*(pfjetpT[ix][reco]))){
	       if((geneta_tag>=0)&&(genpt_tag>=0)){
		 DeltaR_RecoGen[ix][geneta_tag][genpt_tag]->Fill(delR_rg) ;
	       }
	     }
			
	     double pt_rat = pfjetpT[ix][reco]*1./genjetpT[ix][gen] ;
			
	     if((delR_rg < deltaR_min)&&((pt_rat>0.25)&&(pt_rat<4.))) { 
	       deltaR_min = delR_rg ; 
	       match_gen = gen;
	       ismatched = true;
	     }
	   }//gen
			
			   
	   if(match_gen>=0){
				
	     int gen = match_gen;
					
	     int geneta_tag = getbinid(abs(genjety[ix][gen]),netarange,etarng);
	     int genpt_tag =  getbinid(genjetpT[ix][gen],noptbins,ptbins);	
				
	     int recomin = -1;
	     deltaR_min = 0.05*(ix+1);
				
	     for(int reco2=0; reco2<njets[ix]; reco2++){
	       double delR_rg = delta2R(pfjety[ix][reco2],pfjetphi[ix][reco2],genjety[ix][gen],genjetphi[ix][gen]) ;
	       if(delR_rg < deltaR_min){
				deltaR_min = delta2R(pfjety[ix][reco2],pfjetphi[ix][reco2],genjety[ix][gen],genjetphi[ix][gen]);
				recomin = reco2;
	       }
	     }//reco2
					
	     if(recomin==reco) {
				
	       if((geneta_tag>=0)&&(genpt_tag>=0)) {
						
		 double res_pt = 0;
		 res_pt = (pfjetpT[ix][reco] - genjetpT[ix][gen])*1.0/genjetpT[ix][gen]; // (RecopT[ix] - GenpT[ix])*1.0/(GenpT[ix]) ;
		 int nbins = Resolution[ix][geneta_tag][genpt_tag]->GetNbinsX();
		 if(res_pt<(Resolution[ix][geneta_tag][genpt_tag]->GetBinLowEdge(1))) {
		   res_pt = (Resolution[ix][geneta_tag][genpt_tag]->GetBinLowEdge(1))+0.0001;
		 }else {
		   if(res_pt>(Resolution[ix][geneta_tag][genpt_tag]->GetBinLowEdge(nbins+1))) {
		     res_pt = Resolution[ix][geneta_tag][genpt_tag]->GetBinLowEdge(nbins+1) -0.0001;
		   }
		 }
				
		 Resolution[ix][geneta_tag][genpt_tag]->Fill(res_pt) ;
	       } //if((geneta_tag>=0)&&(genpt_tag>=0))
			
	       if(geneta_tag==recoeta_tag){
			RecoVsGenJetpT[ix][geneta_tag]->Fill(pfjetpT[ix][reco],genjetpT[ix][gen],weight);
			
			for(int irun=0; irun<nrun; irun++){
			if(irun!=ievtag){
				RecoVsGenJetpT_stat[ix][geneta_tag][irun]->Fill(pfjetpT[ix][reco],genjetpT[ix][gen],weight);
				}
			}
			
			
			Pt_Ratio[ix][geneta_tag]->Fill(genjetpT[ix][gen],pfjetpT[ix][reco]*1./genjetpT[ix][gen],weight);
	       } else {
		 if(recoeta_tag>=0){
		   RecoVsGenJetpT[ix][recoeta_tag]->Fill(pfjetpT[ix][reco],-1,weight);
		 
		   for(int irun=0; irun<nrun; irun++){
			if(irun!=ievtag){
				RecoVsGenJetpT_stat[ix][recoeta_tag][irun]->Fill(pfjetpT[ix][reco],-1,weight);
				}
			}
		 }
		 if(geneta_tag>=0){
		   RecoVsGenJetpT[ix][geneta_tag]->Fill(-1,genjetpT[ix][gen],weight);
		 
		   for(int irun=0; irun<nrun; irun++){
			if(irun!=ievtag){
				 RecoVsGenJetpT_stat[ix][geneta_tag][irun]->Fill(-1,genjetpT[ix][gen],weight);
				}
			}
		 }	
	       }
	     } else { //if(recomin==reco) 
	       RecoVsGenJetpT[ix][recoeta_tag]->Fill(pfjetpT[ix][reco],-1,weight);
	   
	       for(int irun=0; irun<nrun; irun++){
			if(irun!=ievtag){
				 RecoVsGenJetpT_stat[ix][recoeta_tag][irun]->Fill(pfjetpT[ix][reco],-1,weight);
				}
			}
	     }
	   }//if(match_gen>=0)
	   else{
	     if(!ismatched){
	       if(recoeta_tag>=0){
				RecoVsGenJetpT[ix][recoeta_tag]->Fill(pfjetpT[ix][reco],-1,weight);
				for(int irun=0; irun<nrun; irun++){
				if(irun!=ievtag){
				 RecoVsGenJetpT_stat[ix][recoeta_tag][irun]->Fill(pfjetpT[ix][reco],-1,weight);
				}
			}
	       }
	     }
	   }
	 }//reco
	
	 
	 for(int gen = 0; gen<ngenjets[ix]; gen++){
		  
	   int geneta_tag = getbinid(abs(genjety[ix][gen]),netarange,etarng);
	   int genpt_tag = getbinid(genjetpT[ix][gen],noptbins,ptbins);
	   
	   //	   if(geneta_tag<0||genpt_tag<0) continue ; 
	   
	   deltaR_min = 0.05*(ix+1);
	   
	   bool ismatched =false;
	   for(int reco = 0; reco<njets[ix]; reco++) { 
	     int receta_tag = getbinid(abs(pfjety[ix][reco]),netarange,etarng);
	     int recpt_tag = getbinid(abs(pfjetpT[ix][reco]),noptbins,ptbins);
	  
	     double delR_rg = delta2R(pfjety[ix][reco],pfjetphi[ix][reco],genjety[ix][gen],genjetphi[ix][gen]);
	     double pt_rat = pfjetpT[ix][reco]*1./genjetpT[ix][gen];
			
	     if((delR_rg < deltaR_min)&&(pt_rat>0.25)&&(pt_rat<4.0)) { 
	      
	       int match_gen = -1;
	       
	       for(int gen2=0; gen2<ngenjets[ix] ; gen2++){
			   if(delta2R(pfjety[ix][reco],pfjetphi[ix][reco],genjety[ix][gen2],genjetphi[ix][gen2])<deltaR_min){
				   deltaR_min = delta2R(pfjety[ix][reco],pfjetphi[ix][reco],genjety[ix][gen2],genjetphi[ix][gen2]);
				   match_gen = gen2;
				   }
			   }
			   
			   if(gen==match_gen) {
				   ismatched =true; 
				   break;
				   }
	     }	
	   }//reco
	    
	   if (!ismatched) { 
	     if(geneta_tag>=0) {
	       RecoVsGenJetpT[ix][geneta_tag]->Fill(-1, genjetpT[ix][gen],weight) ;
	       
	       for(int irun=0; irun<nrun; irun++){
			if(irun!=ievtag){
				 RecoVsGenJetpT_stat[ix][geneta_tag][irun]->Fill(-1, genjetpT[ix][gen],weight) ;
				}
			}
	     }
	   }
	 }//gen
				 
	 //// ====== Resolution End ==========	
			
	 ////======Response Matrix for y ==============
			
	 double y_matrix[njetmx][njetmx] = {{0.}};
			
	 for(int reco = 0; reco<njets[ix]; reco++) { 
	   for(int gen=0; gen<ngenjets[ix]; gen++){
	     y_matrix[reco][gen] =  abs(pfjety[ix][reco]-genjety[ix][gen]) ;
	   }
	 }
			
	 for(int gen=0; gen<ngenjets[ix]; gen++){
	   double miny = 100;
	   int recmin_indx = -1;
	   for(int reco = 0; reco<njets[ix]; reco++){
	     if(y_matrix[reco][gen]<miny){
	       miny = y_matrix[reco][gen];
	       recmin_indx = reco;
	     }
	   }
					
	   if(recmin_indx>=0){
						
	     miny = 100;
	     int genmin_index = -1;
						
	     for(int gen2=0; gen2<ngenjets[ix]; gen2++){
	       if(y_matrix[recmin_indx][gen2]<miny){
		 miny = y_matrix[recmin_indx][gen2];
		 genmin_index = gen2;
	       }
	     }//gen2
							
	     if(genmin_index==gen) {
							
	       double pt_rat = pfjetpT[ix][recmin_indx]*1./genjetpT[ix][gen] ;
							
	       if(((pt_rat>0.5)&&(pt_rat<2.))&&(abs(PhiInRange(pfjetphi[ix][recmin_indx]-genjetphi[ix][gen]))<0.075*(ix+1))){
		 Response_y[ix]->Fill(abs(pfjety[ix][recmin_indx]),abs(genjety[ix][gen]),weight) ;
		 y_Reso[ix]->Fill(pfjety[ix][recmin_indx]-genjety[ix][gen]) ;
	       }
	     }
	     else {continue;}
	   }
	   else {continue;}
	 }//gen
					
	 //============= Response Matrix for y Ends =======================		

	 //======= Resolution in Phi Starts ====================

	 for(int reco = 0; reco<njets[ix]; reco++){
	   for(int gen=0; gen<ngenjets[ix]; gen++){
		
	     double minphi = 100;
	     double pseudo_pfphi = 100;
	     double pseudo_genphi = 100;
	     double pt_rat = pfjetpT[ix][reco]*1./genjetpT[ix][gen];
	     double del_y = abs(pfjety[ix][reco]-genjety[ix][gen]) ;
	     bool isMatched = false;
		
	     if(((pt_rat>0.5)&&(pt_rat<2.))&&(del_y<0.05*(ix+1))){
			
	       isMatched = true;
			
	       if(abs(PhiInRange(pfjetphi[ix][reco]-genjetphi[ix][gen])) < minphi){
		 pseudo_pfphi = pfjetphi[ix][reco];
		 pseudo_genphi = genjetphi[ix][gen];
		 minphi = abs(PhiInRange(pfjetphi[ix][reco]-genjetphi[ix][gen]));
	       }
	     }
			
	     if(isMatched){
	       phi_Reso[ix]->Fill(PhiInRange(pseudo_pfphi-pseudo_genphi));
	     }
	   }//gen
	 }//reco

	 //======= Resolution in Phi Ends ====================
				
	 for(int jk=0; jk<netarange; jk++){
	   RecoVsGenJetNo[ix][jk]->Fill(njet_count[jk],ngenjet_count[jk], weight) ;
	 }//jk
					
       } //isMC
     }//ix 
       
   }//ij

  delete _outlist;
  delete Tin;
  delete fileIn;
   
 }
 
 file_db.close();
 
  fileOut->cd();
  fileOut->Write();
  fileOut->Close();
 
  fp<<"Total Number of events in "<<fileOut->GetName()<<" is "<<nevent_total<<endl;
  fp<<"Total Weight is "<<tot_weight<<endl;
}
