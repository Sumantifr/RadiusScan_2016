#include "TFile.h"
#include "TH1F.h"
#include "TH2F.h"
#include "TTree.h"
#include "TAxis.h"
//#include "CLHEP/Vector/LorentzVector.h"
#include "TRandom.h"

#include <string>

#include <iostream>
#include <fstream>

//#define PU_UP   
//#define PU_DN

using namespace std;  

const float pival = acos(-1.);

static const int nalgo = 12 ;
const char* JetRad[nalgo] = {"ak1","ak2","ak3","ak4","ak5","ak6","ak7","ak8","ak9","ak10","ak11","ak12"};
static const int netarange = 10 ;
const char* JetEta[netarange] = {"|eta|<0.5","0.5<|eta|<1.0","1.0<|eta|<1.5","1.5<|eta|<2.0","2.0<|eta|<2.5","2.5<|eta|<3.0","3.0<|eta|<3.2","3.2<|eta|<3.7","3.7<|eta|<4.2","4.2<|eta|<4.7"} ;
double etarng[netarange+1] ={0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.2, 3.7, 4.2, 4.7};

const int noptbins = 62 ;
  
double ptbins[noptbins+1] = {/*30, 37, 43, 49, 56, 64,*/ 74, 84,
     97, 114, 133, 153, 174, 196, 220, 245, 272, 300, 330, 362, 395, 430, 468, 
     507, 548, 592, 638, 686, 737, 790, 846, 905, 967, 
     1032, 1101, 1172, 1248, 1327, 1410, 1497, 1588, 1684, 1784, 1890, 2000, 
     2116, 2238, 2366, 2500, 2640, 2787, 2941, 3103, 3273, 3450, 3637, 3832,
     4037, 4252, 4477, 4713, 4961, 5220, 5492, 5777, 6076, 6389, 6717, 7000} ;

const int noptbins1 = 68 ;

double ptbins1[noptbins1+1] = {30, 37, 43, 49, 56, 64, 74, 84,
     97, 114, 133, 153, 174, 196, 220, 245, 272, 300, 330, 362, 395, 430, 468,
     507, 548, 592, 638, 686, 737, 790, 846, 905, 967,
     1032, 1101, 1172, 1248, 1327, 1410, 1497, 1588, 1684, 1784, 1890, 2000,
     2116, 2238, 2366, 2500, 2640, 2787, 2941, 3103, 3273, 3450, 3637, 3832,
     4037, 4252, 4477, 4713, 4961, 5220, 5492, 5777, 6076, 6389, 6717, 7000} ;
     
 const double minPFPt = 20.;    
     
 const int npileupmx = 80;
 
 const int nHLTmx= 10; 
 double leadingPtThreshold[nHLTmx+1]= {74, 97, 133, 196, 272, 330, 395, 468, 548, 592, 5000.0};
 
 double datpileup[nHLTmx][npileupmx] = {{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09}
										 ,{6.54008e-06,2.29383e-05,6.32223e-05,8.55796e-05,0.000122592,0.000164214,0.000191738,0.000353072,0.000965735,0.00215544,0.00484612,0.00986199,0.0165083,0.0240058,0.032166,0.0407818,0.0481844,0.0532395,0.0561219,0.0575573,0.058412,0.0588587,0.0583078,0.056491,0.0537587,0.0504445,0.0466722,0.0425747,0.0383287,0.0340574,0.0298202,0.0256705,0.0216922,0.0179859,0.0146378,0.011698,0.00917774,0.00705846,0.00530639,0.00388441,0.00275715,0.00189012,0.00124723,0.000790064,0.000479456,0.00027833,0.000154405,8.18145e-05,4.14101e-05,2.00435e-05,9.30691e-06,4.17785e-06,1.84606e-06,8.3504e-07,4.1498e-07,2.45829e-07,1.77914e-07,1.48846e-07,1.33924e-07,1.23839e-07,1.1526e-07,1.07079e-07,9.89863e-08,9.09467e-08,8.30145e-08,7.52676e-08,6.77837e-08,6.06312e-08,5.38664e-08,4.75325e-08,4.16595e-08,3.62653e-08,3.1356e-08,2.69281e-08,2.29691e-08,1.94598e-08,1.63753e-08,1.36867e-08,1.13622e-08,9.36881e-09} 
										 }; //for 2016 data 80 bins
	/*
double datpileup[nHLTmx][npileupmx] = {{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0},
										{1.60632e-06,2.19544e-05,4.80216e-05,7.7327e-05,0.000103355,0.000141667,0.000139785,0.000156029,0.000190349,0.000403612,0.00170533,0.00646473,0.0142993,0.0221684,0.0282229,0.034754,0.0410107,0.0450835,0.0467224,0.0473963,0.0488002,0.051365,0.0540878,0.0559848,0.0567402,0.0563794,0.0550942,0.0530506,0.0501829,0.0463019,0.0413453,0.0355075,0.0292169,0.0230022,0.0173355,0.0125276,0.00870081,0.00582202,0.00376218,0.00235301,0.00142737,0.000841501,0.000483025,0.000270322,0.000147601,7.86226e-05,4.08194e-05,2.06252e-05,1.01236e-05,4.81766e-06,2.21875e-06,9.8739e-07,4.24111e-07,1.75696e-07,7.01769e-08,2.7026e-08,1.00382e-08,3.59769e-09,1.24489e-09,4.16113e-10,1.34419e-10,4.19762e-11,1.26726e-11,3.69814e-12,1.04281e-12,2.83992e-13,7.46483e-14,1.89255e-14,4.62474e-15,1.08856e-15,2.46645e-16,5.37632e-17,1.12758e-17,2.26918e-18,4.29189e-19,8.22786e-20,1.59247e-20,0,0,0}};
*/
double datpileup_up[nHLTmx][npileupmx] = {{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16},
										{1.04057e-06,1.46187e-05,3.60868e-05,5.56064e-05,8.19628e-05,0.000101728,0.000129048,0.000122608,0.000138187,0.00015915,0.000281514,0.000835432,0.00328878,0.00835496,0.0148967,0.020643,0.0252649,0.0303825,0.0353988,0.0390475,0.0408764,0.0415375,0.0421544,0.0435579,0.0456755,0.047785,0.0493057,0.0500428,0.0499921,0.0492517,0.0479558,0.0461443,0.0437269,0.0405894,0.03671,0.0322102,0.027342,0.0224256,0.0177714,0.0136189,0.0101068,0.00727533,0.00508858,0.00346378,0.00229816,0.0014884,0.000942272,0.000583892,0.00035455,0.000211132,0.000123342,7.06758e-05,3.96973e-05,2.18345e-05,1.17455e-05,6.17115e-06,3.16266e-06,1.57915e-06,7.67457e-07,3.62768e-07,1.66703e-07,7.44549e-08,3.23204e-08,1.36384e-08,5.59607e-09,2.23355e-09,8.67503e-10,3.27997e-10,1.20759e-10,4.33011e-11,1.51229e-11,5.14389e-12,1.70366e-12,5.49253e-13,1.72302e-13,5.25701e-14,1.55924e-14,4.49371e-15,1.2578e-15,3.41786e-16}};
	
double datpileup_dn[nHLTmx][npileupmx] = {{2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0},
										  {2.03462e-06,2.51997e-05,5.31105e-05,8.79617e-05,0.000115134,0.000152214,0.000148061,0.000170531,0.000254545,0.000765098,0.00381195,0.011083,0.0202155,0.0274211,0.0342951,0.0414792,0.046606,0.0488183,0.049597,0.0510322,0.0538078,0.0567839,0.0587941,0.0594854,0.0589145,0.0573244,0.0548649,0.0513963,0.046713,0.0408417,0.0341409,0.0272029,0.0206502,0.0149558,0.010359,0.00688108,0.00439577,0.00270759,0.00161197,0.000929778,0.000520681,0.000283559,0.000150299,7.75246e-05,3.88713e-05,1.89126e-05,8.90971e-06,4.05511e-06,1.77947e-06,7.51656e-07,3.05274e-07,1.19129e-07,4.46602e-08,1.60873e-08,5.57066e-09,1.8555e-09,5.9488e-10,1.83676e-10,5.46375e-11,1.56605e-11,4.32453e-12,1.15008e-12,2.94387e-13,7.24777e-14,1.71491e-14,3.89661e-15,8.49588e-16,1.77624e-16,3.55872e-17,6.82742e-18,1.24474e-18,2.21459e-19,3.80053e-20,0,0,0,0,0,0,0}};
			 
										
double  mcpileup[npileupmx] = {2.82595e-05,6.29473e-05,0.000126337,0.000256885,0.000564631,0.00110702,0.00204067,0.0035458,0.00559555,0.0083368,0.011575,0.0154292,0.01967,0.0241571,0.0285471,0.0326206,0.0364776,0.0397328,0.0421873,0.044275,0.0451668,0.0458842,0.045376,0.0445124,0.043152,0.0411647,0.038777,0.0366233,0.033998,0.0314075,0.0287512,0.0262996,0.0239008,0.0215455,0.0195003,0.0176033,0.015793,0.0141663,0.0128473,0.0115051,0.0103265,0.00926773,0.00834596,0.00750304,0.00666546,0.00597047,0.00529105,0.00466223,0.00413244,0.00362811,0.00318285,0.00273657,0.00239027,0.0020306,0.0017336,0.00146106,0.00122478,0.00100438,0.000834986,0.000668676,0.000550739,0.000455454,0.000343681,0.000275465,0.000227473,0.000165593,0.000133594,0.000107893,7.98589e-05,6.69385e-05,5.60126e-05,4.08681e-05,2.92365e-05,2.53712e-05,1.69478e-05,1.57952e-05,1.38265e-05,9.98148e-06,6.90946e-06,6.66382e-06} ; //For 2016 Summer MC

double rat_pileup[nHLTmx][npileupmx] = {{0}};

void PileUpGenerator(double datapileup[nHLTmx][npileupmx], double *mcpileup, double rat_pileup[nHLTmx][npileupmx])
{
    double dattot[nHLTmx]={0};
    double mctot=0;
    for (int ij=0; ij<npileupmx; ij++) {
      for (int jk=0; jk<nHLTmx; jk++) {
	dattot[jk] +=datpileup[jk][ij];
      }
      mctot +=mcpileup[ij];
    }
    cout<<"datatot "<<dattot[0]<<endl;
    
    for (int ij=0; ij<npileupmx; ij++) {
      mcpileup[ij] /=max(1.e-6,mctot);
      for (int jk=0; jk<nHLTmx; jk++) {
	datpileup[jk][ij] /=max(1.e-6,dattot[jk]);

#ifdef PU_UP
	rat_pileup[jk][ij] =  datpileup_up[jk][ij]*1./mcpileup[ij];
#elif defined(PU_DN)  
	rat_pileup[jk][ij] =  datpileup_dn[jk][ij]*1./mcpileup[ij];
#else
    rat_pileup[jk][ij] =  datpileup[jk][ij]*1./mcpileup[ij];
#endif
    
	if(jk==0) { cout<<ij<<" ratio "<<rat_pileup[jk][ij]<<endl;}
    
		}
    }
}

int getbinid(double val, int nbmx, double* array) {
  if (val<array[0]) return -2;
  for (int ix=0; ix<=nbmx; ix++) {
    if (val < array[ix]) return ix-1;
  }
  return -3;
}

double theta_to_eta(double theta) { return -log(tan(theta/2.)); }

double PhiInRange(const double& phi) {
  double phiout = phi;

  if( phiout > 2*M_PI || phiout < -2*M_PI) {
    phiout = fmod( phiout, 2*M_PI);
  }
  if (phiout <= -M_PI) phiout += 2*M_PI;
  else if (phiout >  M_PI) phiout -= 2*M_PI;

  return phiout;
}

double delta2R(double eta1, double phi1, double eta2, double phi2) {
  return sqrt(pow(eta1 - eta2,2) +pow(PhiInRange(phi1 - phi2),2));
}

  unsigned ievt;
  
  static const int njetmx =20; 
  
  double Rho ;
    
  int nvert;
  int nchict;
  int npu_vert;

  double event_weight;
  double weight;
  double tot_weight = 0;

  bool isMC = true;
  float pthat;

  int ngenjets[nalgo] ;
  int genjetmul[nalgo];
  float genjetenr[nalgo][njetmx], genjetmom[nalgo][njetmx], genjetpT[nalgo][njetmx], genjetpz[nalgo][njetmx], genjetarea[nalgo][njetmx], genjetthe[nalgo][njetmx], genjety[nalgo][njetmx], genjetphi[nalgo][njetmx] ;

  int ngenjets01;
  int genjetmul01[njetmx];
  float genjetenr01[njetmx], genjetpT01[njetmx], genjetarea01[njetmx], genjety01[njetmx], genjetphi01[njetmx];

  int ngenjets02;
  int genjetmul02[njetmx];
  float genjetenr02[njetmx], genjetpT02[njetmx], genjetarea02[njetmx], genjety02[njetmx], genjetphi02[njetmx] ;

  int ngenjets03;
  int genjetmul03[njetmx];
  float genjetenr03[njetmx], genjetpT03[njetmx], genjetarea03[njetmx], genjety03[njetmx], genjetphi03[njetmx] ;

  int ngenjets04;
  int genjetmul04[njetmx];
  float genjetenr04[njetmx], genjetpT04[njetmx], genjetarea04[njetmx], genjety04[njetmx], genjetphi04[njetmx] ;

  int ngenjets05;
  int genjetmul05[njetmx];
  float genjetenr05[njetmx], genjetpT05[njetmx], genjetarea05[njetmx], genjety05[njetmx], genjetphi05[njetmx] ;

  int ngenjets06;
  int genjetmul06[njetmx];
  float genjetenr06[njetmx], genjetpT06[njetmx], genjetarea06[njetmx], genjety06[njetmx], genjetphi06[njetmx] ;
 
  int ngenjets07;
  int genjetmul07[njetmx];
  float genjetenr07[njetmx], genjetpT07[njetmx], genjetarea07[njetmx], genjety07[njetmx], genjetphi07[njetmx] ;

  int ngenjets08;
  int genjetmul08[njetmx];
  float genjetenr08[njetmx], genjetpT08[njetmx], genjetarea08[njetmx], genjety08[njetmx], genjetphi08[njetmx] ;

  int ngenjets09;
  int genjetmul09[njetmx];
  float genjetenr09[njetmx], genjetpT09[njetmx], genjetarea09[njetmx], genjety09[njetmx], genjetphi09[njetmx] ;

  int ngenjets10;
  int genjetmul10[njetmx];
  float genjetenr10[njetmx], genjetpT10[njetmx], genjetarea10[njetmx], genjety10[njetmx], genjetphi10[njetmx] ;

  int ngenjets11;
  int genjetmul11[njetmx];
  float genjetenr11[njetmx], genjetpT11[njetmx], genjetarea11[njetmx], genjety11[njetmx], genjetphi11[njetmx] ;
  
  int ngenjets12;
  int genjetmul12[njetmx];
  float genjetenr12[njetmx], genjetpT12[njetmx], genjetarea12[njetmx], genjety12[njetmx], genjetphi12[njetmx] ;
  
  int ngenjets13;
  int genjetmul13[njetmx];
  float genjetenr13[njetmx], genjetpT13[njetmx], genjetarea13[njetmx], genjety13[njetmx], genjetphi13[njetmx] ;
  
  int ngenjets14;
  int genjetmul14[njetmx];
  float genjetenr14[njetmx], genjetpT14[njetmx], genjetarea14[njetmx], genjety14[njetmx], genjetphi14[njetmx] ;
  
  int ngenjets15;
  int genjetmul15[njetmx];
  float genjetenr15[njetmx], genjetpT15[njetmx], genjetarea15[njetmx], genjety15[njetmx], genjetphi15[njetmx];
  
  float miset , misphi , sumEt;
  
  int iRecoPTbin[nalgo] = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};
  int iGenPTbin[nalgo] = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};

  double ex_cor[nalgo][netarange][noptbins] = {{{1.}}};
  
void fillarray() {
  
  miset = miset;
  misphi = misphi;
  sumEt = sumEt;
  
  nvert = nvert;
  nchict = nchict;
  event_weight = event_weight;
  tot_weight+=event_weight;
  pthat = pthat;
  
  for(int ix=0; ix<nalgo; ix++){
   
    ngenjets[ix] = 0;
    
    switch(ix){
      
    case 0:
   
    for(int gjet=0; gjet<ngenjets01; gjet++){
	
	if(genjetpT01[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT01[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea01[gjet];
	genjety[ix][ngenjets[ix]] = genjety01[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi01[gjet];
	
	ngenjets[ix]++;
      }	
      
      break;	
      
      
    case 1:
      
      for(int gjet=0; gjet<ngenjets02; gjet++){
	
	if(genjetpT02[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT02[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea02[gjet];
	genjety[ix][ngenjets[ix]] = genjety02[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi02[gjet];
	
	ngenjets[ix]++;
      }
      
      break;	
      
      
    case 2:
      
      for(int gjet=0; gjet<ngenjets03; gjet++){
	
	if(genjetpT03[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT03[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea03[gjet];
	genjety[ix][ngenjets[ix]] = genjety03[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi03[gjet];
	
	ngenjets[ix]++;
      }
      
      break;	
      
      
    case 3:
      
      for(int gjet=0; gjet<ngenjets04; gjet++){
						
	if(genjetpT04[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT04[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea04[gjet];
	genjety[ix][ngenjets[ix]] = genjety04[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi04[gjet];
				 
	ngenjets[ix]++;
      }
				
      break;	
		
		    
    case 4:
     
      for(int gjet=0; gjet<ngenjets05; gjet++){
						
	if(genjetpT05[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT05[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea05[gjet];
	genjety[ix][ngenjets[ix]] = genjety05[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi05[gjet];
				 
	ngenjets[ix]++;
      }
      break;		
			
		
    case 5:
     
      for(int gjet=0; gjet<ngenjets06; gjet++){
						
	if(genjetpT06[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT06[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea06[gjet];
	genjety[ix][ngenjets[ix]] = genjety06[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi06[gjet];
			 
	ngenjets[ix]++;
      }
					
      break;	
			
			
    case 6:
			
      for(int gjet=0; gjet<ngenjets07; gjet++){
						
	if(genjetpT07[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT07[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea07[gjet];
	genjety[ix][ngenjets[ix]] = genjety07[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi07[gjet];
				 
	ngenjets[ix]++;
      }
				
      break;	
			
			
    case 7:
    
     for(int gjet=0; gjet<ngenjets08; gjet++){
						
	if(genjetpT08[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT08[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea08[gjet];
	genjety[ix][ngenjets[ix]] = genjety08[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi08[gjet];
				 
	ngenjets[ix]++;
      }
				 
      break;	
			
			
    case 8:
      
      for(int gjet=0; gjet<ngenjets09; gjet++){
						
	if(genjetpT09[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT09[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea09[gjet];
	genjety[ix][ngenjets[ix]] = genjety09[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi09[gjet];
				 
	ngenjets[ix]++;
      }
      break;	
			
			
    case 9:
   
      for(int gjet=0; gjet<ngenjets10; gjet++){
						
	if(genjetpT10[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT10[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea10[gjet];
	genjety[ix][ngenjets[ix]] = genjety10[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi10[gjet];
				 
	ngenjets[ix]++;
      }
      break;	
			
			
    case 10:
     
      for(int gjet=0; gjet<ngenjets11; gjet++){	
					
	if(genjetpT11[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT11[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea11[gjet];
	genjety[ix][ngenjets[ix]] = genjety11[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi11[gjet];
			 
	ngenjets[ix]++;
      }
      break;	
			
			
    case 11:
     
      for(int gjet=0; gjet<ngenjets12; gjet++){
					
	if(genjetpT12[gjet]<minPFPt) continue ;	
	
	genjetpT[ix][ngenjets[ix]] = genjetpT12[gjet];
	genjetarea[ix][ngenjets[ix]] = genjetarea12[gjet];
	genjety[ix][ngenjets[ix]] = genjety12[gjet];;
	genjetphi[ix][ngenjets[ix]] = genjetphi12[gjet];
				 
	ngenjets[ix]++;
      }
      break;	
			
    }//switch(ix)
  }//ix  
}//fillarray
				

int main()
{
  // bool isMC;	
  int nevent_total = 0;
   	
  char rootfiles[100];
  
  char outfile[100];
  char outfilx[100];
  char infile[200];
  char datafile[100];
  
  cout <<"Give the input file name"<<endl;
  cin>> rootfiles;

  int len = strlen(rootfiles);
  strncpy(outfilx, rootfiles, len-4);
  outfilx[len-4]='\0';

  sprintf (outfile,"%s.root",outfilx);
  TFile* fileOut = new TFile(outfile, "recreate"); 

  char text_file[100];
  sprintf(text_file,"%s.txt",outfilx);

  ofstream fp ;
  fp.open(text_file) ;
		
  TH1F* hist_pfmet;
  TH1F* hist_SumEt;
  TH1F* hist_METbyET;

  TH1F* hist_PV_all;
  TH1F* hist_PV_sel;
  TH1F* hist_PU;

  TH2F* PU_vs_PV_all;
  TH2F* PU_vs_PV_sel;
  TH2F* PU_vs_PV_sel_rewt;
							    

  TH1F* NGenJets[nalgo][netarange];
  TH1F* GenJetpT[nalgo][netarange];
  TH1F* GenLeadJetpT[nalgo][netarange];
  TH1F* GenMCJetpT[nalgo][netarange];
  TH1F* GenMCJetpT_pow[nalgo][netarange];
  TH1F* GenMCLeadJetpT[nalgo][netarange];
  TH1F* Gen_DiJet_Mass[nalgo][netarange];
  TH1F* GenJeteta[nalgo];
  TH1F* GenLeadJeteta[nalgo];
  TH1F* GenLeading2JetsDeltaR[nalgo];
  TH1F* GenLeading2JetsDeltaPhi[nalgo] ;
  TH1F* DeltaR_RecoGen[nalgo][netarange][noptbins] ;
  TH1F* DeltaR_RecoGen_mat[nalgo][netarange][noptbins] ;
  TH1F* Resolution[nalgo][netarange][noptbins];
  TH2F* Pt_Ratio[nalgo][netarange];
  TH2F* Pt_Ratio_nomatch[nalgo][netarange];
  TH2F* JetPt_vs_JEC[nalgo][netarange];
  TH2F* JetPt_vs_JECL1[nalgo][netarange];

  const int npu_bin = 3;

  TH1F* PileupVertices[nHLTmx] ;

  char name[100];
  char title[100];

  hist_pfmet = new TH1F("MET_Value","MET Value",1000,0.0,2000.0) ; 
  hist_SumEt = new TH1F("Sum_Et","Sum_Et",3500,0,3500.);
  hist_METbyET = new TH1F("METbyEt","MET Value by pT Sum",100,0.0,1.0) ; 
  hist_PV_all = new TH1F("nprimall_rewt_trigset","All PV",60, -0.5, 59.5);
  hist_PV_sel = new TH1F("nprimsel_rewt_trigset","Selected PV",60, -0.5, 59.5);
  hist_PU     = new TH1F("pu_vertices","# of PU Vertices",80,-0.5,79.5);

  PU_vs_PV_all = new TH2F("pileup_vs_nprimall","PU vs PV all",80,-0.5,79.5,80,-0.5,79.5);
  PU_vs_PV_sel = new TH2F("pileup_vs_nprimsel","PU vs PV sel",80,-0.5,79.5,80,-0.5,79.5);
  PU_vs_PV_sel_rewt = new TH2F("pileup_vs_nprimsel_reweighted","PU vs PV sel Weighted",80,-0.5,79.5,80,-0.5,79.5);



  for(int ij=0;ij<nalgo;ij++){
    for (int jk=0;jk<netarange;jk++){	
	
      sprintf(name,"NGenJets_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"NJets %s EtaBin %i",JetRad[ij],jk+1) ;

      NGenJets[ij][jk] = new TH1F(name,title,20,0,20);
      NGenJets[ij][jk]->Sumw2();
      
      sprintf(name,"Gen_MC_JetpT_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Gen MC Jet pT %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCJetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCJetpT[ij][jk]->Sumw2();
			
      sprintf(name,"Gen_MC_JetpT_Pow_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Gen MC Jet pT Pow %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCJetpT_pow[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCJetpT_pow[ij][jk]->Sumw2();
      
      sprintf(name,"Leading_Gen_MC_JetpT_%s_EtaBin%i",JetRad[ij],jk+1) ;
      sprintf(title,"Leading Gen MC Jet pT %s for %s",JetRad[ij],JetEta[jk]) ;
      
      GenMCLeadJetpT[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      GenMCLeadJetpT[ij][jk]->Sumw2();
			
      sprintf(name,"Gen_DiJet_Mass_%s_EtaBin%i",JetRad[ij],jk+1);
      sprintf(title,"Gen_DiJet Mass for %s %s",JetRad[ij],JetEta[jk]);
    
      Gen_DiJet_Mass[ij][jk] = new TH1F(name,title,noptbins,ptbins);
      Gen_DiJet_Mass[ij][jk]->Sumw2();
	
    }//jk
	

    if(isMC){
      
      sprintf(name,"GenJety_%s",JetRad[ij]);
      sprintf(title,"GenJet Rapidity for %s",JetRad[ij]);
      
      GenJeteta[ij] = new TH1F(name,title,200,-5.0,5.0);
      GenJeteta[ij]->Sumw2();
      
      sprintf(name,"Leading_GenJety_%s",JetRad[ij]);
      sprintf(title,"Leading GenJet Rapidity for %s",JetRad[ij]);
      
      GenLeadJeteta[ij] = new TH1F(name,title,100,-5.0,5.0);
      GenLeadJeteta[ij]->Sumw2();
      
      sprintf(name,"Leading2GenJets_deltaR_%s",JetRad[ij]);
      sprintf(title,"Leading 2 GenJets deltaR for %s",JetRad[ij]);
      
      GenLeading2JetsDeltaR[ij] = new TH1F(name,title,100,0,8.0);
      GenLeading2JetsDeltaR[ij]->Sumw2();
      
      sprintf(name,"Leading2GenJets_deltaPhi_%s",JetRad[ij]);
      sprintf(title,"Leading 2 GenJets deltaPhi for %s",JetRad[ij]);
      
      GenLeading2JetsDeltaPhi[ij] = new TH1F(name,title,75,0,2*M_PI);
      GenLeading2JetsDeltaPhi[ij]->Sumw2();
     
    }
  }//ij

PileUpGenerator(datpileup,mcpileup,rat_pileup);

ifstream file_db;
file_db.open(rootfiles); 

 while(!(file_db.eof())){
   file_db >> datafile;
   cout <<"datafile name is "<<datafile/*<<" with weight "<<weight<<" "<<weight2*/<<endl;
   if (strstr(datafile,"#")) continue;
    
   if(file_db.eof()) break;
    
   sprintf(infile, "%s", datafile);

   TFile* fileIn = new TFile(infile, "read");
   if ( fileIn->IsZombie() ) continue;
   if ( fileIn->Recover() == 0 ) continue; 

   TTree* Tin;
   Tin = (TTree*)fileIn->Get("T1");
   
   nevent_total+=Tin->GetEntries(); 
    
   Tin->SetBranchAddress("Rho", &Rho) ;
  
   Tin->SetBranchAddress("event_weight", &event_weight) ;

   Tin->SetBranchAddress("PFMET",&miset) ;
   Tin->SetBranchAddress("PFMETPhi",&misphi) ;
   Tin->SetBranchAddress("sumEt",&sumEt) ;

   Tin->SetBranchAddress("nvert",&nvert);
   Tin->SetBranchAddress("nchict",&nchict);

   if(isMC){
     Tin->SetBranchAddress("npu_vert",&npu_vert);
     Tin->SetBranchAddress("pthat",&pthat);
   }

   Tin->SetBranchAddress("event_weight", &event_weight);

   if(isMC){
 
     Tin->SetBranchAddress("ngenjets01", &ngenjets01);
     Tin->SetBranchAddress("genjetpT01",genjetpT01);
     Tin->SetBranchAddress("genjetarea01",genjetarea01);
     Tin->SetBranchAddress("genjety01",genjety01);
     Tin->SetBranchAddress("genjetphi01",genjetphi01) ;
     Tin->SetBranchAddress("genjetenr01",genjetenr01) ;
     
     Tin->SetBranchAddress("ngenjets02", &ngenjets02);
     Tin->SetBranchAddress("genjetpT02",genjetpT02);
     Tin->SetBranchAddress("genjetarea02",genjetarea02);
     Tin->SetBranchAddress("genjety02",genjety02);
     Tin->SetBranchAddress("genjetphi02",genjetphi02) ;
     Tin->SetBranchAddress("genjetenr02",genjetenr02) ;
     
     Tin->SetBranchAddress("ngenjets03", &ngenjets03);
     Tin->SetBranchAddress("genjetpT03",genjetpT03);
     Tin->SetBranchAddress("genjetarea03",genjetarea03);
     Tin->SetBranchAddress("genjety03",genjety03);
     Tin->SetBranchAddress("genjetphi03",genjetphi03) ;
     Tin->SetBranchAddress("genjetenr03",genjetenr03) ;
     
     Tin->SetBranchAddress("ngenjets04", &ngenjets04);
     Tin->SetBranchAddress("genjetpT04",genjetpT04);
     Tin->SetBranchAddress("genjetarea04",genjetarea04);
     Tin->SetBranchAddress("genjety04",genjety04);
     Tin->SetBranchAddress("genjetphi04",genjetphi04) ;
     Tin->SetBranchAddress("genjetenr04",genjetenr04) ;
     
     Tin->SetBranchAddress("ngenjets05", &ngenjets05);
     Tin->SetBranchAddress("genjetpT05",genjetpT05);
     Tin->SetBranchAddress("genjetarea05",genjetarea05);
     Tin->SetBranchAddress("genjety05",genjety05);
     Tin->SetBranchAddress("genjetphi05",genjetphi05) ;
     Tin->SetBranchAddress("genjetenr05",genjetenr05) ;
     
     Tin->SetBranchAddress("ngenjets06", &ngenjets06);
     Tin->SetBranchAddress("genjetpT06",genjetpT06);
     Tin->SetBranchAddress("genjetarea06",genjetarea06);
     Tin->SetBranchAddress("genjety06",genjety06);
     Tin->SetBranchAddress("genjetphi06",genjetphi06) ;
     Tin->SetBranchAddress("genjetenr06",genjetenr06) ;
     
     Tin->SetBranchAddress("ngenjets07", &ngenjets07);
     Tin->SetBranchAddress("genjetpT07",genjetpT07);
     Tin->SetBranchAddress("genjetarea07",genjetarea07);
     Tin->SetBranchAddress("genjety07",genjety07);
     Tin->SetBranchAddress("genjetphi07",genjetphi07) ;
     Tin->SetBranchAddress("genjetenr07",genjetenr07) ;
     
     Tin->SetBranchAddress("ngenjets08", &ngenjets08);
     Tin->SetBranchAddress("genjetpT08",genjetpT08);
     Tin->SetBranchAddress("genjetarea08",genjetarea08);
     Tin->SetBranchAddress("genjety08",genjety08);
     Tin->SetBranchAddress("genjetphi08",genjetphi08) ;
     Tin->SetBranchAddress("genjetenr08",genjetenr08) ;
     
     Tin->SetBranchAddress("ngenjets09", &ngenjets09);
     Tin->SetBranchAddress("genjetpT09",genjetpT09);
     Tin->SetBranchAddress("genjetarea09",genjetarea09);
     Tin->SetBranchAddress("genjety09",genjety09);
     Tin->SetBranchAddress("genjetphi09",genjetphi09) ;
     Tin->SetBranchAddress("genjetenr09",genjetenr09) ;
     
     Tin->SetBranchAddress("ngenjets10", &ngenjets10);
     Tin->SetBranchAddress("genjetpT10",genjetpT10);
     Tin->SetBranchAddress("genjetarea10",genjetarea10);
     Tin->SetBranchAddress("genjety10",genjety10);
     Tin->SetBranchAddress("genjetphi10",genjetphi10) ;
     Tin->SetBranchAddress("genjetenr10",genjetenr10) ;
    
     Tin->SetBranchAddress("ngenjets11", &ngenjets11);
     Tin->SetBranchAddress("genjetpT11",genjetpT11);
     Tin->SetBranchAddress("genjetarea11",genjetarea11);
     Tin->SetBranchAddress("genjety11",genjety11);
     Tin->SetBranchAddress("genjetphi11",genjetphi11) ;
     Tin->SetBranchAddress("genjetenr11",genjetenr11) ;
     
     Tin->SetBranchAddress("ngenjets12", &ngenjets12);
     Tin->SetBranchAddress("genjetpT12",genjetpT12);
     Tin->SetBranchAddress("genjetarea12",genjetarea12);
     Tin->SetBranchAddress("genjety12",genjety12);
     Tin->SetBranchAddress("genjetphi12",genjetphi12) ;
     Tin->SetBranchAddress("genjetenr12",genjetenr12) ;
     
   } //isMC
  
   
   int nentries = Tin->GetEntries();
    
   cout <<"file "<<datafile<<" entries "<<nentries<< endl;


   for (int ij=0; ij<nentries; ij++) {
       
     fileIn->cd();
      
     Tin->GetEntry(ij);
       
     fillarray();
       
     weight = event_weight;
     cout<<" event weight "<<event_weight<<endl;
  //   weight*=rat_pileup[0][npu_vert];
   //  cout<<"no. of pu vertices "<<npu_vert<<'\t'<<"weight "<<weight<<endl;
       
     hist_pfmet->Fill(miset,weight);
     hist_SumEt->Fill(sumEt,weight);
     hist_METbyET->Fill(miset*1./sumEt,weight);
            
     hist_PV_all->Fill(nvert,weight);     
     hist_PV_sel->Fill(nchict,weight);   
     hist_PU->Fill(npu_vert,weight); 
       
     PU_vs_PV_all->Fill(npu_vert,nvert);
     PU_vs_PV_sel->Fill(npu_vert,nchict);
     PU_vs_PV_sel_rewt->Fill(npu_vert,nchict,weight);
              
     for(int ix=0; ix<nalgo; ix++){
		
       iRecoPTbin[ix] = -1;
       iGenPTbin[ix] = -1;
	  
			
    if(isMC) {
				 
	 int ngenjet_count[netarange] = {0};
				
	 for(int jet=0; jet<ngenjets[ix]; jet++){
	   int etatag = getbinid(abs(genjety[ix][jet]),netarange,etarng);
	   if(etatag>=0){
	     ngenjet_count[etatag]++;
	     GenMCJetpT[ix][etatag]->Fill(genjetpT[ix][jet],weight);
	     GenMCJetpT_pow[ix][etatag]->Fill(genjetpT[ix][jet],genjetpT[ix][jet]*weight);
	     if (genjetpT[ix][jet]>leadingPtThreshold[0]) { GenJeteta[ix]->Fill(genjety[ix][jet],weight); }
	     
	     if(jet==0){
	       //	       iGenPTbin[ix] = getbinid(genjetpT[ix][jet],nHLTmx, leadingPtThreshold);
	       GenMCLeadJetpT[ix][etatag]->Fill(genjetpT[ix][jet],weight);
	       if (genjetpT[ix][jet]>leadingPtThreshold[0]) {GenLeadJeteta[ix]->Fill(genjety[ix][jet],weight);}
	     }
	   }
	 }//jet
				  
	 for(int eta=0; eta<netarange; eta++){
	   NGenJets[ix][eta]->Fill(ngenjet_count[eta],weight);
	 }

	 if(ngenjets[ix]>=2){
	   GenLeading2JetsDeltaR[ix]->Fill(delta2R(genjety[ix][0],genjetphi[ix][0],genjety[ix][1],genjetphi[ix][1]),weight);
	   GenLeading2JetsDeltaPhi[ix]->Fill(PhiInRange(genjetphi[ix][0]-genjetphi[ix][1]),weight);
			
	   if((ngenjets[ix]==2)||((ngenjets[ix]>2)&&(genjetpT[ix][2]<50.))){
			
	     double p4[3]={0};
			
	     if(abs(PhiInRange(genjetphi[ix][0]-genjetphi[ix][1]))>(2*M_PI/3.)) {
	       for(int jt=0; jt<2; jt++){
		 p4[0]+=genjetenr[ix][jt];
		 p4[1]+=genjetpT[ix][jt];
		 p4[2]+=genjetenr[ix][jt]*tanh(genjety[ix][jt]);
	       }
	       double refy ;
	       if(abs(genjety[ix][0])>abs(genjety[ix][1])){ refy = abs(genjety[ix][0]);}
	       else { refy = abs(genjety[ix][1]); }
	       int etatag = getbinid(refy,netarange,etarng)  ; 
			
	       if(etatag>=0){
		 double mass = sqrt(pow(p4[0],2.)-pow(p4[1],2.)-pow(p4[2],2.));
		 Gen_DiJet_Mass[ix][etatag]->Fill(mass,weight);		
	       }
	     }//phi condn
	   }//dijet 
	 }	  
       } //isMC
     }//ix 
       
   }//ij
   
 }
 
 file_db.close();
 
  fileOut->cd();
  fileOut->Write();
  fileOut->Close();
 
  fp<<"Total Number of events in "<<fileOut->GetName()<<" is "<<nevent_total<<endl;
  fp<<"Total Weight is "<<tot_weight<<endl;
}
